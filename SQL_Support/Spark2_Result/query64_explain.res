== Parsed Logical Plan ==
CTE [cs_ui, cross_sales]
:  :- 'SubqueryAlias `cs_ui`
:  :  +- 'UnresolvedHaving ('sum('cs_ext_list_price) > (2 * 'sum((('cr_refunded_cash + 'cr_reversed_charge) + 'cr_store_credit))))
:  :     +- 'Aggregate ['cs_item_sk], ['cs_item_sk, 'sum('cs_ext_list_price) AS sale#8, 'sum((('cr_refunded_cash + 'cr_reversed_charge) + 'cr_store_credit)) AS refund#9]
:  :        +- 'Filter (('cs_item_sk = 'cr_item_sk) && ('cs_order_number = 'cr_order_number))
:  :           +- 'Join Inner
:  :              :- 'UnresolvedRelation `catalog_sales`
:  :              +- 'UnresolvedRelation `catalog_returns`
:  +- 'SubqueryAlias `cross_sales`
:     +- 'Aggregate ['i_product_name, 'i_item_sk, 's_store_name, 's_zip, 'ad1.ca_street_number, 'ad1.ca_street_name, 'ad1.ca_city, 'ad1.ca_zip, 'ad2.ca_street_number, 'ad2.ca_street_name, 'ad2.ca_city, 'ad2.ca_zip, 'd1.d_year, 'd2.d_year, 'd3.d_year], ['i_product_name AS product_name#10, 'i_item_sk AS item_sk#11, 's_store_name AS store_name#12, 's_zip AS store_zip#13, 'ad1.ca_street_number AS b_street_number#14, 'ad1.ca_street_name AS b_street_name#15, 'ad1.ca_city AS b_city#16, 'ad1.ca_zip AS b_zip#17, 'ad2.ca_street_number AS c_street_number#18, 'ad2.ca_street_name AS c_street_name#19, 'ad2.ca_city AS c_city#20, 'ad2.ca_zip AS c_zip#21, 'd1.d_year AS syear#22, 'd2.d_year AS fsyear#23, 'd3.d_year AS s2year#24, 'count(1) AS cnt#25, 'sum('ss_wholesale_cost) AS s1#26, 'sum('ss_list_price) AS s2#27, 'sum('ss_coupon_amt) AS s3#28]
:        +- 'Filter (((((('ss_store_sk = 's_store_sk) && ('ss_sold_date_sk = 'd1.d_date_sk)) && ('ss_customer_sk = 'c_customer_sk)) && ((('ss_cdemo_sk = 'cd1.cd_demo_sk) && ('ss_hdemo_sk = 'hd1.hd_demo_sk)) && ('ss_addr_sk = 'ad1.ca_address_sk))) && (((('ss_item_sk = 'i_item_sk) && ('ss_item_sk = 'sr_item_sk)) && ('ss_ticket_number = 'sr_ticket_number)) && (('ss_item_sk = 'cs_ui.cs_item_sk) && ('c_current_cdemo_sk = 'cd2.cd_demo_sk)))) && ((((('c_current_hdemo_sk = 'hd2.hd_demo_sk) && ('c_current_addr_sk = 'ad2.ca_address_sk)) && ('c_first_sales_date_sk = 'd2.d_date_sk)) && ((('c_first_shipto_date_sk = 'd3.d_date_sk) && ('ss_promo_sk = 'p_promo_sk)) && ('hd1.hd_income_band_sk = 'ib1.ib_income_band_sk))) && (((('hd2.hd_income_band_sk = 'ib2.ib_income_band_sk) && NOT ('cd1.cd_marital_status = 'cd2.cd_marital_status)) && 'i_color IN (purple,burlywood,indian,spring,floral,medium)) && ((('i_current_price >= 64) && ('i_current_price <= (64 + 10))) && (('i_current_price >= (64 + 1)) && ('i_current_price <= (64 + 15)))))))
:           +- 'Join Inner
:              :- 'Join Inner
:              :  :- 'Join Inner
:              :  :  :- 'Join Inner
:              :  :  :  :- 'Join Inner
:              :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- 'UnresolvedRelation `store_sales`
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- 'UnresolvedRelation `store_returns`
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- 'UnresolvedRelation `cs_ui`
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- 'SubqueryAlias `d1`
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- 'UnresolvedRelation `date_dim`
:              :  :  :  :  :  :  :  :  :  :  :  :  :  +- 'SubqueryAlias `d2`
:              :  :  :  :  :  :  :  :  :  :  :  :  :     +- 'UnresolvedRelation `date_dim`
:              :  :  :  :  :  :  :  :  :  :  :  :  +- 'SubqueryAlias `d3`
:              :  :  :  :  :  :  :  :  :  :  :  :     +- 'UnresolvedRelation `date_dim`
:              :  :  :  :  :  :  :  :  :  :  :  +- 'UnresolvedRelation `store`
:              :  :  :  :  :  :  :  :  :  :  +- 'UnresolvedRelation `customer`
:              :  :  :  :  :  :  :  :  :  +- 'SubqueryAlias `cd1`
:              :  :  :  :  :  :  :  :  :     +- 'UnresolvedRelation `customer_demographics`
:              :  :  :  :  :  :  :  :  +- 'SubqueryAlias `cd2`
:              :  :  :  :  :  :  :  :     +- 'UnresolvedRelation `customer_demographics`
:              :  :  :  :  :  :  :  +- 'UnresolvedRelation `promotion`
:              :  :  :  :  :  :  +- 'SubqueryAlias `hd1`
:              :  :  :  :  :  :     +- 'UnresolvedRelation `household_demographics`
:              :  :  :  :  :  +- 'SubqueryAlias `hd2`
:              :  :  :  :  :     +- 'UnresolvedRelation `household_demographics`
:              :  :  :  :  +- 'SubqueryAlias `ad1`
:              :  :  :  :     +- 'UnresolvedRelation `customer_address`
:              :  :  :  +- 'SubqueryAlias `ad2`
:              :  :  :     +- 'UnresolvedRelation `customer_address`
:              :  :  +- 'SubqueryAlias `ib1`
:              :  :     +- 'UnresolvedRelation `income_band`
:              :  +- 'SubqueryAlias `ib2`
:              :     +- 'UnresolvedRelation `income_band`
:              +- 'UnresolvedRelation `item`
+- 'Sort ['cs1.product_name ASC NULLS FIRST, 'cs1.store_name ASC NULLS FIRST, 'cnt_2 ASC NULLS FIRST], true
   +- 'Project ['cs1.product_name, 'cs1.store_name, 'cs1.store_zip, 'cs1.b_street_number, 'cs1.b_street_name, 'cs1.b_city, 'cs1.b_zip, 'cs1.c_street_number, 'cs1.c_street_name, 'cs1.c_city, 'cs1.c_zip, 'cs1.syear, 'cs1.cnt, 'cs1.s1 AS s11#0, 'cs1.s2 AS s21#1, 'cs1.s3 AS s31#2, 'cs2.s1 AS s12#3, 'cs2.s2 AS s22#4, 'cs2.s3 AS s32#5, 'cs2.syear AS syear_2#6, 'cs2.cnt AS cnt_2#7]
      +- 'Filter (((('cs1.item_sk = 'cs2.item_sk) && ('cs1.syear = 1999)) && ('cs2.syear = (1999 + 1))) && ((('cs2.cnt <= 'cs1.cnt) && ('cs1.store_name = 'cs2.store_name)) && ('cs1.store_zip = 'cs2.store_zip)))
         +- 'Join Inner
            :- 'SubqueryAlias `cs1`
            :  +- 'UnresolvedRelation `cross_sales`
            +- 'SubqueryAlias `cs2`
               +- 'UnresolvedRelation `cross_sales`

== Analyzed Logical Plan ==
product_name: string, store_name: string, store_zip: string, b_street_number: string, b_street_name: string, b_city: string, b_zip: string, c_street_number: string, c_street_name: string, c_city: string, c_zip: string, syear: int, cnt: bigint, s11: double, s21: double, s31: double, s12: double, s22: double, s32: double, syear_2: int, cnt_2: bigint
Sort [product_name#10 ASC NULLS FIRST, store_name#12 ASC NULLS FIRST, cnt_2#7L ASC NULLS FIRST], true
+- Project [product_name#10, store_name#12, store_zip#13, b_street_number#14, b_street_name#15, b_city#16, b_zip#17, c_street_number#18, c_street_name#19, c_city#20, c_zip#21, syear#22, cnt#25L, s1#26 AS s11#0, s2#27 AS s21#1, s3#28 AS s31#2, s1#399 AS s12#3, s2#400 AS s22#4, s3#401 AS s32#5, syear#395 AS syear_2#6, cnt#398L AS cnt_2#7L]
   +- Filter ((((item_sk#11 = item_sk#384) && (syear#22 = 1999)) && (syear#395 = (1999 + 1))) && (((cnt#398L <= cnt#25L) && (store_name#12 = store_name#385)) && (store_zip#13 = store_zip#386)))
      +- Join Inner
         :- SubqueryAlias `cs1`
         :  +- SubqueryAlias `cross_sales`
         :     +- Aggregate [i_product_name#290, i_item_sk#269, s_store_name#178, s_zip#198, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262, ca_street_number#363, ca_street_name#364, ca_city#367, ca_zip#370, d_year#151, d_year#297, d_year#325], [i_product_name#290 AS product_name#10, i_item_sk#269 AS item_sk#11, s_store_name#178 AS store_name#12, s_zip#198 AS store_zip#13, ca_street_number#255 AS b_street_number#14, ca_street_name#256 AS b_street_name#15, ca_city#259 AS b_city#16, ca_zip#262 AS b_zip#17, ca_street_number#363 AS c_street_number#18, ca_street_name#364 AS c_street_name#19, ca_city#367 AS c_city#20, ca_zip#370 AS c_zip#21, d_year#151 AS syear#22, d_year#297 AS fsyear#23, d_year#325 AS s2year#24, count(1) AS cnt#25L, sum(ss_wholesale_cost#113) AS s1#26, sum(ss_list_price#114) AS s2#27, sum(ss_coupon_amt#121) AS s3#28]
         :        +- Filter ((((((ss_store_sk#109 = s_store_sk#173) && (ss_sold_date_sk#102 = d_date_sk#145)) && (ss_customer_sk#105 = c_customer_sk#202)) && (((ss_cdemo_sk#106 = cd_demo_sk#220) && (ss_hdemo_sk#107 = hd_demo_sk#248)) && (ss_addr_sk#108 = ca_address_sk#253))) && ((((ss_item_sk#104 = i_item_sk#269) && (ss_item_sk#104 = sr_item_sk#127)) && (ss_ticket_number#111 = sr_ticket_number#134)) && ((ss_item_sk#104 = cs_item_sk#46) && (c_current_cdemo_sk#204 = cd_demo_sk#347)))) && (((((c_current_hdemo_sk#205 = hd_demo_sk#356) && (c_current_addr_sk#206 = ca_address_sk#361)) && (c_first_sales_date_sk#208 = d_date_sk#291)) && (((c_first_shipto_date_sk#207 = d_date_sk#319) && (ss_promo_sk#110 = p_promo_sk#229)) && (hd_income_band_sk#249 = ib_income_band_sk#266))) && ((((hd_income_band_sk#357 = ib_income_band_sk#374) && NOT (cd_marital_status#222 = cd_marital_status#349)) && i_color#286 IN (purple,burlywood,indian,spring,floral,medium)) && (((i_current_price#274 >= cast(64 as double)) && (i_current_price#274 <= cast((64 + 10) as double))) && ((i_current_price#274 >= cast((64 + 1) as double)) && (i_current_price#274 <= cast((64 + 15) as double)))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `tpcds`.`store_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#102,ss_sold_time_sk#103,ss_item_sk#104,ss_customer_sk#105,ss_cdemo_sk#106,ss_hdemo_sk#107,ss_addr_sk#108,ss_store_sk#109,ss_promo_sk#110,ss_ticket_number#111,ss_quantity#112,ss_wholesale_cost#113,ss_list_price#114,ss_sales_price#115,ss_ext_discount_amt#116,ss_ext_sales_price#117,ss_ext_wholesale_cost#118,ss_ext_list_price#119,ss_ext_tax#120,ss_coupon_amt#121,ss_net_paid#122,ss_net_paid_inc_tax#123,ss_net_profit#124] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `tpcds`.`store_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#125,sr_return_time_sk#126,sr_item_sk#127,sr_customer_sk#128,sr_cdemo_sk#129,sr_hdemo_sk#130,sr_addr_sk#131,sr_store_sk#132,sr_reason_sk#133,sr_ticket_number#134,sr_return_quantity#135,sr_return_amt#136,sr_return_tax#137,sr_return_amt_inc_tax#138,sr_fee#139,sr_return_ship_cost#140,sr_refunded_cash#141,sr_reversed_charge#142,sr_store_credit#143,sr_net_loss#144] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#46, sale#8, refund#9]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (sum(cs_ext_list_price#56)#97 > (cast(2 as double) * sum(((cr_refunded_cash#88 + cr_reversed_charge#89) + cr_store_credit#90))#98))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#46], [cs_item_sk#46, sum(cs_ext_list_price#56) AS sale#8, sum(((cr_refunded_cash#88 + cr_reversed_charge#89) + cr_store_credit#90)) AS refund#9, sum(cs_ext_list_price#56) AS sum(cs_ext_list_price#56)#97, sum(((cr_refunded_cash#88 + cr_reversed_charge#89) + cr_store_credit#90)) AS sum(((cr_refunded_cash#88 + cr_reversed_charge#89) + cr_store_credit#90))#98]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#46 = cr_item_sk#67) && (cs_order_number#48 = cr_order_number#81))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `tpcds`.`catalog_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#31,cs_sold_time_sk#32,cs_ship_date_sk#33,cs_bill_customer_sk#34,cs_bill_cdemo_sk#35,cs_bill_hdemo_sk#36,cs_bill_addr_sk#37,cs_ship_customer_sk#38,cs_ship_cdemo_sk#39,cs_ship_hdemo_sk#40,cs_ship_addr_sk#41,cs_call_center_sk#42,cs_catalog_page_sk#43,cs_ship_mode_sk#44,cs_warehouse_sk#45,cs_item_sk#46,cs_promo_sk#47,cs_order_number#48,cs_quantity#49,cs_wholesale_cost#50,cs_list_price#51,cs_sales_price#52,cs_ext_discount_amt#53,cs_ext_sales_price#54,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `tpcds`.`catalog_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#65,cr_returned_time_sk#66,cr_item_sk#67,cr_refunded_customer_sk#68,cr_refunded_cdemo_sk#69,cr_refunded_hdemo_sk#70,cr_refunded_addr_sk#71,cr_returning_customer_sk#72,cr_returning_cdemo_sk#73,cr_returning_hdemo_sk#74,cr_returning_addr_sk#75,cr_call_center_sk#76,cr_catalog_page_sk#77,cr_ship_mode_sk#78,cr_warehouse_sk#79,cr_reason_sk#80,cr_order_number#81,cr_return_quantity#82,cr_return_amount#83,cr_return_tax#84,cr_return_amt_inc_tax#85,cr_fee#86,cr_return_ship_cost#87,cr_refunded_cash#88,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `tpcds`.`date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#145,d_date_id#146,d_date#147,d_month_seq#148,d_week_seq#149,d_quarter_seq#150,d_year#151,d_dow#152,d_moy#153,d_dom#154,d_qoy#155,d_fy_year#156,d_fy_quarter_seq#157,d_fy_week_seq#158,d_day_name#159,d_quarter_name#160,d_holiday#161,d_weekend#162,d_following_holiday#163,d_first_dom#164,d_last_dom#165,d_same_day_ly#166,d_same_day_lq#167,d_current_day#168,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `tpcds`.`date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#291,d_date_id#292,d_date#293,d_month_seq#294,d_week_seq#295,d_quarter_seq#296,d_year#297,d_dow#298,d_moy#299,d_dom#300,d_qoy#301,d_fy_year#302,d_fy_quarter_seq#303,d_fy_week_seq#304,d_day_name#305,d_quarter_name#306,d_holiday#307,d_weekend#308,d_following_holiday#309,d_first_dom#310,d_last_dom#311,d_same_day_ly#312,d_same_day_lq#313,d_current_day#314,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `tpcds`.`date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#319,d_date_id#320,d_date#321,d_month_seq#322,d_week_seq#323,d_quarter_seq#324,d_year#325,d_dow#326,d_moy#327,d_dom#328,d_qoy#329,d_fy_year#330,d_fy_quarter_seq#331,d_fy_week_seq#332,d_day_name#333,d_quarter_name#334,d_holiday#335,d_weekend#336,d_following_holiday#337,d_first_dom#338,d_last_dom#339,d_same_day_ly#340,d_same_day_lq#341,d_current_day#342,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `tpcds`.`store`
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#173,s_store_id#174,s_rec_start_date#175,s_rec_end_date#176,s_closed_date_sk#177,s_store_name#178,s_number_employees#179,s_floor_space#180,s_hours#181,s_manager#182,s_market_id#183,s_geography_class#184,s_market_desc#185,s_market_manager#186,s_division_id#187,s_division_name#188,s_company_id#189,s_company_name#190,s_street_number#191,s_street_name#192,s_street_type#193,s_suite_number#194,s_city#195,s_county#196,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `tpcds`.`customer`
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#202,c_customer_id#203,c_current_cdemo_sk#204,c_current_hdemo_sk#205,c_current_addr_sk#206,c_first_shipto_date_sk#207,c_first_sales_date_sk#208,c_salutation#209,c_first_name#210,c_last_name#211,c_preferred_cust_flag#212,c_birth_day#213,c_birth_month#214,c_birth_year#215,c_birth_country#216,c_login#217,c_email_address#218,c_last_review_date#219] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias `tpcds`.`customer_demographics`
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#220,cd_gender#221,cd_marital_status#222,cd_education_status#223,cd_purchase_estimate#224,cd_credit_rating#225,cd_dep_count#226,cd_dep_employed_count#227,cd_dep_college_count#228] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias `tpcds`.`customer_demographics`
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#347,cd_gender#348,cd_marital_status#349,cd_education_status#350,cd_purchase_estimate#351,cd_credit_rating#352,cd_dep_count#353,cd_dep_employed_count#354,cd_dep_college_count#355] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias `tpcds`.`promotion`
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#229,p_promo_id#230,p_start_date_sk#231,p_end_date_sk#232,p_item_sk#233,p_cost#234,p_response_target#235,p_promo_name#236,p_channel_dmail#237,p_channel_email#238,p_channel_catalog#239,p_channel_tv#240,p_channel_radio#241,p_channel_press#242,p_channel_event#243,p_channel_demo#244,p_channel_details#245,p_purpose#246,p_discount_active#247] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias `hd1`
         :              :  :  :  :  :  :     +- SubqueryAlias `tpcds`.`household_demographics`
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#248,hd_income_band_sk#249,hd_buy_potential#250,hd_dep_count#251,hd_vehicle_count#252] parquet
         :              :  :  :  :  :  +- SubqueryAlias `hd2`
         :              :  :  :  :  :     +- SubqueryAlias `tpcds`.`household_demographics`
         :              :  :  :  :  :        +- Relation[hd_demo_sk#356,hd_income_band_sk#357,hd_buy_potential#358,hd_dep_count#359,hd_vehicle_count#360] parquet
         :              :  :  :  :  +- SubqueryAlias `ad1`
         :              :  :  :  :     +- SubqueryAlias `tpcds`.`customer_address`
         :              :  :  :  :        +- Relation[ca_address_sk#253,ca_address_id#254,ca_street_number#255,ca_street_name#256,ca_street_type#257,ca_suite_number#258,ca_city#259,ca_county#260,ca_state#261,ca_zip#262,ca_country#263,ca_gmt_offset#264,ca_location_type#265] parquet
         :              :  :  :  +- SubqueryAlias `ad2`
         :              :  :  :     +- SubqueryAlias `tpcds`.`customer_address`
         :              :  :  :        +- Relation[ca_address_sk#361,ca_address_id#362,ca_street_number#363,ca_street_name#364,ca_street_type#365,ca_suite_number#366,ca_city#367,ca_county#368,ca_state#369,ca_zip#370,ca_country#371,ca_gmt_offset#372,ca_location_type#373] parquet
         :              :  :  +- SubqueryAlias `ib1`
         :              :  :     +- SubqueryAlias `tpcds`.`income_band`
         :              :  :        +- Relation[ib_income_band_sk#266,ib_lower_bound#267,ib_upper_bound#268] parquet
         :              :  +- SubqueryAlias `ib2`
         :              :     +- SubqueryAlias `tpcds`.`income_band`
         :              :        +- Relation[ib_income_band_sk#374,ib_lower_bound#375,ib_upper_bound#376] parquet
         :              +- SubqueryAlias `tpcds`.`item`
         :                 +- Relation[i_item_sk#269,i_item_id#270,i_rec_start_date#271,i_rec_end_date#272,i_item_desc#273,i_current_price#274,i_wholesale_cost#275,i_brand_id#276,i_brand#277,i_class_id#278,i_class#279,i_category_id#280,i_category#281,i_manufact_id#282,i_manufact#283,i_size#284,i_formulation#285,i_color#286,i_units#287,i_container#288,i_manager_id#289,i_product_name#290] parquet
         +- SubqueryAlias `cs2`
            +- SubqueryAlias `cross_sales`
               +- Aggregate [i_product_name#290, i_item_sk#269, s_store_name#178, s_zip#198, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262, ca_street_number#363, ca_street_name#364, ca_city#367, ca_zip#370, d_year#151, d_year#297, d_year#325], [i_product_name#290 AS product_name#383, i_item_sk#269 AS item_sk#384, s_store_name#178 AS store_name#385, s_zip#198 AS store_zip#386, ca_street_number#255 AS b_street_number#387, ca_street_name#256 AS b_street_name#388, ca_city#259 AS b_city#389, ca_zip#262 AS b_zip#390, ca_street_number#363 AS c_street_number#391, ca_street_name#364 AS c_street_name#392, ca_city#367 AS c_city#393, ca_zip#370 AS c_zip#394, d_year#151 AS syear#395, d_year#297 AS fsyear#396, d_year#325 AS s2year#397, count(1) AS cnt#398L, sum(ss_wholesale_cost#113) AS s1#399, sum(ss_list_price#114) AS s2#400, sum(ss_coupon_amt#121) AS s3#401]
                  +- Filter ((((((ss_store_sk#109 = s_store_sk#173) && (ss_sold_date_sk#102 = d_date_sk#145)) && (ss_customer_sk#105 = c_customer_sk#202)) && (((ss_cdemo_sk#106 = cd_demo_sk#220) && (ss_hdemo_sk#107 = hd_demo_sk#248)) && (ss_addr_sk#108 = ca_address_sk#253))) && ((((ss_item_sk#104 = i_item_sk#269) && (ss_item_sk#104 = sr_item_sk#127)) && (ss_ticket_number#111 = sr_ticket_number#134)) && ((ss_item_sk#104 = cs_item_sk#46) && (c_current_cdemo_sk#204 = cd_demo_sk#347)))) && (((((c_current_hdemo_sk#205 = hd_demo_sk#356) && (c_current_addr_sk#206 = ca_address_sk#361)) && (c_first_sales_date_sk#208 = d_date_sk#291)) && (((c_first_shipto_date_sk#207 = d_date_sk#319) && (ss_promo_sk#110 = p_promo_sk#229)) && (hd_income_band_sk#249 = ib_income_band_sk#266))) && ((((hd_income_band_sk#357 = ib_income_band_sk#374) && NOT (cd_marital_status#222 = cd_marital_status#349)) && i_color#286 IN (purple,burlywood,indian,spring,floral,medium)) && (((i_current_price#274 >= cast(64 as double)) && (i_current_price#274 <= cast((64 + 10) as double))) && ((i_current_price#274 >= cast((64 + 1) as double)) && (i_current_price#274 <= cast((64 + 15) as double)))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `tpcds`.`store_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#102,ss_sold_time_sk#103,ss_item_sk#104,ss_customer_sk#105,ss_cdemo_sk#106,ss_hdemo_sk#107,ss_addr_sk#108,ss_store_sk#109,ss_promo_sk#110,ss_ticket_number#111,ss_quantity#112,ss_wholesale_cost#113,ss_list_price#114,ss_sales_price#115,ss_ext_discount_amt#116,ss_ext_sales_price#117,ss_ext_wholesale_cost#118,ss_ext_list_price#119,ss_ext_tax#120,ss_coupon_amt#121,ss_net_paid#122,ss_net_paid_inc_tax#123,ss_net_profit#124] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `tpcds`.`store_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#125,sr_return_time_sk#126,sr_item_sk#127,sr_customer_sk#128,sr_cdemo_sk#129,sr_hdemo_sk#130,sr_addr_sk#131,sr_store_sk#132,sr_reason_sk#133,sr_ticket_number#134,sr_return_quantity#135,sr_return_amt#136,sr_return_tax#137,sr_return_amt_inc_tax#138,sr_fee#139,sr_return_ship_cost#140,sr_refunded_cash#141,sr_reversed_charge#142,sr_store_credit#143,sr_net_loss#144] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#46, sale#8, refund#9]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (sum(cs_ext_list_price#56)#97 > (cast(2 as double) * sum(((cr_refunded_cash#88 + cr_reversed_charge#89) + cr_store_credit#90))#98))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#46], [cs_item_sk#46, sum(cs_ext_list_price#56) AS sale#8, sum(((cr_refunded_cash#88 + cr_reversed_charge#89) + cr_store_credit#90)) AS refund#9, sum(cs_ext_list_price#56) AS sum(cs_ext_list_price#56)#97, sum(((cr_refunded_cash#88 + cr_reversed_charge#89) + cr_store_credit#90)) AS sum(((cr_refunded_cash#88 + cr_reversed_charge#89) + cr_store_credit#90))#98]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#46 = cr_item_sk#67) && (cs_order_number#48 = cr_order_number#81))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `tpcds`.`catalog_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#31,cs_sold_time_sk#32,cs_ship_date_sk#33,cs_bill_customer_sk#34,cs_bill_cdemo_sk#35,cs_bill_hdemo_sk#36,cs_bill_addr_sk#37,cs_ship_customer_sk#38,cs_ship_cdemo_sk#39,cs_ship_hdemo_sk#40,cs_ship_addr_sk#41,cs_call_center_sk#42,cs_catalog_page_sk#43,cs_ship_mode_sk#44,cs_warehouse_sk#45,cs_item_sk#46,cs_promo_sk#47,cs_order_number#48,cs_quantity#49,cs_wholesale_cost#50,cs_list_price#51,cs_sales_price#52,cs_ext_discount_amt#53,cs_ext_sales_price#54,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `tpcds`.`catalog_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#65,cr_returned_time_sk#66,cr_item_sk#67,cr_refunded_customer_sk#68,cr_refunded_cdemo_sk#69,cr_refunded_hdemo_sk#70,cr_refunded_addr_sk#71,cr_returning_customer_sk#72,cr_returning_cdemo_sk#73,cr_returning_hdemo_sk#74,cr_returning_addr_sk#75,cr_call_center_sk#76,cr_catalog_page_sk#77,cr_ship_mode_sk#78,cr_warehouse_sk#79,cr_reason_sk#80,cr_order_number#81,cr_return_quantity#82,cr_return_amount#83,cr_return_tax#84,cr_return_amt_inc_tax#85,cr_fee#86,cr_return_ship_cost#87,cr_refunded_cash#88,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `tpcds`.`date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#145,d_date_id#146,d_date#147,d_month_seq#148,d_week_seq#149,d_quarter_seq#150,d_year#151,d_dow#152,d_moy#153,d_dom#154,d_qoy#155,d_fy_year#156,d_fy_quarter_seq#157,d_fy_week_seq#158,d_day_name#159,d_quarter_name#160,d_holiday#161,d_weekend#162,d_following_holiday#163,d_first_dom#164,d_last_dom#165,d_same_day_ly#166,d_same_day_lq#167,d_current_day#168,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `tpcds`.`date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#291,d_date_id#292,d_date#293,d_month_seq#294,d_week_seq#295,d_quarter_seq#296,d_year#297,d_dow#298,d_moy#299,d_dom#300,d_qoy#301,d_fy_year#302,d_fy_quarter_seq#303,d_fy_week_seq#304,d_day_name#305,d_quarter_name#306,d_holiday#307,d_weekend#308,d_following_holiday#309,d_first_dom#310,d_last_dom#311,d_same_day_ly#312,d_same_day_lq#313,d_current_day#314,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `tpcds`.`date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#319,d_date_id#320,d_date#321,d_month_seq#322,d_week_seq#323,d_quarter_seq#324,d_year#325,d_dow#326,d_moy#327,d_dom#328,d_qoy#329,d_fy_year#330,d_fy_quarter_seq#331,d_fy_week_seq#332,d_day_name#333,d_quarter_name#334,d_holiday#335,d_weekend#336,d_following_holiday#337,d_first_dom#338,d_last_dom#339,d_same_day_ly#340,d_same_day_lq#341,d_current_day#342,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `tpcds`.`store`
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#173,s_store_id#174,s_rec_start_date#175,s_rec_end_date#176,s_closed_date_sk#177,s_store_name#178,s_number_employees#179,s_floor_space#180,s_hours#181,s_manager#182,s_market_id#183,s_geography_class#184,s_market_desc#185,s_market_manager#186,s_division_id#187,s_division_name#188,s_company_id#189,s_company_name#190,s_street_number#191,s_street_name#192,s_street_type#193,s_suite_number#194,s_city#195,s_county#196,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `tpcds`.`customer`
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#202,c_customer_id#203,c_current_cdemo_sk#204,c_current_hdemo_sk#205,c_current_addr_sk#206,c_first_shipto_date_sk#207,c_first_sales_date_sk#208,c_salutation#209,c_first_name#210,c_last_name#211,c_preferred_cust_flag#212,c_birth_day#213,c_birth_month#214,c_birth_year#215,c_birth_country#216,c_login#217,c_email_address#218,c_last_review_date#219] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias `tpcds`.`customer_demographics`
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#220,cd_gender#221,cd_marital_status#222,cd_education_status#223,cd_purchase_estimate#224,cd_credit_rating#225,cd_dep_count#226,cd_dep_employed_count#227,cd_dep_college_count#228] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
                        :  :  :  :  :  :  :  :     +- SubqueryAlias `tpcds`.`customer_demographics`
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#347,cd_gender#348,cd_marital_status#349,cd_education_status#350,cd_purchase_estimate#351,cd_credit_rating#352,cd_dep_count#353,cd_dep_employed_count#354,cd_dep_college_count#355] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias `tpcds`.`promotion`
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#229,p_promo_id#230,p_start_date_sk#231,p_end_date_sk#232,p_item_sk#233,p_cost#234,p_response_target#235,p_promo_name#236,p_channel_dmail#237,p_channel_email#238,p_channel_catalog#239,p_channel_tv#240,p_channel_radio#241,p_channel_press#242,p_channel_event#243,p_channel_demo#244,p_channel_details#245,p_purpose#246,p_discount_active#247] parquet
                        :  :  :  :  :  :  +- SubqueryAlias `hd1`
                        :  :  :  :  :  :     +- SubqueryAlias `tpcds`.`household_demographics`
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#248,hd_income_band_sk#249,hd_buy_potential#250,hd_dep_count#251,hd_vehicle_count#252] parquet
                        :  :  :  :  :  +- SubqueryAlias `hd2`
                        :  :  :  :  :     +- SubqueryAlias `tpcds`.`household_demographics`
                        :  :  :  :  :        +- Relation[hd_demo_sk#356,hd_income_band_sk#357,hd_buy_potential#358,hd_dep_count#359,hd_vehicle_count#360] parquet
                        :  :  :  :  +- SubqueryAlias `ad1`
                        :  :  :  :     +- SubqueryAlias `tpcds`.`customer_address`
                        :  :  :  :        +- Relation[ca_address_sk#253,ca_address_id#254,ca_street_number#255,ca_street_name#256,ca_street_type#257,ca_suite_number#258,ca_city#259,ca_county#260,ca_state#261,ca_zip#262,ca_country#263,ca_gmt_offset#264,ca_location_type#265] parquet
                        :  :  :  +- SubqueryAlias `ad2`
                        :  :  :     +- SubqueryAlias `tpcds`.`customer_address`
                        :  :  :        +- Relation[ca_address_sk#361,ca_address_id#362,ca_street_number#363,ca_street_name#364,ca_street_type#365,ca_suite_number#366,ca_city#367,ca_county#368,ca_state#369,ca_zip#370,ca_country#371,ca_gmt_offset#372,ca_location_type#373] parquet
                        :  :  +- SubqueryAlias `ib1`
                        :  :     +- SubqueryAlias `tpcds`.`income_band`
                        :  :        +- Relation[ib_income_band_sk#266,ib_lower_bound#267,ib_upper_bound#268] parquet
                        :  +- SubqueryAlias `ib2`
                        :     +- SubqueryAlias `tpcds`.`income_band`
                        :        +- Relation[ib_income_band_sk#374,ib_lower_bound#375,ib_upper_bound#376] parquet
                        +- SubqueryAlias `tpcds`.`item`
                           +- Relation[i_item_sk#269,i_item_id#270,i_rec_start_date#271,i_rec_end_date#272,i_item_desc#273,i_current_price#274,i_wholesale_cost#275,i_brand_id#276,i_brand#277,i_class_id#278,i_class#279,i_category_id#280,i_category#281,i_manufact_id#282,i_manufact#283,i_size#284,i_formulation#285,i_color#286,i_units#287,i_container#288,i_manager_id#289,i_product_name#290] parquet

== Optimized Logical Plan ==
Sort [product_name#10 ASC NULLS FIRST, store_name#12 ASC NULLS FIRST, cnt_2#7L ASC NULLS FIRST], true
+- Project [product_name#10, store_name#12, store_zip#13, b_street_number#14, b_street_name#15, b_city#16, b_zip#17, c_street_number#18, c_street_name#19, c_city#20, c_zip#21, syear#22, cnt#25L, s1#26 AS s11#0, s2#27 AS s21#1, s3#28 AS s31#2, s1#399 AS s12#3, s2#400 AS s22#4, s3#401 AS s32#5, syear#395 AS syear_2#6, cnt#398L AS cnt_2#7L]
   +- Join Inner, ((((item_sk#11 = item_sk#384) && (cnt#398L <= cnt#25L)) && (store_name#12 = store_name#385)) && (store_zip#13 = store_zip#386))
      :- Aggregate [i_product_name#290, i_item_sk#269, s_store_name#178, s_zip#198, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262, ca_street_number#363, ca_street_name#364, ca_city#367, ca_zip#370, d_year#151, d_year#297, d_year#325], [i_product_name#290 AS product_name#10, i_item_sk#269 AS item_sk#11, s_store_name#178 AS store_name#12, s_zip#198 AS store_zip#13, ca_street_number#255 AS b_street_number#14, ca_street_name#256 AS b_street_name#15, ca_city#259 AS b_city#16, ca_zip#262 AS b_zip#17, ca_street_number#363 AS c_street_number#18, ca_street_name#364 AS c_street_name#19, ca_city#367 AS c_city#20, ca_zip#370 AS c_zip#21, d_year#151 AS syear#22, count(1) AS cnt#25L, sum(ss_wholesale_cost#113) AS s1#26, sum(ss_list_price#114) AS s2#27, sum(ss_coupon_amt#121) AS s3#28]
      :  +- Project [ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, d_year#297, d_year#325, s_store_name#178, s_zip#198, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262, ca_street_number#363, ca_street_name#364, ca_city#367, ca_zip#370, i_item_sk#269, i_product_name#290]
      :     +- Join Inner, (ss_item_sk#104 = i_item_sk#269)
      :        :- Project [ss_item_sk#104, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, d_year#297, d_year#325, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262, ca_street_number#363, ca_street_name#364, ca_city#367, ca_zip#370]
      :        :  +- Join Inner, (hd_income_band_sk#357 = ib_income_band_sk#374)
      :        :     :- Project [ss_item_sk#104, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, d_year#297, d_year#325, hd_income_band_sk#357, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262, ca_street_number#363, ca_street_name#364, ca_city#367, ca_zip#370]
      :        :     :  +- Join Inner, (hd_income_band_sk#249 = ib_income_band_sk#266)
      :        :     :     :- Project [ss_item_sk#104, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, d_year#297, d_year#325, hd_income_band_sk#249, hd_income_band_sk#357, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262, ca_street_number#363, ca_street_name#364, ca_city#367, ca_zip#370]
      :        :     :     :  +- Join Inner, (c_current_addr_sk#206 = ca_address_sk#361)
      :        :     :     :     :- Project [ss_item_sk#104, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_addr_sk#206, d_year#297, d_year#325, hd_income_band_sk#249, hd_income_band_sk#357, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262]
      :        :     :     :     :  +- Join Inner, (ss_addr_sk#108 = ca_address_sk#253)
      :        :     :     :     :     :- Project [ss_item_sk#104, ss_addr_sk#108, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_addr_sk#206, d_year#297, d_year#325, hd_income_band_sk#249, hd_income_band_sk#357]
      :        :     :     :     :     :  +- Join Inner, (c_current_hdemo_sk#205 = hd_demo_sk#356)
      :        :     :     :     :     :     :- Project [ss_item_sk#104, ss_addr_sk#108, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_hdemo_sk#205, c_current_addr_sk#206, d_year#297, d_year#325, hd_income_band_sk#249]
      :        :     :     :     :     :     :  +- Join Inner, (ss_hdemo_sk#107 = hd_demo_sk#248)
      :        :     :     :     :     :     :     :- Project [ss_item_sk#104, ss_hdemo_sk#107, ss_addr_sk#108, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_hdemo_sk#205, c_current_addr_sk#206, d_year#297, d_year#325]
      :        :     :     :     :     :     :     :  +- Join Inner, (ss_promo_sk#110 = p_promo_sk#229)
      :        :     :     :     :     :     :     :     :- Project [ss_item_sk#104, ss_hdemo_sk#107, ss_addr_sk#108, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_hdemo_sk#205, c_current_addr_sk#206, d_year#297, d_year#325]
      :        :     :     :     :     :     :     :     :  +- Join Inner, ((c_current_cdemo_sk#204 = cd_demo_sk#347) && NOT (cd_marital_status#222 = cd_marital_status#349))
      :        :     :     :     :     :     :     :     :     :- Project [ss_item_sk#104, ss_hdemo_sk#107, ss_addr_sk#108, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_cdemo_sk#204, c_current_hdemo_sk#205, c_current_addr_sk#206, d_year#297, d_year#325, cd_marital_status#222]
      :        :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_cdemo_sk#106 = cd_demo_sk#220)
      :        :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#104, ss_cdemo_sk#106, ss_hdemo_sk#107, ss_addr_sk#108, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_cdemo_sk#204, c_current_hdemo_sk#205, c_current_addr_sk#206, d_year#297, d_year#325]
      :        :     :     :     :     :     :     :     :     :     :  +- Join Inner, (c_first_shipto_date_sk#207 = d_date_sk#319)
      :        :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#104, ss_cdemo_sk#106, ss_hdemo_sk#107, ss_addr_sk#108, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_cdemo_sk#204, c_current_hdemo_sk#205, c_current_addr_sk#206, c_first_shipto_date_sk#207, d_year#297]
      :        :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (c_first_sales_date_sk#208 = d_date_sk#291)
      :        :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#104, ss_cdemo_sk#106, ss_hdemo_sk#107, ss_addr_sk#108, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_cdemo_sk#204, c_current_hdemo_sk#205, c_current_addr_sk#206, c_first_shipto_date_sk#207, c_first_sales_date_sk#208]
      :        :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_customer_sk#105 = c_customer_sk#202)
      :        :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#104, ss_customer_sk#105, ss_cdemo_sk#106, ss_hdemo_sk#107, ss_addr_sk#108, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_store_sk#109 = s_store_sk#173)
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#104, ss_customer_sk#105, ss_cdemo_sk#106, ss_hdemo_sk#107, ss_addr_sk#108, ss_store_sk#109, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_sold_date_sk#102 = d_date_sk#145)
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#102, ss_item_sk#104, ss_customer_sk#105, ss_cdemo_sk#106, ss_hdemo_sk#107, ss_addr_sk#108, ss_store_sk#109, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_item_sk#104 = cs_item_sk#46)
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#102, ss_item_sk#104, ss_customer_sk#105, ss_cdemo_sk#106, ss_hdemo_sk#107, ss_addr_sk#108, ss_store_sk#109, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, ((ss_item_sk#104 = sr_item_sk#127) && (ss_ticket_number#111 = sr_ticket_number#134))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#102, ss_item_sk#104, ss_customer_sk#105, ss_cdemo_sk#106, ss_hdemo_sk#107, ss_addr_sk#108, ss_store_sk#109, ss_promo_sk#110, ss_ticket_number#111, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Filter ((((((((isnotnull(ss_item_sk#104) && isnotnull(ss_ticket_number#111)) && isnotnull(ss_sold_date_sk#102)) && isnotnull(ss_store_sk#109)) && isnotnull(ss_customer_sk#105)) && isnotnull(ss_cdemo_sk#106)) && isnotnull(ss_promo_sk#110)) && isnotnull(ss_hdemo_sk#107)) && isnotnull(ss_addr_sk#108))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Relation[ss_sold_date_sk#102,ss_sold_time_sk#103,ss_item_sk#104,ss_customer_sk#105,ss_cdemo_sk#106,ss_hdemo_sk#107,ss_addr_sk#108,ss_store_sk#109,ss_promo_sk#110,ss_ticket_number#111,ss_quantity#112,ss_wholesale_cost#113,ss_list_price#114,ss_sales_price#115,ss_ext_discount_amt#116,ss_ext_sales_price#117,ss_ext_wholesale_cost#118,ss_ext_list_price#119,ss_ext_tax#120,ss_coupon_amt#121,ss_net_paid#122,ss_net_paid_inc_tax#123,ss_net_profit#124] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [sr_item_sk#127, sr_ticket_number#134]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sr_item_sk#127) && isnotnull(sr_ticket_number#134))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[sr_returned_date_sk#125,sr_return_time_sk#126,sr_item_sk#127,sr_customer_sk#128,sr_cdemo_sk#129,sr_hdemo_sk#130,sr_addr_sk#131,sr_store_sk#132,sr_reason_sk#133,sr_ticket_number#134,sr_return_quantity#135,sr_return_amt#136,sr_return_tax#137,sr_return_amt_inc_tax#138,sr_fee#139,sr_return_ship_cost#140,sr_refunded_cash#141,sr_reversed_charge#142,sr_store_credit#143,sr_net_loss#144] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [cs_item_sk#46]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(sum(cs_ext_list_price#56)#97) && isnotnull(sum(((cr_refunded_cash#88 + cr_reversed_charge#89) + cr_store_credit#90))#98)) && (sum(cs_ext_list_price#56)#97 > (2.0 * sum(((cr_refunded_cash#88 + cr_reversed_charge#89) + cr_store_credit#90))#98)))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Aggregate [cs_item_sk#46], [cs_item_sk#46, sum(cs_ext_list_price#56) AS sum(cs_ext_list_price#56)#97, sum(((cr_refunded_cash#88 + cr_reversed_charge#89) + cr_store_credit#90)) AS sum(((cr_refunded_cash#88 + cr_reversed_charge#89) + cr_store_credit#90))#98]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- Project [cs_item_sk#46, cs_ext_list_price#56, cr_refunded_cash#88, cr_reversed_charge#89, cr_store_credit#90]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Join Inner, ((cs_item_sk#46 = cr_item_sk#67) && (cs_order_number#48 = cr_order_number#81))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :- Project [cs_item_sk#46, cs_order_number#48, cs_ext_list_price#56]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :  +- Filter (isnotnull(cs_item_sk#46) && isnotnull(cs_order_number#48))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :     +- Relation[cs_sold_date_sk#31,cs_sold_time_sk#32,cs_ship_date_sk#33,cs_bill_customer_sk#34,cs_bill_cdemo_sk#35,cs_bill_hdemo_sk#36,cs_bill_addr_sk#37,cs_ship_customer_sk#38,cs_ship_cdemo_sk#39,cs_ship_hdemo_sk#40,cs_ship_addr_sk#41,cs_call_center_sk#42,cs_catalog_page_sk#43,cs_ship_mode_sk#44,cs_warehouse_sk#45,cs_item_sk#46,cs_promo_sk#47,cs_order_number#48,cs_quantity#49,cs_wholesale_cost#50,cs_list_price#51,cs_sales_price#52,cs_ext_discount_amt#53,cs_ext_sales_price#54,... 10 more fields] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- Project [cr_item_sk#67, cr_order_number#81, cr_refunded_cash#88, cr_reversed_charge#89, cr_store_credit#90]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- Filter (isnotnull(cr_item_sk#67) && isnotnull(cr_order_number#81))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- Relation[cr_returned_date_sk#65,cr_returned_time_sk#66,cr_item_sk#67,cr_refunded_customer_sk#68,cr_refunded_cdemo_sk#69,cr_refunded_hdemo_sk#70,cr_refunded_addr_sk#71,cr_returning_customer_sk#72,cr_returning_cdemo_sk#73,cr_returning_hdemo_sk#74,cr_returning_addr_sk#75,cr_call_center_sk#76,cr_catalog_page_sk#77,cr_ship_mode_sk#78,cr_warehouse_sk#79,cr_reason_sk#80,cr_order_number#81,cr_return_quantity#82,cr_return_amount#83,cr_return_tax#84,cr_return_amt_inc_tax#85,cr_fee#86,cr_return_ship_cost#87,cr_refunded_cash#88,... 3 more fields] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#145, d_year#151]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(d_year#151) && (d_year#151 = 1999)) && isnotnull(d_date_sk#145))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[d_date_sk#145,d_date_id#146,d_date#147,d_month_seq#148,d_week_seq#149,d_quarter_seq#150,d_year#151,d_dow#152,d_moy#153,d_dom#154,d_qoy#155,d_fy_year#156,d_fy_quarter_seq#157,d_fy_week_seq#158,d_day_name#159,d_quarter_name#160,d_holiday#161,d_weekend#162,d_following_holiday#163,d_first_dom#164,d_last_dom#165,d_same_day_ly#166,d_same_day_lq#167,d_current_day#168,... 4 more fields] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [s_store_sk#173, s_store_name#178, s_zip#198]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(s_store_sk#173) && isnotnull(s_zip#198)) && isnotnull(s_store_name#178))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[s_store_sk#173,s_store_id#174,s_rec_start_date#175,s_rec_end_date#176,s_closed_date_sk#177,s_store_name#178,s_number_employees#179,s_floor_space#180,s_hours#181,s_manager#182,s_market_id#183,s_geography_class#184,s_market_desc#185,s_market_manager#186,s_division_id#187,s_division_name#188,s_company_id#189,s_company_name#190,s_street_number#191,s_street_name#192,s_street_type#193,s_suite_number#194,s_city#195,s_county#196,... 5 more fields] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     +- Project [c_customer_sk#202, c_current_cdemo_sk#204, c_current_hdemo_sk#205, c_current_addr_sk#206, c_first_shipto_date_sk#207, c_first_sales_date_sk#208]
      :        :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (((((isnotnull(c_customer_sk#202) && isnotnull(c_first_sales_date_sk#208)) && isnotnull(c_first_shipto_date_sk#207)) && isnotnull(c_current_cdemo_sk#204)) && isnotnull(c_current_hdemo_sk#205)) && isnotnull(c_current_addr_sk#206))
      :        :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[c_customer_sk#202,c_customer_id#203,c_current_cdemo_sk#204,c_current_hdemo_sk#205,c_current_addr_sk#206,c_first_shipto_date_sk#207,c_first_sales_date_sk#208,c_salutation#209,c_first_name#210,c_last_name#211,c_preferred_cust_flag#212,c_birth_day#213,c_birth_month#214,c_birth_year#215,c_birth_country#216,c_login#217,c_email_address#218,c_last_review_date#219] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#291, d_year#297]
      :        :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#291)
      :        :     :     :     :     :     :     :     :     :     :     :           +- Relation[d_date_sk#291,d_date_id#292,d_date#293,d_month_seq#294,d_week_seq#295,d_quarter_seq#296,d_year#297,d_dow#298,d_moy#299,d_dom#300,d_qoy#301,d_fy_year#302,d_fy_quarter_seq#303,d_fy_week_seq#304,d_day_name#305,d_quarter_name#306,d_holiday#307,d_weekend#308,d_following_holiday#309,d_first_dom#310,d_last_dom#311,d_same_day_ly#312,d_same_day_lq#313,d_current_day#314,... 4 more fields] parquet
      :        :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#319, d_year#325]
      :        :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#319)
      :        :     :     :     :     :     :     :     :     :     :           +- Relation[d_date_sk#319,d_date_id#320,d_date#321,d_month_seq#322,d_week_seq#323,d_quarter_seq#324,d_year#325,d_dow#326,d_moy#327,d_dom#328,d_qoy#329,d_fy_year#330,d_fy_quarter_seq#331,d_fy_week_seq#332,d_day_name#333,d_quarter_name#334,d_holiday#335,d_weekend#336,d_following_holiday#337,d_first_dom#338,d_last_dom#339,d_same_day_ly#340,d_same_day_lq#341,d_current_day#342,... 4 more fields] parquet
      :        :     :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#220, cd_marital_status#222]
      :        :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#220) && isnotnull(cd_marital_status#222))
      :        :     :     :     :     :     :     :     :     :           +- Relation[cd_demo_sk#220,cd_gender#221,cd_marital_status#222,cd_education_status#223,cd_purchase_estimate#224,cd_credit_rating#225,cd_dep_count#226,cd_dep_employed_count#227,cd_dep_college_count#228] parquet
      :        :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#347, cd_marital_status#349]
      :        :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#347) && isnotnull(cd_marital_status#349))
      :        :     :     :     :     :     :     :     :           +- Relation[cd_demo_sk#347,cd_gender#348,cd_marital_status#349,cd_education_status#350,cd_purchase_estimate#351,cd_credit_rating#352,cd_dep_count#353,cd_dep_employed_count#354,cd_dep_college_count#355] parquet
      :        :     :     :     :     :     :     :     +- Project [p_promo_sk#229]
      :        :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#229)
      :        :     :     :     :     :     :     :           +- Relation[p_promo_sk#229,p_promo_id#230,p_start_date_sk#231,p_end_date_sk#232,p_item_sk#233,p_cost#234,p_response_target#235,p_promo_name#236,p_channel_dmail#237,p_channel_email#238,p_channel_catalog#239,p_channel_tv#240,p_channel_radio#241,p_channel_press#242,p_channel_event#243,p_channel_demo#244,p_channel_details#245,p_purpose#246,p_discount_active#247] parquet
      :        :     :     :     :     :     :     +- Project [hd_demo_sk#248, hd_income_band_sk#249]
      :        :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#248) && isnotnull(hd_income_band_sk#249))
      :        :     :     :     :     :     :           +- Relation[hd_demo_sk#248,hd_income_band_sk#249,hd_buy_potential#250,hd_dep_count#251,hd_vehicle_count#252] parquet
      :        :     :     :     :     :     +- Project [hd_demo_sk#356, hd_income_band_sk#357]
      :        :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#356) && isnotnull(hd_income_band_sk#357))
      :        :     :     :     :     :           +- Relation[hd_demo_sk#356,hd_income_band_sk#357,hd_buy_potential#358,hd_dep_count#359,hd_vehicle_count#360] parquet
      :        :     :     :     :     +- Project [ca_address_sk#253, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262]
      :        :     :     :     :        +- Filter isnotnull(ca_address_sk#253)
      :        :     :     :     :           +- Relation[ca_address_sk#253,ca_address_id#254,ca_street_number#255,ca_street_name#256,ca_street_type#257,ca_suite_number#258,ca_city#259,ca_county#260,ca_state#261,ca_zip#262,ca_country#263,ca_gmt_offset#264,ca_location_type#265] parquet
      :        :     :     :     +- Project [ca_address_sk#361, ca_street_number#363, ca_street_name#364, ca_city#367, ca_zip#370]
      :        :     :     :        +- Filter isnotnull(ca_address_sk#361)
      :        :     :     :           +- Relation[ca_address_sk#361,ca_address_id#362,ca_street_number#363,ca_street_name#364,ca_street_type#365,ca_suite_number#366,ca_city#367,ca_county#368,ca_state#369,ca_zip#370,ca_country#371,ca_gmt_offset#372,ca_location_type#373] parquet
      :        :     :     +- Project [ib_income_band_sk#266]
      :        :     :        +- Filter isnotnull(ib_income_band_sk#266)
      :        :     :           +- Relation[ib_income_band_sk#266,ib_lower_bound#267,ib_upper_bound#268] parquet
      :        :     +- Project [ib_income_band_sk#374]
      :        :        +- Filter isnotnull(ib_income_band_sk#374)
      :        :           +- Relation[ib_income_band_sk#374,ib_lower_bound#375,ib_upper_bound#376] parquet
      :        +- Project [i_item_sk#269, i_product_name#290]
      :           +- Filter ((((((isnotnull(i_current_price#274) && i_color#286 IN (purple,burlywood,indian,spring,floral,medium)) && (i_current_price#274 >= 64.0)) && (i_current_price#274 <= 74.0)) && (i_current_price#274 >= 65.0)) && (i_current_price#274 <= 79.0)) && isnotnull(i_item_sk#269))
      :              +- Relation[i_item_sk#269,i_item_id#270,i_rec_start_date#271,i_rec_end_date#272,i_item_desc#273,i_current_price#274,i_wholesale_cost#275,i_brand_id#276,i_brand#277,i_class_id#278,i_class#279,i_category_id#280,i_category#281,i_manufact_id#282,i_manufact#283,i_size#284,i_formulation#285,i_color#286,i_units#287,i_container#288,i_manager_id#289,i_product_name#290] parquet
      +- Aggregate [i_product_name#290, i_item_sk#269, s_store_name#178, s_zip#198, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262, ca_street_number#363, ca_street_name#364, ca_city#367, ca_zip#370, d_year#151, d_year#297, d_year#325], [i_item_sk#269 AS item_sk#384, s_store_name#178 AS store_name#385, s_zip#198 AS store_zip#386, d_year#151 AS syear#395, count(1) AS cnt#398L, sum(ss_wholesale_cost#113) AS s1#399, sum(ss_list_price#114) AS s2#400, sum(ss_coupon_amt#121) AS s3#401]
         +- Project [ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, d_year#297, d_year#325, s_store_name#178, s_zip#198, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262, ca_street_number#363, ca_street_name#364, ca_city#367, ca_zip#370, i_item_sk#269, i_product_name#290]
            +- Join Inner, (ss_item_sk#104 = i_item_sk#269)
               :- Project [ss_item_sk#104, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, d_year#297, d_year#325, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262, ca_street_number#363, ca_street_name#364, ca_city#367, ca_zip#370]
               :  +- Join Inner, (hd_income_band_sk#357 = ib_income_band_sk#374)
               :     :- Project [ss_item_sk#104, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, d_year#297, d_year#325, hd_income_band_sk#357, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262, ca_street_number#363, ca_street_name#364, ca_city#367, ca_zip#370]
               :     :  +- Join Inner, (hd_income_band_sk#249 = ib_income_band_sk#266)
               :     :     :- Project [ss_item_sk#104, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, d_year#297, d_year#325, hd_income_band_sk#249, hd_income_band_sk#357, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262, ca_street_number#363, ca_street_name#364, ca_city#367, ca_zip#370]
               :     :     :  +- Join Inner, (c_current_addr_sk#206 = ca_address_sk#361)
               :     :     :     :- Project [ss_item_sk#104, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_addr_sk#206, d_year#297, d_year#325, hd_income_band_sk#249, hd_income_band_sk#357, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262]
               :     :     :     :  +- Join Inner, (ss_addr_sk#108 = ca_address_sk#253)
               :     :     :     :     :- Project [ss_item_sk#104, ss_addr_sk#108, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_addr_sk#206, d_year#297, d_year#325, hd_income_band_sk#249, hd_income_band_sk#357]
               :     :     :     :     :  +- Join Inner, (c_current_hdemo_sk#205 = hd_demo_sk#356)
               :     :     :     :     :     :- Project [ss_item_sk#104, ss_addr_sk#108, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_hdemo_sk#205, c_current_addr_sk#206, d_year#297, d_year#325, hd_income_band_sk#249]
               :     :     :     :     :     :  +- Join Inner, (ss_hdemo_sk#107 = hd_demo_sk#248)
               :     :     :     :     :     :     :- Project [ss_item_sk#104, ss_hdemo_sk#107, ss_addr_sk#108, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_hdemo_sk#205, c_current_addr_sk#206, d_year#297, d_year#325]
               :     :     :     :     :     :     :  +- Join Inner, (ss_promo_sk#110 = p_promo_sk#229)
               :     :     :     :     :     :     :     :- Project [ss_item_sk#104, ss_hdemo_sk#107, ss_addr_sk#108, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_hdemo_sk#205, c_current_addr_sk#206, d_year#297, d_year#325]
               :     :     :     :     :     :     :     :  +- Join Inner, ((c_current_cdemo_sk#204 = cd_demo_sk#347) && NOT (cd_marital_status#222 = cd_marital_status#349))
               :     :     :     :     :     :     :     :     :- Project [ss_item_sk#104, ss_hdemo_sk#107, ss_addr_sk#108, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_cdemo_sk#204, c_current_hdemo_sk#205, c_current_addr_sk#206, d_year#297, d_year#325, cd_marital_status#222]
               :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_cdemo_sk#106 = cd_demo_sk#220)
               :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#104, ss_cdemo_sk#106, ss_hdemo_sk#107, ss_addr_sk#108, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_cdemo_sk#204, c_current_hdemo_sk#205, c_current_addr_sk#206, d_year#297, d_year#325]
               :     :     :     :     :     :     :     :     :     :  +- Join Inner, (c_first_shipto_date_sk#207 = d_date_sk#319)
               :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#104, ss_cdemo_sk#106, ss_hdemo_sk#107, ss_addr_sk#108, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_cdemo_sk#204, c_current_hdemo_sk#205, c_current_addr_sk#206, c_first_shipto_date_sk#207, d_year#297]
               :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (c_first_sales_date_sk#208 = d_date_sk#291)
               :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#104, ss_cdemo_sk#106, ss_hdemo_sk#107, ss_addr_sk#108, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_cdemo_sk#204, c_current_hdemo_sk#205, c_current_addr_sk#206, c_first_shipto_date_sk#207, c_first_sales_date_sk#208]
               :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_customer_sk#105 = c_customer_sk#202)
               :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#104, ss_customer_sk#105, ss_cdemo_sk#106, ss_hdemo_sk#107, ss_addr_sk#108, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198]
               :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_store_sk#109 = s_store_sk#173)
               :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#104, ss_customer_sk#105, ss_cdemo_sk#106, ss_hdemo_sk#107, ss_addr_sk#108, ss_store_sk#109, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_sold_date_sk#102 = d_date_sk#145)
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#102, ss_item_sk#104, ss_customer_sk#105, ss_cdemo_sk#106, ss_hdemo_sk#107, ss_addr_sk#108, ss_store_sk#109, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_item_sk#104 = cs_item_sk#46)
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#102, ss_item_sk#104, ss_customer_sk#105, ss_cdemo_sk#106, ss_hdemo_sk#107, ss_addr_sk#108, ss_store_sk#109, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, ((ss_item_sk#104 = sr_item_sk#127) && (ss_ticket_number#111 = sr_ticket_number#134))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#102, ss_item_sk#104, ss_customer_sk#105, ss_cdemo_sk#106, ss_hdemo_sk#107, ss_addr_sk#108, ss_store_sk#109, ss_promo_sk#110, ss_ticket_number#111, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Filter ((((((((isnotnull(ss_item_sk#104) && isnotnull(ss_ticket_number#111)) && isnotnull(ss_sold_date_sk#102)) && isnotnull(ss_store_sk#109)) && isnotnull(ss_customer_sk#105)) && isnotnull(ss_cdemo_sk#106)) && isnotnull(ss_promo_sk#110)) && isnotnull(ss_hdemo_sk#107)) && isnotnull(ss_addr_sk#108))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Relation[ss_sold_date_sk#102,ss_sold_time_sk#103,ss_item_sk#104,ss_customer_sk#105,ss_cdemo_sk#106,ss_hdemo_sk#107,ss_addr_sk#108,ss_store_sk#109,ss_promo_sk#110,ss_ticket_number#111,ss_quantity#112,ss_wholesale_cost#113,ss_list_price#114,ss_sales_price#115,ss_ext_discount_amt#116,ss_ext_sales_price#117,ss_ext_wholesale_cost#118,ss_ext_list_price#119,ss_ext_tax#120,ss_coupon_amt#121,ss_net_paid#122,ss_net_paid_inc_tax#123,ss_net_profit#124] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [sr_item_sk#127, sr_ticket_number#134]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sr_item_sk#127) && isnotnull(sr_ticket_number#134))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[sr_returned_date_sk#125,sr_return_time_sk#126,sr_item_sk#127,sr_customer_sk#128,sr_cdemo_sk#129,sr_hdemo_sk#130,sr_addr_sk#131,sr_store_sk#132,sr_reason_sk#133,sr_ticket_number#134,sr_return_quantity#135,sr_return_amt#136,sr_return_tax#137,sr_return_amt_inc_tax#138,sr_fee#139,sr_return_ship_cost#140,sr_refunded_cash#141,sr_reversed_charge#142,sr_store_credit#143,sr_net_loss#144] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [cs_item_sk#46]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(sum(cs_ext_list_price#56)#97) && isnotnull(sum(((cr_refunded_cash#88 + cr_reversed_charge#89) + cr_store_credit#90))#98)) && (sum(cs_ext_list_price#56)#97 > (2.0 * sum(((cr_refunded_cash#88 + cr_reversed_charge#89) + cr_store_credit#90))#98)))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Aggregate [cs_item_sk#46], [cs_item_sk#46, sum(cs_ext_list_price#56) AS sum(cs_ext_list_price#56)#97, sum(((cr_refunded_cash#88 + cr_reversed_charge#89) + cr_store_credit#90)) AS sum(((cr_refunded_cash#88 + cr_reversed_charge#89) + cr_store_credit#90))#98]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- Project [cs_item_sk#46, cs_ext_list_price#56, cr_refunded_cash#88, cr_reversed_charge#89, cr_store_credit#90]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Join Inner, ((cs_item_sk#46 = cr_item_sk#67) && (cs_order_number#48 = cr_order_number#81))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :- Project [cs_item_sk#46, cs_order_number#48, cs_ext_list_price#56]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :  +- Filter (isnotnull(cs_item_sk#46) && isnotnull(cs_order_number#48))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :     +- Relation[cs_sold_date_sk#31,cs_sold_time_sk#32,cs_ship_date_sk#33,cs_bill_customer_sk#34,cs_bill_cdemo_sk#35,cs_bill_hdemo_sk#36,cs_bill_addr_sk#37,cs_ship_customer_sk#38,cs_ship_cdemo_sk#39,cs_ship_hdemo_sk#40,cs_ship_addr_sk#41,cs_call_center_sk#42,cs_catalog_page_sk#43,cs_ship_mode_sk#44,cs_warehouse_sk#45,cs_item_sk#46,cs_promo_sk#47,cs_order_number#48,cs_quantity#49,cs_wholesale_cost#50,cs_list_price#51,cs_sales_price#52,cs_ext_discount_amt#53,cs_ext_sales_price#54,... 10 more fields] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- Project [cr_item_sk#67, cr_order_number#81, cr_refunded_cash#88, cr_reversed_charge#89, cr_store_credit#90]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- Filter (isnotnull(cr_item_sk#67) && isnotnull(cr_order_number#81))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- Relation[cr_returned_date_sk#65,cr_returned_time_sk#66,cr_item_sk#67,cr_refunded_customer_sk#68,cr_refunded_cdemo_sk#69,cr_refunded_hdemo_sk#70,cr_refunded_addr_sk#71,cr_returning_customer_sk#72,cr_returning_cdemo_sk#73,cr_returning_hdemo_sk#74,cr_returning_addr_sk#75,cr_call_center_sk#76,cr_catalog_page_sk#77,cr_ship_mode_sk#78,cr_warehouse_sk#79,cr_reason_sk#80,cr_order_number#81,cr_return_quantity#82,cr_return_amount#83,cr_return_tax#84,cr_return_amt_inc_tax#85,cr_fee#86,cr_return_ship_cost#87,cr_refunded_cash#88,... 3 more fields] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#145, d_year#151]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(d_year#151) && (d_year#151 = 2000)) && isnotnull(d_date_sk#145))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[d_date_sk#145,d_date_id#146,d_date#147,d_month_seq#148,d_week_seq#149,d_quarter_seq#150,d_year#151,d_dow#152,d_moy#153,d_dom#154,d_qoy#155,d_fy_year#156,d_fy_quarter_seq#157,d_fy_week_seq#158,d_day_name#159,d_quarter_name#160,d_holiday#161,d_weekend#162,d_following_holiday#163,d_first_dom#164,d_last_dom#165,d_same_day_ly#166,d_same_day_lq#167,d_current_day#168,... 4 more fields] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [s_store_sk#173, s_store_name#178, s_zip#198]
               :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(s_store_sk#173) && isnotnull(s_zip#198)) && isnotnull(s_store_name#178))
               :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[s_store_sk#173,s_store_id#174,s_rec_start_date#175,s_rec_end_date#176,s_closed_date_sk#177,s_store_name#178,s_number_employees#179,s_floor_space#180,s_hours#181,s_manager#182,s_market_id#183,s_geography_class#184,s_market_desc#185,s_market_manager#186,s_division_id#187,s_division_name#188,s_company_id#189,s_company_name#190,s_street_number#191,s_street_name#192,s_street_type#193,s_suite_number#194,s_city#195,s_county#196,... 5 more fields] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     +- Project [c_customer_sk#202, c_current_cdemo_sk#204, c_current_hdemo_sk#205, c_current_addr_sk#206, c_first_shipto_date_sk#207, c_first_sales_date_sk#208]
               :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (((((isnotnull(c_customer_sk#202) && isnotnull(c_first_sales_date_sk#208)) && isnotnull(c_first_shipto_date_sk#207)) && isnotnull(c_current_cdemo_sk#204)) && isnotnull(c_current_hdemo_sk#205)) && isnotnull(c_current_addr_sk#206))
               :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[c_customer_sk#202,c_customer_id#203,c_current_cdemo_sk#204,c_current_hdemo_sk#205,c_current_addr_sk#206,c_first_shipto_date_sk#207,c_first_sales_date_sk#208,c_salutation#209,c_first_name#210,c_last_name#211,c_preferred_cust_flag#212,c_birth_day#213,c_birth_month#214,c_birth_year#215,c_birth_country#216,c_login#217,c_email_address#218,c_last_review_date#219] parquet
               :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#291, d_year#297]
               :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#291)
               :     :     :     :     :     :     :     :     :     :     :           +- Relation[d_date_sk#291,d_date_id#292,d_date#293,d_month_seq#294,d_week_seq#295,d_quarter_seq#296,d_year#297,d_dow#298,d_moy#299,d_dom#300,d_qoy#301,d_fy_year#302,d_fy_quarter_seq#303,d_fy_week_seq#304,d_day_name#305,d_quarter_name#306,d_holiday#307,d_weekend#308,d_following_holiday#309,d_first_dom#310,d_last_dom#311,d_same_day_ly#312,d_same_day_lq#313,d_current_day#314,... 4 more fields] parquet
               :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#319, d_year#325]
               :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#319)
               :     :     :     :     :     :     :     :     :     :           +- Relation[d_date_sk#319,d_date_id#320,d_date#321,d_month_seq#322,d_week_seq#323,d_quarter_seq#324,d_year#325,d_dow#326,d_moy#327,d_dom#328,d_qoy#329,d_fy_year#330,d_fy_quarter_seq#331,d_fy_week_seq#332,d_day_name#333,d_quarter_name#334,d_holiday#335,d_weekend#336,d_following_holiday#337,d_first_dom#338,d_last_dom#339,d_same_day_ly#340,d_same_day_lq#341,d_current_day#342,... 4 more fields] parquet
               :     :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#220, cd_marital_status#222]
               :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#220) && isnotnull(cd_marital_status#222))
               :     :     :     :     :     :     :     :     :           +- Relation[cd_demo_sk#220,cd_gender#221,cd_marital_status#222,cd_education_status#223,cd_purchase_estimate#224,cd_credit_rating#225,cd_dep_count#226,cd_dep_employed_count#227,cd_dep_college_count#228] parquet
               :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#347, cd_marital_status#349]
               :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#347) && isnotnull(cd_marital_status#349))
               :     :     :     :     :     :     :     :           +- Relation[cd_demo_sk#347,cd_gender#348,cd_marital_status#349,cd_education_status#350,cd_purchase_estimate#351,cd_credit_rating#352,cd_dep_count#353,cd_dep_employed_count#354,cd_dep_college_count#355] parquet
               :     :     :     :     :     :     :     +- Project [p_promo_sk#229]
               :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#229)
               :     :     :     :     :     :     :           +- Relation[p_promo_sk#229,p_promo_id#230,p_start_date_sk#231,p_end_date_sk#232,p_item_sk#233,p_cost#234,p_response_target#235,p_promo_name#236,p_channel_dmail#237,p_channel_email#238,p_channel_catalog#239,p_channel_tv#240,p_channel_radio#241,p_channel_press#242,p_channel_event#243,p_channel_demo#244,p_channel_details#245,p_purpose#246,p_discount_active#247] parquet
               :     :     :     :     :     :     +- Project [hd_demo_sk#248, hd_income_band_sk#249]
               :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#248) && isnotnull(hd_income_band_sk#249))
               :     :     :     :     :     :           +- Relation[hd_demo_sk#248,hd_income_band_sk#249,hd_buy_potential#250,hd_dep_count#251,hd_vehicle_count#252] parquet
               :     :     :     :     :     +- Project [hd_demo_sk#356, hd_income_band_sk#357]
               :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#356) && isnotnull(hd_income_band_sk#357))
               :     :     :     :     :           +- Relation[hd_demo_sk#356,hd_income_band_sk#357,hd_buy_potential#358,hd_dep_count#359,hd_vehicle_count#360] parquet
               :     :     :     :     +- Project [ca_address_sk#253, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262]
               :     :     :     :        +- Filter isnotnull(ca_address_sk#253)
               :     :     :     :           +- Relation[ca_address_sk#253,ca_address_id#254,ca_street_number#255,ca_street_name#256,ca_street_type#257,ca_suite_number#258,ca_city#259,ca_county#260,ca_state#261,ca_zip#262,ca_country#263,ca_gmt_offset#264,ca_location_type#265] parquet
               :     :     :     +- Project [ca_address_sk#361, ca_street_number#363, ca_street_name#364, ca_city#367, ca_zip#370]
               :     :     :        +- Filter isnotnull(ca_address_sk#361)
               :     :     :           +- Relation[ca_address_sk#361,ca_address_id#362,ca_street_number#363,ca_street_name#364,ca_street_type#365,ca_suite_number#366,ca_city#367,ca_county#368,ca_state#369,ca_zip#370,ca_country#371,ca_gmt_offset#372,ca_location_type#373] parquet
               :     :     +- Project [ib_income_band_sk#266]
               :     :        +- Filter isnotnull(ib_income_band_sk#266)
               :     :           +- Relation[ib_income_band_sk#266,ib_lower_bound#267,ib_upper_bound#268] parquet
               :     +- Project [ib_income_band_sk#374]
               :        +- Filter isnotnull(ib_income_band_sk#374)
               :           +- Relation[ib_income_band_sk#374,ib_lower_bound#375,ib_upper_bound#376] parquet
               +- Project [i_item_sk#269, i_product_name#290]
                  +- Filter ((((((isnotnull(i_current_price#274) && i_color#286 IN (purple,burlywood,indian,spring,floral,medium)) && (i_current_price#274 >= 64.0)) && (i_current_price#274 <= 74.0)) && (i_current_price#274 >= 65.0)) && (i_current_price#274 <= 79.0)) && isnotnull(i_item_sk#269))
                     +- Relation[i_item_sk#269,i_item_id#270,i_rec_start_date#271,i_rec_end_date#272,i_item_desc#273,i_current_price#274,i_wholesale_cost#275,i_brand_id#276,i_brand#277,i_class_id#278,i_class#279,i_category_id#280,i_category#281,i_manufact_id#282,i_manufact#283,i_size#284,i_formulation#285,i_color#286,i_units#287,i_container#288,i_manager_id#289,i_product_name#290] parquet

== Physical Plan ==
*(50) Sort [product_name#10 ASC NULLS FIRST, store_name#12 ASC NULLS FIRST, cnt_2#7L ASC NULLS FIRST], true, 0
+- Exchange rangepartitioning(product_name#10 ASC NULLS FIRST, store_name#12 ASC NULLS FIRST, cnt_2#7L ASC NULLS FIRST, 200)
   +- *(49) Project [product_name#10, store_name#12, store_zip#13, b_street_number#14, b_street_name#15, b_city#16, b_zip#17, c_street_number#18, c_street_name#19, c_city#20, c_zip#21, syear#22, cnt#25L, s1#26 AS s11#0, s2#27 AS s21#1, s3#28 AS s31#2, s1#399 AS s12#3, s2#400 AS s22#4, s3#401 AS s32#5, syear#395 AS syear_2#6, cnt#398L AS cnt_2#7L]
      +- *(49) SortMergeJoin [item_sk#11, store_name#12, store_zip#13], [item_sk#384, store_name#385, store_zip#386], Inner, (cnt#398L <= cnt#25L)
         :- *(24) Sort [item_sk#11 ASC NULLS FIRST, store_name#12 ASC NULLS FIRST, store_zip#13 ASC NULLS FIRST], false, 0
         :  +- Exchange hashpartitioning(item_sk#11, store_name#12, store_zip#13, 200)
         :     +- *(23) HashAggregate(keys=[i_product_name#290, i_item_sk#269, s_store_name#178, s_zip#198, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262, ca_street_number#363, ca_street_name#364, ca_city#367, ca_zip#370, d_year#151, d_year#297, d_year#325], functions=[count(1), sum(ss_wholesale_cost#113), sum(ss_list_price#114), sum(ss_coupon_amt#121)], output=[product_name#10, item_sk#11, store_name#12, store_zip#13, b_street_number#14, b_street_name#15, b_city#16, b_zip#17, c_street_number#18, c_street_name#19, c_city#20, c_zip#21, syear#22, cnt#25L, s1#26, s2#27, s3#28])
         :        +- Exchange hashpartitioning(i_product_name#290, i_item_sk#269, s_store_name#178, s_zip#198, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262, ca_street_number#363, ca_street_name#364, ca_city#367, ca_zip#370, d_year#151, d_year#297, d_year#325, 200)
         :           +- *(22) HashAggregate(keys=[i_product_name#290, i_item_sk#269, s_store_name#178, s_zip#198, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262, ca_street_number#363, ca_street_name#364, ca_city#367, ca_zip#370, d_year#151, d_year#297, d_year#325], functions=[partial_count(1), partial_sum(ss_wholesale_cost#113), partial_sum(ss_list_price#114), partial_sum(ss_coupon_amt#121)], output=[i_product_name#290, i_item_sk#269, s_store_name#178, s_zip#198, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262, ca_street_number#363, ca_street_name#364, ca_city#367, ca_zip#370, d_year#151, d_year#297, d_year#325, count#410L, sum#411, sum#412, sum#413])
         :              +- *(22) Project [ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, d_year#297, d_year#325, s_store_name#178, s_zip#198, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262, ca_street_number#363, ca_street_name#364, ca_city#367, ca_zip#370, i_item_sk#269, i_product_name#290]
         :                 +- *(22) BroadcastHashJoin [ss_item_sk#104], [i_item_sk#269], Inner, BuildRight
         :                    :- *(22) Project [ss_item_sk#104, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, d_year#297, d_year#325, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262, ca_street_number#363, ca_street_name#364, ca_city#367, ca_zip#370]
         :                    :  +- *(22) BroadcastHashJoin [hd_income_band_sk#357], [ib_income_band_sk#374], Inner, BuildRight
         :                    :     :- *(22) Project [ss_item_sk#104, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, d_year#297, d_year#325, hd_income_band_sk#357, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262, ca_street_number#363, ca_street_name#364, ca_city#367, ca_zip#370]
         :                    :     :  +- *(22) BroadcastHashJoin [hd_income_band_sk#249], [ib_income_band_sk#266], Inner, BuildRight
         :                    :     :     :- *(22) Project [ss_item_sk#104, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, d_year#297, d_year#325, hd_income_band_sk#249, hd_income_band_sk#357, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262, ca_street_number#363, ca_street_name#364, ca_city#367, ca_zip#370]
         :                    :     :     :  +- *(22) BroadcastHashJoin [c_current_addr_sk#206], [ca_address_sk#361], Inner, BuildRight
         :                    :     :     :     :- *(22) Project [ss_item_sk#104, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_addr_sk#206, d_year#297, d_year#325, hd_income_band_sk#249, hd_income_band_sk#357, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262]
         :                    :     :     :     :  +- *(22) BroadcastHashJoin [ss_addr_sk#108], [ca_address_sk#253], Inner, BuildRight
         :                    :     :     :     :     :- *(22) Project [ss_item_sk#104, ss_addr_sk#108, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_addr_sk#206, d_year#297, d_year#325, hd_income_band_sk#249, hd_income_band_sk#357]
         :                    :     :     :     :     :  +- *(22) BroadcastHashJoin [c_current_hdemo_sk#205], [hd_demo_sk#356], Inner, BuildRight
         :                    :     :     :     :     :     :- *(22) Project [ss_item_sk#104, ss_addr_sk#108, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_hdemo_sk#205, c_current_addr_sk#206, d_year#297, d_year#325, hd_income_band_sk#249]
         :                    :     :     :     :     :     :  +- *(22) BroadcastHashJoin [ss_hdemo_sk#107], [hd_demo_sk#248], Inner, BuildRight
         :                    :     :     :     :     :     :     :- *(22) Project [ss_item_sk#104, ss_hdemo_sk#107, ss_addr_sk#108, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_hdemo_sk#205, c_current_addr_sk#206, d_year#297, d_year#325]
         :                    :     :     :     :     :     :     :  +- *(22) BroadcastHashJoin [ss_promo_sk#110], [p_promo_sk#229], Inner, BuildRight
         :                    :     :     :     :     :     :     :     :- *(22) Project [ss_item_sk#104, ss_hdemo_sk#107, ss_addr_sk#108, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_hdemo_sk#205, c_current_addr_sk#206, d_year#297, d_year#325]
         :                    :     :     :     :     :     :     :     :  +- *(22) BroadcastHashJoin [c_current_cdemo_sk#204], [cd_demo_sk#347], Inner, BuildRight, NOT (cd_marital_status#222 = cd_marital_status#349)
         :                    :     :     :     :     :     :     :     :     :- *(22) Project [ss_item_sk#104, ss_hdemo_sk#107, ss_addr_sk#108, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_cdemo_sk#204, c_current_hdemo_sk#205, c_current_addr_sk#206, d_year#297, d_year#325, cd_marital_status#222]
         :                    :     :     :     :     :     :     :     :     :  +- *(22) BroadcastHashJoin [ss_cdemo_sk#106], [cd_demo_sk#220], Inner, BuildRight
         :                    :     :     :     :     :     :     :     :     :     :- *(22) Project [ss_item_sk#104, ss_cdemo_sk#106, ss_hdemo_sk#107, ss_addr_sk#108, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_cdemo_sk#204, c_current_hdemo_sk#205, c_current_addr_sk#206, d_year#297, d_year#325]
         :                    :     :     :     :     :     :     :     :     :     :  +- *(22) BroadcastHashJoin [c_first_shipto_date_sk#207], [d_date_sk#319], Inner, BuildRight
         :                    :     :     :     :     :     :     :     :     :     :     :- *(22) Project [ss_item_sk#104, ss_cdemo_sk#106, ss_hdemo_sk#107, ss_addr_sk#108, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_cdemo_sk#204, c_current_hdemo_sk#205, c_current_addr_sk#206, c_first_shipto_date_sk#207, d_year#297]
         :                    :     :     :     :     :     :     :     :     :     :     :  +- *(22) BroadcastHashJoin [c_first_sales_date_sk#208], [d_date_sk#291], Inner, BuildRight
         :                    :     :     :     :     :     :     :     :     :     :     :     :- *(22) Project [ss_item_sk#104, ss_cdemo_sk#106, ss_hdemo_sk#107, ss_addr_sk#108, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_cdemo_sk#204, c_current_hdemo_sk#205, c_current_addr_sk#206, c_first_shipto_date_sk#207, c_first_sales_date_sk#208]
         :                    :     :     :     :     :     :     :     :     :     :     :     :  +- *(22) BroadcastHashJoin [ss_customer_sk#105], [c_customer_sk#202], Inner, BuildRight
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :- *(22) Project [ss_item_sk#104, ss_customer_sk#105, ss_cdemo_sk#106, ss_hdemo_sk#107, ss_addr_sk#108, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198]
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :  +- *(22) BroadcastHashJoin [ss_store_sk#109], [s_store_sk#173], Inner, BuildRight
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :- *(22) Project [ss_item_sk#104, ss_customer_sk#105, ss_cdemo_sk#106, ss_hdemo_sk#107, ss_addr_sk#108, ss_store_sk#109, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151]
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- *(22) BroadcastHashJoin [ss_sold_date_sk#102], [d_date_sk#145], Inner, BuildRight
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- *(22) Project [ss_sold_date_sk#102, ss_item_sk#104, ss_customer_sk#105, ss_cdemo_sk#106, ss_hdemo_sk#107, ss_addr_sk#108, ss_store_sk#109, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121]
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- *(22) SortMergeJoin [ss_item_sk#104], [cs_item_sk#46], Inner
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- *(3) Sort [ss_item_sk#104 ASC NULLS FIRST], false, 0
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Exchange hashpartitioning(ss_item_sk#104, 200)
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- *(2) Project [ss_sold_date_sk#102, ss_item_sk#104, ss_customer_sk#105, ss_cdemo_sk#106, ss_hdemo_sk#107, ss_addr_sk#108, ss_store_sk#109, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121]
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- *(2) BroadcastHashJoin [ss_item_sk#104, ss_ticket_number#111], [sr_item_sk#127, sr_ticket_number#134], Inner, BuildRight
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           :- *(2) Project [ss_sold_date_sk#102, ss_item_sk#104, ss_customer_sk#105, ss_cdemo_sk#106, ss_hdemo_sk#107, ss_addr_sk#108, ss_store_sk#109, ss_promo_sk#110, ss_ticket_number#111, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121]
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           :  +- *(2) Filter ((((((((isnotnull(ss_item_sk#104) && isnotnull(ss_ticket_number#111)) && isnotnull(ss_sold_date_sk#102)) && isnotnull(ss_store_sk#109)) && isnotnull(ss_customer_sk#105)) && isnotnull(ss_cdemo_sk#106)) && isnotnull(ss_promo_sk#110)) && isnotnull(ss_hdemo_sk#107)) && isnotnull(ss_addr_sk#108))
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           :     +- *(2) FileScan parquet tpcds.store_sales[ss_sold_date_sk#102,ss_item_sk#104,ss_customer_sk#105,ss_cdemo_sk#106,ss_hdemo_sk#107,ss_addr_sk#108,ss_store_sk#109,ss_promo_sk#110,ss_ticket_number#111,ss_wholesale_cost#113,ss_list_price#114,ss_coupon_amt#121] Batched: true, Format: Parquet, Location: InMemoryFileIndex[file:/Users/angela/Desktop/spark-2.4.8-bin-hadoop2.7/spark-warehouse/tpcds.db/s..., PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_sold_date_sk), IsNotNull(ss_sto..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_a...
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- BroadcastExchange HashedRelationBroadcastMode(List((shiftleft(cast(input[0, int, true] as bigint), 32) | (cast(input[1, int, true] as bigint) & 4294967295))))
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- *(1) Project [sr_item_sk#127, sr_ticket_number#134]
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- *(1) Filter (isnotnull(sr_item_sk#127) && isnotnull(sr_ticket_number#134))
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- *(1) FileScan parquet tpcds.store_returns[sr_item_sk#127,sr_ticket_number#134] Batched: true, Format: Parquet, Location: InMemoryFileIndex[file:/Users/angela/Desktop/spark-2.4.8-bin-hadoop2.7/spark-warehouse/tpcds.db/s..., PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:int>
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- *(6) Sort [cs_item_sk#46 ASC NULLS FIRST], false, 0
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- *(6) Project [cs_item_sk#46]
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- *(6) Filter ((isnotnull(sum(cs_ext_list_price#56)#97) && isnotnull(sum(((cr_refunded_cash#88 + cr_reversed_charge#89) + cr_store_credit#90))#98)) && (sum(cs_ext_list_price#56)#97 > (2.0 * sum(((cr_refunded_cash#88 + cr_reversed_charge#89) + cr_store_credit#90))#98)))
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- *(6) HashAggregate(keys=[cs_item_sk#46], functions=[sum(cs_ext_list_price#56), sum(((cr_refunded_cash#88 + cr_reversed_charge#89) + cr_store_credit#90))], output=[cs_item_sk#46, sum(cs_ext_list_price#56)#97, sum(((cr_refunded_cash#88 + cr_reversed_charge#89) + cr_store_credit#90))#98])
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Exchange hashpartitioning(cs_item_sk#46, 200)
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- *(5) HashAggregate(keys=[cs_item_sk#46], functions=[partial_sum(cs_ext_list_price#56), partial_sum(((cr_refunded_cash#88 + cr_reversed_charge#89) + cr_store_credit#90))], output=[cs_item_sk#46, sum#416, sum#417])
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- *(5) Project [cs_item_sk#46, cs_ext_list_price#56, cr_refunded_cash#88, cr_reversed_charge#89, cr_store_credit#90]
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- *(5) BroadcastHashJoin [cs_item_sk#46, cs_order_number#48], [cr_item_sk#67, cr_order_number#81], Inner, BuildRight
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             :- *(5) Project [cs_item_sk#46, cs_order_number#48, cs_ext_list_price#56]
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             :  +- *(5) Filter (isnotnull(cs_item_sk#46) && isnotnull(cs_order_number#48))
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             :     +- *(5) FileScan parquet tpcds.catalog_sales[cs_item_sk#46,cs_order_number#48,cs_ext_list_price#56] Batched: true, Format: Parquet, Location: InMemoryFileIndex[file:/Users/angela/Desktop/spark-2.4.8-bin-hadoop2.7/spark-warehouse/tpcds.db/c..., PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:int,cs_ext_list_price:double>
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             +- BroadcastExchange HashedRelationBroadcastMode(List((shiftleft(cast(input[0, int, true] as bigint), 32) | (cast(input[1, int, true] as bigint) & 4294967295))))
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                +- *(4) Project [cr_item_sk#67, cr_order_number#81, cr_refunded_cash#88, cr_reversed_charge#89, cr_store_credit#90]
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                   +- *(4) Filter (isnotnull(cr_item_sk#67) && isnotnull(cr_order_number#81))
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                      +- *(4) FileScan parquet tpcds.catalog_returns[cr_item_sk#67,cr_order_number#81,cr_refunded_cash#88,cr_reversed_charge#89,cr_store_credit#90] Batched: true, Format: Parquet, Location: InMemoryFileIndex[file:/Users/angela/Desktop/spark-2.4.8-bin-hadoop2.7/spark-warehouse/tpcds.db/c..., PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:int,cr_refunded_cash:double,cr_reversed_charge:double,cr_st...
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- *(7) Project [d_date_sk#145, d_year#151]
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- *(7) Filter ((isnotnull(d_year#151) && (d_year#151 = 1999)) && isnotnull(d_date_sk#145))
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- *(7) FileScan parquet tpcds.date_dim[d_date_sk#145,d_year#151] Batched: true, Format: Parquet, Location: InMemoryFileIndex[file:/Users/angela/Desktop/spark-2.4.8-bin-hadoop2.7/spark-warehouse/tpcds.db/d..., PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,1999), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :        +- *(8) Project [s_store_sk#173, s_store_name#178, s_zip#198]
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :           +- *(8) Filter ((isnotnull(s_store_sk#173) && isnotnull(s_zip#198)) && isnotnull(s_store_name#178))
         :                    :     :     :     :     :     :     :     :     :     :     :     :     :              +- *(8) FileScan parquet tpcds.store[s_store_sk#173,s_store_name#178,s_zip#198] Batched: true, Format: Parquet, Location: InMemoryFileIndex[file:/Users/angela/Desktop/spark-2.4.8-bin-hadoop2.7/spark-warehouse/tpcds.db/s..., PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_zip), IsNotNull(s_store_name)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
         :                    :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
         :                    :     :     :     :     :     :     :     :     :     :     :     :        +- *(9) Project [c_customer_sk#202, c_current_cdemo_sk#204, c_current_hdemo_sk#205, c_current_addr_sk#206, c_first_shipto_date_sk#207, c_first_sales_date_sk#208]
         :                    :     :     :     :     :     :     :     :     :     :     :     :           +- *(9) Filter (((((isnotnull(c_customer_sk#202) && isnotnull(c_first_sales_date_sk#208)) && isnotnull(c_first_shipto_date_sk#207)) && isnotnull(c_current_cdemo_sk#204)) && isnotnull(c_current_hdemo_sk#205)) && isnotnull(c_current_addr_sk#206))
         :                    :     :     :     :     :     :     :     :     :     :     :     :              +- *(9) FileScan parquet tpcds.customer[c_customer_sk#202,c_current_cdemo_sk#204,c_current_hdemo_sk#205,c_current_addr_sk#206,c_first_shipto_date_sk#207,c_first_sales_date_sk#208] Batched: true, Format: Parquet, Location: InMemoryFileIndex[file:/Users/angela/Desktop/spark-2.4.8-bin-hadoop2.7/spark-warehouse/tpcds.db/c..., PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
         :                    :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
         :                    :     :     :     :     :     :     :     :     :     :     :        +- *(10) Project [d_date_sk#291, d_year#297]
         :                    :     :     :     :     :     :     :     :     :     :     :           +- *(10) Filter isnotnull(d_date_sk#291)
         :                    :     :     :     :     :     :     :     :     :     :     :              +- *(10) FileScan parquet tpcds.date_dim[d_date_sk#291,d_year#297] Batched: true, Format: Parquet, Location: InMemoryFileIndex[file:/Users/angela/Desktop/spark-2.4.8-bin-hadoop2.7/spark-warehouse/tpcds.db/d..., PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
         :                    :     :     :     :     :     :     :     :     :     :     +- ReusedExchange [d_date_sk#319, d_year#325], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
         :                    :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
         :                    :     :     :     :     :     :     :     :     :        +- *(12) Project [cd_demo_sk#220, cd_marital_status#222]
         :                    :     :     :     :     :     :     :     :     :           +- *(12) Filter (isnotnull(cd_demo_sk#220) && isnotnull(cd_marital_status#222))
         :                    :     :     :     :     :     :     :     :     :              +- *(12) FileScan parquet tpcds.customer_demographics[cd_demo_sk#220,cd_marital_status#222] Batched: true, Format: Parquet, Location: InMemoryFileIndex[file:/Users/angela/Desktop/spark-2.4.8-bin-hadoop2.7/spark-warehouse/tpcds.db/c..., PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
         :                    :     :     :     :     :     :     :     :     +- ReusedExchange [cd_demo_sk#347, cd_marital_status#349], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
         :                    :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
         :                    :     :     :     :     :     :     :        +- *(14) Project [p_promo_sk#229]
         :                    :     :     :     :     :     :     :           +- *(14) Filter isnotnull(p_promo_sk#229)
         :                    :     :     :     :     :     :     :              +- *(14) FileScan parquet tpcds.promotion[p_promo_sk#229] Batched: true, Format: Parquet, Location: InMemoryFileIndex[file:/Users/angela/Desktop/spark-2.4.8-bin-hadoop2.7/spark-warehouse/tpcds.db/p..., PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
         :                    :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
         :                    :     :     :     :     :     :        +- *(15) Project [hd_demo_sk#248, hd_income_band_sk#249]
         :                    :     :     :     :     :     :           +- *(15) Filter (isnotnull(hd_demo_sk#248) && isnotnull(hd_income_band_sk#249))
         :                    :     :     :     :     :     :              +- *(15) FileScan parquet tpcds.household_demographics[hd_demo_sk#248,hd_income_band_sk#249] Batched: true, Format: Parquet, Location: InMemoryFileIndex[file:/Users/angela/Desktop/spark-2.4.8-bin-hadoop2.7/spark-warehouse/tpcds.db/h..., PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
         :                    :     :     :     :     :     +- ReusedExchange [hd_demo_sk#356, hd_income_band_sk#357], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
         :                    :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
         :                    :     :     :     :        +- *(17) Project [ca_address_sk#253, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262]
         :                    :     :     :     :           +- *(17) Filter isnotnull(ca_address_sk#253)
         :                    :     :     :     :              +- *(17) FileScan parquet tpcds.customer_address[ca_address_sk#253,ca_street_number#255,ca_street_name#256,ca_city#259,ca_zip#262] Batched: true, Format: Parquet, Location: InMemoryFileIndex[file:/Users/angela/Desktop/spark-2.4.8-bin-hadoop2.7/spark-warehouse/tpcds.db/c..., PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
         :                    :     :     :     +- ReusedExchange [ca_address_sk#361, ca_street_number#363, ca_street_name#364, ca_city#367, ca_zip#370], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
         :                    :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
         :                    :     :        +- *(19) Project [ib_income_band_sk#266]
         :                    :     :           +- *(19) Filter isnotnull(ib_income_band_sk#266)
         :                    :     :              +- *(19) FileScan parquet tpcds.income_band[ib_income_band_sk#266] Batched: true, Format: Parquet, Location: InMemoryFileIndex[file:/Users/angela/Desktop/spark-2.4.8-bin-hadoop2.7/spark-warehouse/tpcds.db/i..., PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
         :                    :     +- ReusedExchange [ib_income_band_sk#374], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
         :                    +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
         :                       +- *(21) Project [i_item_sk#269, i_product_name#290]
         :                          +- *(21) Filter ((((((isnotnull(i_current_price#274) && i_color#286 IN (purple,burlywood,indian,spring,floral,medium)) && (i_current_price#274 >= 64.0)) && (i_current_price#274 <= 74.0)) && (i_current_price#274 >= 65.0)) && (i_current_price#274 <= 79.0)) && isnotnull(i_item_sk#269))
         :                             +- *(21) FileScan parquet tpcds.item[i_item_sk#269,i_current_price#274,i_color#286,i_product_name#290] Batched: true, Format: Parquet, Location: InMemoryFileIndex[file:/Users/angela/Desktop/spark-2.4.8-bin-hadoop2.7/spark-warehouse/tpcds.db/i..., PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [purple,burlywood,indian,spring,floral,medium]), Greater..., ReadSchema: struct<i_item_sk:int,i_current_price:double,i_color:string,i_product_name:string>
         +- *(48) Sort [item_sk#384 ASC NULLS FIRST, store_name#385 ASC NULLS FIRST, store_zip#386 ASC NULLS FIRST], false, 0
            +- Exchange hashpartitioning(item_sk#384, store_name#385, store_zip#386, 200)
               +- *(47) HashAggregate(keys=[i_product_name#290, i_item_sk#269, s_store_name#178, s_zip#198, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262, ca_street_number#363, ca_street_name#364, ca_city#367, ca_zip#370, d_year#151, d_year#297, d_year#325], functions=[count(1), sum(ss_wholesale_cost#113), sum(ss_list_price#114), sum(ss_coupon_amt#121)], output=[item_sk#384, store_name#385, store_zip#386, syear#395, cnt#398L, s1#399, s2#400, s3#401])
                  +- Exchange hashpartitioning(i_product_name#290, i_item_sk#269, s_store_name#178, s_zip#198, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262, ca_street_number#363, ca_street_name#364, ca_city#367, ca_zip#370, d_year#151, d_year#297, d_year#325, 200)
                     +- *(46) HashAggregate(keys=[i_product_name#290, i_item_sk#269, s_store_name#178, s_zip#198, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262, ca_street_number#363, ca_street_name#364, ca_city#367, ca_zip#370, d_year#151, d_year#297, d_year#325], functions=[partial_count(1), partial_sum(ss_wholesale_cost#113), partial_sum(ss_list_price#114), partial_sum(ss_coupon_amt#121)], output=[i_product_name#290, i_item_sk#269, s_store_name#178, s_zip#198, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262, ca_street_number#363, ca_street_name#364, ca_city#367, ca_zip#370, d_year#151, d_year#297, d_year#325, count#410L, sum#411, sum#412, sum#413])
                        +- *(46) Project [ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, d_year#297, d_year#325, s_store_name#178, s_zip#198, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262, ca_street_number#363, ca_street_name#364, ca_city#367, ca_zip#370, i_item_sk#269, i_product_name#290]
                           +- *(46) BroadcastHashJoin [ss_item_sk#104], [i_item_sk#269], Inner, BuildRight
                              :- *(46) Project [ss_item_sk#104, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, d_year#297, d_year#325, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262, ca_street_number#363, ca_street_name#364, ca_city#367, ca_zip#370]
                              :  +- *(46) BroadcastHashJoin [hd_income_band_sk#357], [ib_income_band_sk#374], Inner, BuildRight
                              :     :- *(46) Project [ss_item_sk#104, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, d_year#297, d_year#325, hd_income_band_sk#357, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262, ca_street_number#363, ca_street_name#364, ca_city#367, ca_zip#370]
                              :     :  +- *(46) BroadcastHashJoin [hd_income_band_sk#249], [ib_income_band_sk#266], Inner, BuildRight
                              :     :     :- *(46) Project [ss_item_sk#104, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, d_year#297, d_year#325, hd_income_band_sk#249, hd_income_band_sk#357, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262, ca_street_number#363, ca_street_name#364, ca_city#367, ca_zip#370]
                              :     :     :  +- *(46) BroadcastHashJoin [c_current_addr_sk#206], [ca_address_sk#361], Inner, BuildRight
                              :     :     :     :- *(46) Project [ss_item_sk#104, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_addr_sk#206, d_year#297, d_year#325, hd_income_band_sk#249, hd_income_band_sk#357, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262]
                              :     :     :     :  +- *(46) BroadcastHashJoin [ss_addr_sk#108], [ca_address_sk#253], Inner, BuildRight
                              :     :     :     :     :- *(46) Project [ss_item_sk#104, ss_addr_sk#108, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_addr_sk#206, d_year#297, d_year#325, hd_income_band_sk#249, hd_income_band_sk#357]
                              :     :     :     :     :  +- *(46) BroadcastHashJoin [c_current_hdemo_sk#205], [hd_demo_sk#356], Inner, BuildRight
                              :     :     :     :     :     :- *(46) Project [ss_item_sk#104, ss_addr_sk#108, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_hdemo_sk#205, c_current_addr_sk#206, d_year#297, d_year#325, hd_income_band_sk#249]
                              :     :     :     :     :     :  +- *(46) BroadcastHashJoin [ss_hdemo_sk#107], [hd_demo_sk#248], Inner, BuildRight
                              :     :     :     :     :     :     :- *(46) Project [ss_item_sk#104, ss_hdemo_sk#107, ss_addr_sk#108, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_hdemo_sk#205, c_current_addr_sk#206, d_year#297, d_year#325]
                              :     :     :     :     :     :     :  +- *(46) BroadcastHashJoin [ss_promo_sk#110], [p_promo_sk#229], Inner, BuildRight
                              :     :     :     :     :     :     :     :- *(46) Project [ss_item_sk#104, ss_hdemo_sk#107, ss_addr_sk#108, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_hdemo_sk#205, c_current_addr_sk#206, d_year#297, d_year#325]
                              :     :     :     :     :     :     :     :  +- *(46) BroadcastHashJoin [c_current_cdemo_sk#204], [cd_demo_sk#347], Inner, BuildRight, NOT (cd_marital_status#222 = cd_marital_status#349)
                              :     :     :     :     :     :     :     :     :- *(46) Project [ss_item_sk#104, ss_hdemo_sk#107, ss_addr_sk#108, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_cdemo_sk#204, c_current_hdemo_sk#205, c_current_addr_sk#206, d_year#297, d_year#325, cd_marital_status#222]
                              :     :     :     :     :     :     :     :     :  +- *(46) BroadcastHashJoin [ss_cdemo_sk#106], [cd_demo_sk#220], Inner, BuildRight
                              :     :     :     :     :     :     :     :     :     :- *(46) Project [ss_item_sk#104, ss_cdemo_sk#106, ss_hdemo_sk#107, ss_addr_sk#108, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_cdemo_sk#204, c_current_hdemo_sk#205, c_current_addr_sk#206, d_year#297, d_year#325]
                              :     :     :     :     :     :     :     :     :     :  +- *(46) BroadcastHashJoin [c_first_shipto_date_sk#207], [d_date_sk#319], Inner, BuildRight
                              :     :     :     :     :     :     :     :     :     :     :- *(46) Project [ss_item_sk#104, ss_cdemo_sk#106, ss_hdemo_sk#107, ss_addr_sk#108, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_cdemo_sk#204, c_current_hdemo_sk#205, c_current_addr_sk#206, c_first_shipto_date_sk#207, d_year#297]
                              :     :     :     :     :     :     :     :     :     :     :  +- *(46) BroadcastHashJoin [c_first_sales_date_sk#208], [d_date_sk#291], Inner, BuildRight
                              :     :     :     :     :     :     :     :     :     :     :     :- *(46) Project [ss_item_sk#104, ss_cdemo_sk#106, ss_hdemo_sk#107, ss_addr_sk#108, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198, c_current_cdemo_sk#204, c_current_hdemo_sk#205, c_current_addr_sk#206, c_first_shipto_date_sk#207, c_first_sales_date_sk#208]
                              :     :     :     :     :     :     :     :     :     :     :     :  +- *(46) BroadcastHashJoin [ss_customer_sk#105], [c_customer_sk#202], Inner, BuildRight
                              :     :     :     :     :     :     :     :     :     :     :     :     :- *(46) Project [ss_item_sk#104, ss_customer_sk#105, ss_cdemo_sk#106, ss_hdemo_sk#107, ss_addr_sk#108, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151, s_store_name#178, s_zip#198]
                              :     :     :     :     :     :     :     :     :     :     :     :     :  +- *(46) BroadcastHashJoin [ss_store_sk#109], [s_store_sk#173], Inner, BuildRight
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :- *(46) Project [ss_item_sk#104, ss_customer_sk#105, ss_cdemo_sk#106, ss_hdemo_sk#107, ss_addr_sk#108, ss_store_sk#109, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121, d_year#151]
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- *(46) BroadcastHashJoin [ss_sold_date_sk#102], [d_date_sk#145], Inner, BuildRight
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- *(46) Project [ss_sold_date_sk#102, ss_item_sk#104, ss_customer_sk#105, ss_cdemo_sk#106, ss_hdemo_sk#107, ss_addr_sk#108, ss_store_sk#109, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121]
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- *(46) SortMergeJoin [ss_item_sk#104], [cs_item_sk#46], Inner
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- *(27) Sort [ss_item_sk#104 ASC NULLS FIRST], false, 0
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- ReusedExchange [ss_sold_date_sk#102, ss_item_sk#104, ss_customer_sk#105, ss_cdemo_sk#106, ss_hdemo_sk#107, ss_addr_sk#108, ss_store_sk#109, ss_promo_sk#110, ss_wholesale_cost#113, ss_list_price#114, ss_coupon_amt#121], Exchange hashpartitioning(ss_item_sk#104, 200)
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- *(30) Sort [cs_item_sk#46 ASC NULLS FIRST], false, 0
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- *(30) Project [cs_item_sk#46]
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- *(30) Filter ((isnotnull(sum(cs_ext_list_price#56)#97) && isnotnull(sum(((cr_refunded_cash#88 + cr_reversed_charge#89) + cr_store_credit#90))#98)) && (sum(cs_ext_list_price#56)#97 > (2.0 * sum(((cr_refunded_cash#88 + cr_reversed_charge#89) + cr_store_credit#90))#98)))
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- *(30) HashAggregate(keys=[cs_item_sk#46], functions=[sum(cs_ext_list_price#56), sum(((cr_refunded_cash#88 + cr_reversed_charge#89) + cr_store_credit#90))], output=[cs_item_sk#46, sum(cs_ext_list_price#56)#97, sum(((cr_refunded_cash#88 + cr_reversed_charge#89) + cr_store_credit#90))#98])
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- ReusedExchange [cs_item_sk#46, sum#416, sum#417], Exchange hashpartitioning(cs_item_sk#46, 200)
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- *(31) Project [d_date_sk#145, d_year#151]
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- *(31) Filter ((isnotnull(d_year#151) && (d_year#151 = 2000)) && isnotnull(d_date_sk#145))
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- *(31) FileScan parquet tpcds.date_dim[d_date_sk#145,d_year#151] Batched: true, Format: Parquet, Location: InMemoryFileIndex[file:/Users/angela/Desktop/spark-2.4.8-bin-hadoop2.7/spark-warehouse/tpcds.db/d..., PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2000), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                              :     :     :     :     :     :     :     :     :     :     :     :     :     +- ReusedExchange [s_store_sk#173, s_store_name#178, s_zip#198], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
                              :     :     :     :     :     :     :     :     :     :     :     :     +- ReusedExchange [c_customer_sk#202, c_current_cdemo_sk#204, c_current_hdemo_sk#205, c_current_addr_sk#206, c_first_shipto_date_sk#207, c_first_sales_date_sk#208], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
                              :     :     :     :     :     :     :     :     :     :     :     +- ReusedExchange [d_date_sk#291, d_year#297], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
                              :     :     :     :     :     :     :     :     :     :     +- ReusedExchange [d_date_sk#319, d_year#325], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
                              :     :     :     :     :     :     :     :     :     +- ReusedExchange [cd_demo_sk#220, cd_marital_status#222], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
                              :     :     :     :     :     :     :     :     +- ReusedExchange [cd_demo_sk#347, cd_marital_status#349], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
                              :     :     :     :     :     :     :     +- ReusedExchange [p_promo_sk#229], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
                              :     :     :     :     :     :     +- ReusedExchange [hd_demo_sk#248, hd_income_band_sk#249], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
                              :     :     :     :     :     +- ReusedExchange [hd_demo_sk#356, hd_income_band_sk#357], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
                              :     :     :     :     +- ReusedExchange [ca_address_sk#253, ca_street_number#255, ca_street_name#256, ca_city#259, ca_zip#262], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
                              :     :     :     +- ReusedExchange [ca_address_sk#361, ca_street_number#363, ca_street_name#364, ca_city#367, ca_zip#370], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
                              :     :     +- ReusedExchange [ib_income_band_sk#266], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
                              :     +- ReusedExchange [ib_income_band_sk#374], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
                              +- ReusedExchange [i_item_sk#269, i_product_name#290], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
Time taken: 9.144 seconds, Fetched 1 row(s)
Error in query: 
mismatched input '<EOF>' expecting {'(', 'SELECT', 'FROM', 'ADD', 'DESC', 'WITH', 'VALUES', 'CREATE', 'TABLE', 'INSERT', 'DELETE', 'DESCRIBE', 'EXPLAIN', 'SHOW', 'USE', 'DROP', 'ALTER', 'MAP', 'SET', 'RESET', 'START', 'COMMIT', 'ROLLBACK', 'REDUCE', 'REFRESH', 'CLEAR', 'CACHE', 'UNCACHE', 'DFS', 'TRUNCATE', 'ANALYZE', 'LIST', 'REVOKE', 'GRANT', 'LOCK', 'UNLOCK', 'MSCK', 'EXPORT', 'IMPORT', 'LOAD'}(line 2, pos 54)

== SQL ==

-- end query 64 in stream 0 using template query64.tpl
------------------------------------------------------^^^

