Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
Spark Web UI available at http://mac.lan:4040
Spark master: local[*], Application Id: local-1741582004092
== Parsed Logical Plan ==
CTE [cs_ui, cross_sales]
:  :- 'SubqueryAlias cs_ui
:  :  +- 'UnresolvedHaving ('sum('cs_ext_list_price) > (2 * 'sum((('cr_refunded_cash + 'cr_reversed_charge) + 'cr_store_credit))))
:  :     +- 'Aggregate ['cs_item_sk], ['cs_item_sk, 'sum('cs_ext_list_price) AS sale#8, 'sum((('cr_refunded_cash + 'cr_reversed_charge) + 'cr_store_credit)) AS refund#9]
:  :        +- 'Filter (('cs_item_sk = 'cr_item_sk) AND ('cs_order_number = 'cr_order_number))
:  :           +- 'Join Inner
:  :              :- 'UnresolvedRelation [catalog_sales], [], false
:  :              +- 'UnresolvedRelation [catalog_returns], [], false
:  +- 'SubqueryAlias cross_sales
:     +- 'Aggregate ['i_product_name, 'i_item_sk, 's_store_name, 's_zip, 'ad1.ca_street_number, 'ad1.ca_street_name, 'ad1.ca_city, 'ad1.ca_zip, 'ad2.ca_street_number, 'ad2.ca_street_name, 'ad2.ca_city, 'ad2.ca_zip, 'd1.d_year, 'd2.d_year, 'd3.d_year], ['i_product_name AS product_name#10, 'i_item_sk AS item_sk#11, 's_store_name AS store_name#12, 's_zip AS store_zip#13, 'ad1.ca_street_number AS b_street_number#14, 'ad1.ca_street_name AS b_street_name#15, 'ad1.ca_city AS b_city#16, 'ad1.ca_zip AS b_zip#17, 'ad2.ca_street_number AS c_street_number#18, 'ad2.ca_street_name AS c_street_name#19, 'ad2.ca_city AS c_city#20, 'ad2.ca_zip AS c_zip#21, 'd1.d_year AS syear#22, 'd2.d_year AS fsyear#23, 'd3.d_year AS s2year#24, 'count(1) AS cnt#25, 'sum('ss_wholesale_cost) AS s1#26, 'sum('ss_list_price) AS s2#27, 'sum('ss_coupon_amt) AS s3#28]
:        +- 'Filter (((((('ss_store_sk = 's_store_sk) AND ('ss_sold_date_sk = 'd1.d_date_sk)) AND ('ss_customer_sk = 'c_customer_sk)) AND ((('ss_cdemo_sk = 'cd1.cd_demo_sk) AND ('ss_hdemo_sk = 'hd1.hd_demo_sk)) AND ('ss_addr_sk = 'ad1.ca_address_sk))) AND (((('ss_item_sk = 'i_item_sk) AND ('ss_item_sk = 'sr_item_sk)) AND ('ss_ticket_number = 'sr_ticket_number)) AND (('ss_item_sk = 'cs_ui.cs_item_sk) AND ('c_current_cdemo_sk = 'cd2.cd_demo_sk)))) AND ((((('c_current_hdemo_sk = 'hd2.hd_demo_sk) AND ('c_current_addr_sk = 'ad2.ca_address_sk)) AND ('c_first_sales_date_sk = 'd2.d_date_sk)) AND ((('c_first_shipto_date_sk = 'd3.d_date_sk) AND ('ss_promo_sk = 'p_promo_sk)) AND ('hd1.hd_income_band_sk = 'ib1.ib_income_band_sk))) AND (((('hd2.hd_income_band_sk = 'ib2.ib_income_band_sk) AND NOT ('cd1.cd_marital_status = 'cd2.cd_marital_status)) AND 'i_color IN (purple,burlywood,indian,spring,floral,medium)) AND ((('i_current_price >= 64) AND ('i_current_price <= (64 + 10))) AND (('i_current_price >= (64 + 1)) AND ('i_current_price <= (64 + 15)))))))
:           +- 'Join Inner
:              :- 'Join Inner
:              :  :- 'Join Inner
:              :  :  :- 'Join Inner
:              :  :  :  :- 'Join Inner
:              :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- 'UnresolvedRelation [store_sales], [], false
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- 'UnresolvedRelation [store_returns], [], false
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- 'UnresolvedRelation [cs_ui], [], false
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- 'SubqueryAlias d1
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- 'UnresolvedRelation [date_dim], [], false
:              :  :  :  :  :  :  :  :  :  :  :  :  :  +- 'SubqueryAlias d2
:              :  :  :  :  :  :  :  :  :  :  :  :  :     +- 'UnresolvedRelation [date_dim], [], false
:              :  :  :  :  :  :  :  :  :  :  :  :  +- 'SubqueryAlias d3
:              :  :  :  :  :  :  :  :  :  :  :  :     +- 'UnresolvedRelation [date_dim], [], false
:              :  :  :  :  :  :  :  :  :  :  :  +- 'UnresolvedRelation [store], [], false
:              :  :  :  :  :  :  :  :  :  :  +- 'UnresolvedRelation [customer], [], false
:              :  :  :  :  :  :  :  :  :  +- 'SubqueryAlias cd1
:              :  :  :  :  :  :  :  :  :     +- 'UnresolvedRelation [customer_demographics], [], false
:              :  :  :  :  :  :  :  :  +- 'SubqueryAlias cd2
:              :  :  :  :  :  :  :  :     +- 'UnresolvedRelation [customer_demographics], [], false
:              :  :  :  :  :  :  :  +- 'UnresolvedRelation [promotion], [], false
:              :  :  :  :  :  :  +- 'SubqueryAlias hd1
:              :  :  :  :  :  :     +- 'UnresolvedRelation [household_demographics], [], false
:              :  :  :  :  :  +- 'SubqueryAlias hd2
:              :  :  :  :  :     +- 'UnresolvedRelation [household_demographics], [], false
:              :  :  :  :  +- 'SubqueryAlias ad1
:              :  :  :  :     +- 'UnresolvedRelation [customer_address], [], false
:              :  :  :  +- 'SubqueryAlias ad2
:              :  :  :     +- 'UnresolvedRelation [customer_address], [], false
:              :  :  +- 'SubqueryAlias ib1
:              :  :     +- 'UnresolvedRelation [income_band], [], false
:              :  +- 'SubqueryAlias ib2
:              :     +- 'UnresolvedRelation [income_band], [], false
:              +- 'UnresolvedRelation [item], [], false
+- 'Sort ['cs1.product_name ASC NULLS FIRST, 'cs1.store_name ASC NULLS FIRST, 'cnt_2 ASC NULLS FIRST], true
   +- 'Project ['cs1.product_name, 'cs1.store_name, 'cs1.store_zip, 'cs1.b_street_number, 'cs1.b_street_name, 'cs1.b_city, 'cs1.b_zip, 'cs1.c_street_number, 'cs1.c_street_name, 'cs1.c_city, 'cs1.c_zip, 'cs1.syear, 'cs1.cnt, 'cs1.s1 AS s11#0, 'cs1.s2 AS s21#1, 'cs1.s3 AS s31#2, 'cs2.s1 AS s12#3, 'cs2.s2 AS s22#4, 'cs2.s3 AS s32#5, 'cs2.syear AS syear_2#6, 'cs2.cnt AS cnt_2#7]
      +- 'Filter (((('cs1.item_sk = 'cs2.item_sk) AND ('cs1.syear = 1999)) AND ('cs2.syear = (1999 + 1))) AND ((('cs2.cnt <= 'cs1.cnt) AND ('cs1.store_name = 'cs2.store_name)) AND ('cs1.store_zip = 'cs2.store_zip)))
         +- 'Join Inner
            :- 'SubqueryAlias cs1
            :  +- 'UnresolvedRelation [cross_sales], [], false
            +- 'SubqueryAlias cs2
               +- 'UnresolvedRelation [cross_sales], [], false

== Analyzed Logical Plan ==
product_name: string, store_name: string, store_zip: string, b_street_number: string, b_street_name: string, b_city: string, b_zip: string, c_street_number: string, c_street_name: string, c_city: string, c_zip: string, syear: int, cnt: bigint, s11: double, s21: double, s31: double, s12: double, s22: double, s32: double, syear_2: int, cnt_2: bigint
WithCTE
:- CTERelationDef 0, false
:  +- SubqueryAlias cs_ui
:     +- Filter (sale#8 > (cast(2 as double) * refund#9))
:        +- Aggregate [cs_item_sk#50], [cs_item_sk#50, sum(cs_ext_list_price#60) AS sale#8, sum(((cr_refunded_cash#92 + cr_reversed_charge#93) + cr_store_credit#94)) AS refund#9]
:           +- Filter ((cs_item_sk#50 = cr_item_sk#71) AND (cs_order_number#52 = cr_order_number#85))
:              +- Join Inner
:                 :- SubqueryAlias spark_catalog.tpcds.catalog_sales
:                 :  +- Relation spark_catalog.tpcds.catalog_sales[cs_sold_date_sk#35,cs_sold_time_sk#36,cs_ship_date_sk#37,cs_bill_customer_sk#38,cs_bill_cdemo_sk#39,cs_bill_hdemo_sk#40,cs_bill_addr_sk#41,cs_ship_customer_sk#42,cs_ship_cdemo_sk#43,cs_ship_hdemo_sk#44,cs_ship_addr_sk#45,cs_call_center_sk#46,cs_catalog_page_sk#47,cs_ship_mode_sk#48,cs_warehouse_sk#49,cs_item_sk#50,cs_promo_sk#51,cs_order_number#52,cs_quantity#53,cs_wholesale_cost#54,cs_list_price#55,cs_sales_price#56,cs_ext_discount_amt#57,cs_ext_sales_price#58,... 10 more fields] parquet
:                 +- SubqueryAlias spark_catalog.tpcds.catalog_returns
:                    +- Relation spark_catalog.tpcds.catalog_returns[cr_returned_date_sk#69,cr_returned_time_sk#70,cr_item_sk#71,cr_refunded_customer_sk#72,cr_refunded_cdemo_sk#73,cr_refunded_hdemo_sk#74,cr_refunded_addr_sk#75,cr_returning_customer_sk#76,cr_returning_cdemo_sk#77,cr_returning_hdemo_sk#78,cr_returning_addr_sk#79,cr_call_center_sk#80,cr_catalog_page_sk#81,cr_ship_mode_sk#82,cr_warehouse_sk#83,cr_reason_sk#84,cr_order_number#85,cr_return_quantity#86,cr_return_amount#87,cr_return_tax#88,cr_return_amt_inc_tax#89,cr_fee#90,cr_return_ship_cost#91,cr_refunded_cash#92,... 3 more fields] parquet
:- CTERelationDef 1, false
:  +- SubqueryAlias cross_sales
:     +- Aggregate [i_product_name#284, i_item_sk#263, s_store_name#172, s_zip#192, ca_street_number#249, ca_street_name#250, ca_city#253, ca_zip#256, ca_street_number#357, ca_street_name#358, ca_city#361, ca_zip#364, d_year#145, d_year#291, d_year#319], [i_product_name#284 AS product_name#10, i_item_sk#263 AS item_sk#11, s_store_name#172 AS store_name#12, s_zip#192 AS store_zip#13, ca_street_number#249 AS b_street_number#14, ca_street_name#250 AS b_street_name#15, ca_city#253 AS b_city#16, ca_zip#256 AS b_zip#17, ca_street_number#357 AS c_street_number#18, ca_street_name#358 AS c_street_name#19, ca_city#361 AS c_city#20, ca_zip#364 AS c_zip#21, d_year#145 AS syear#22, d_year#291 AS fsyear#23, d_year#319 AS s2year#24, count(1) AS cnt#25L, sum(ss_wholesale_cost#107) AS s1#26, sum(ss_list_price#108) AS s2#27, sum(ss_coupon_amt#115) AS s3#28]
:        +- Filter ((((((ss_store_sk#103 = s_store_sk#167) AND (ss_sold_date_sk#96 = d_date_sk#139)) AND (ss_customer_sk#99 = c_customer_sk#196)) AND (((ss_cdemo_sk#100 = cd_demo_sk#214) AND (ss_hdemo_sk#101 = hd_demo_sk#242)) AND (ss_addr_sk#102 = ca_address_sk#247))) AND ((((ss_item_sk#98 = i_item_sk#263) AND (ss_item_sk#98 = sr_item_sk#121)) AND (ss_ticket_number#105 = sr_ticket_number#128)) AND ((ss_item_sk#98 = cs_item_sk#50) AND (c_current_cdemo_sk#198 = cd_demo_sk#341)))) AND (((((c_current_hdemo_sk#199 = hd_demo_sk#350) AND (c_current_addr_sk#200 = ca_address_sk#355)) AND (c_first_sales_date_sk#202 = d_date_sk#285)) AND (((c_first_shipto_date_sk#201 = d_date_sk#313) AND (ss_promo_sk#104 = p_promo_sk#223)) AND (hd_income_band_sk#243 = ib_income_band_sk#260))) AND ((((hd_income_band_sk#351 = ib_income_band_sk#368) AND NOT (cd_marital_status#216 = cd_marital_status#343)) AND i_color#280 IN (purple,burlywood,indian,spring,floral,medium)) AND (((i_current_price#268 >= cast(64 as double)) AND (i_current_price#268 <= cast((64 + 10) as double))) AND ((i_current_price#268 >= cast((64 + 1) as double)) AND (i_current_price#268 <= cast((64 + 15) as double)))))))
:           +- Join Inner
:              :- Join Inner
:              :  :- Join Inner
:              :  :  :- Join Inner
:              :  :  :  :- Join Inner
:              :  :  :  :  :- Join Inner
:              :  :  :  :  :  :- Join Inner
:              :  :  :  :  :  :  :- Join Inner
:              :  :  :  :  :  :  :  :- Join Inner
:              :  :  :  :  :  :  :  :  :- Join Inner
:              :  :  :  :  :  :  :  :  :  :- Join Inner
:              :  :  :  :  :  :  :  :  :  :  :- Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias spark_catalog.tpcds.store_sales
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation spark_catalog.tpcds.store_sales[ss_sold_date_sk#96,ss_sold_time_sk#97,ss_item_sk#98,ss_customer_sk#99,ss_cdemo_sk#100,ss_hdemo_sk#101,ss_addr_sk#102,ss_store_sk#103,ss_promo_sk#104,ss_ticket_number#105,ss_quantity#106,ss_wholesale_cost#107,ss_list_price#108,ss_sales_price#109,ss_ext_discount_amt#110,ss_ext_sales_price#111,ss_ext_wholesale_cost#112,ss_ext_list_price#113,ss_ext_tax#114,ss_coupon_amt#115,ss_net_paid#116,ss_net_paid_inc_tax#117,ss_net_profit#118] parquet
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias spark_catalog.tpcds.store_returns
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation spark_catalog.tpcds.store_returns[sr_returned_date_sk#119,sr_return_time_sk#120,sr_item_sk#121,sr_customer_sk#122,sr_cdemo_sk#123,sr_hdemo_sk#124,sr_addr_sk#125,sr_store_sk#126,sr_reason_sk#127,sr_ticket_number#128,sr_return_quantity#129,sr_return_amt#130,sr_return_tax#131,sr_return_amt_inc_tax#132,sr_fee#133,sr_return_ship_cost#134,sr_refunded_cash#135,sr_reversed_charge#136,sr_store_credit#137,sr_net_loss#138] parquet
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias cs_ui
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- CTERelationRef 0, true, [cs_item_sk#50, sale#8, refund#9], false
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d1
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias spark_catalog.tpcds.date_dim
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation spark_catalog.tpcds.date_dim[d_date_sk#139,d_date_id#140,d_date#141,d_month_seq#142,d_week_seq#143,d_quarter_seq#144,d_year#145,d_dow#146,d_moy#147,d_dom#148,d_qoy#149,d_fy_year#150,d_fy_quarter_seq#151,d_fy_week_seq#152,d_day_name#153,d_quarter_name#154,d_holiday#155,d_weekend#156,d_following_holiday#157,d_first_dom#158,d_last_dom#159,d_same_day_ly#160,d_same_day_lq#161,d_current_day#162,... 4 more fields] parquet
:              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d2
:              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias spark_catalog.tpcds.date_dim
:              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation spark_catalog.tpcds.date_dim[d_date_sk#285,d_date_id#286,d_date#287,d_month_seq#288,d_week_seq#289,d_quarter_seq#290,d_year#291,d_dow#292,d_moy#293,d_dom#294,d_qoy#295,d_fy_year#296,d_fy_quarter_seq#297,d_fy_week_seq#298,d_day_name#299,d_quarter_name#300,d_holiday#301,d_weekend#302,d_following_holiday#303,d_first_dom#304,d_last_dom#305,d_same_day_ly#306,d_same_day_lq#307,d_current_day#308,... 4 more fields] parquet
:              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d3
:              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias spark_catalog.tpcds.date_dim
:              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation spark_catalog.tpcds.date_dim[d_date_sk#313,d_date_id#314,d_date#315,d_month_seq#316,d_week_seq#317,d_quarter_seq#318,d_year#319,d_dow#320,d_moy#321,d_dom#322,d_qoy#323,d_fy_year#324,d_fy_quarter_seq#325,d_fy_week_seq#326,d_day_name#327,d_quarter_name#328,d_holiday#329,d_weekend#330,d_following_holiday#331,d_first_dom#332,d_last_dom#333,d_same_day_ly#334,d_same_day_lq#335,d_current_day#336,... 4 more fields] parquet
:              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias spark_catalog.tpcds.store
:              :  :  :  :  :  :  :  :  :  :  :     +- Relation spark_catalog.tpcds.store[s_store_sk#167,s_store_id#168,s_rec_start_date#169,s_rec_end_date#170,s_closed_date_sk#171,s_store_name#172,s_number_employees#173,s_floor_space#174,s_hours#175,s_manager#176,s_market_id#177,s_geography_class#178,s_market_desc#179,s_market_manager#180,s_division_id#181,s_division_name#182,s_company_id#183,s_company_name#184,s_street_number#185,s_street_name#186,s_street_type#187,s_suite_number#188,s_city#189,s_county#190,... 5 more fields] parquet
:              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias spark_catalog.tpcds.customer
:              :  :  :  :  :  :  :  :  :  :     +- Relation spark_catalog.tpcds.customer[c_customer_sk#196,c_customer_id#197,c_current_cdemo_sk#198,c_current_hdemo_sk#199,c_current_addr_sk#200,c_first_shipto_date_sk#201,c_first_sales_date_sk#202,c_salutation#203,c_first_name#204,c_last_name#205,c_preferred_cust_flag#206,c_birth_day#207,c_birth_month#208,c_birth_year#209,c_birth_country#210,c_login#211,c_email_address#212,c_last_review_date#213] parquet
:              :  :  :  :  :  :  :  :  :  +- SubqueryAlias cd1
:              :  :  :  :  :  :  :  :  :     +- SubqueryAlias spark_catalog.tpcds.customer_demographics
:              :  :  :  :  :  :  :  :  :        +- Relation spark_catalog.tpcds.customer_demographics[cd_demo_sk#214,cd_gender#215,cd_marital_status#216,cd_education_status#217,cd_purchase_estimate#218,cd_credit_rating#219,cd_dep_count#220,cd_dep_employed_count#221,cd_dep_college_count#222] parquet
:              :  :  :  :  :  :  :  :  +- SubqueryAlias cd2
:              :  :  :  :  :  :  :  :     +- SubqueryAlias spark_catalog.tpcds.customer_demographics
:              :  :  :  :  :  :  :  :        +- Relation spark_catalog.tpcds.customer_demographics[cd_demo_sk#341,cd_gender#342,cd_marital_status#343,cd_education_status#344,cd_purchase_estimate#345,cd_credit_rating#346,cd_dep_count#347,cd_dep_employed_count#348,cd_dep_college_count#349] parquet
:              :  :  :  :  :  :  :  +- SubqueryAlias spark_catalog.tpcds.promotion
:              :  :  :  :  :  :  :     +- Relation spark_catalog.tpcds.promotion[p_promo_sk#223,p_promo_id#224,p_start_date_sk#225,p_end_date_sk#226,p_item_sk#227,p_cost#228,p_response_target#229,p_promo_name#230,p_channel_dmail#231,p_channel_email#232,p_channel_catalog#233,p_channel_tv#234,p_channel_radio#235,p_channel_press#236,p_channel_event#237,p_channel_demo#238,p_channel_details#239,p_purpose#240,p_discount_active#241] parquet
:              :  :  :  :  :  :  +- SubqueryAlias hd1
:              :  :  :  :  :  :     +- SubqueryAlias spark_catalog.tpcds.household_demographics
:              :  :  :  :  :  :        +- Relation spark_catalog.tpcds.household_demographics[hd_demo_sk#242,hd_income_band_sk#243,hd_buy_potential#244,hd_dep_count#245,hd_vehicle_count#246] parquet
:              :  :  :  :  :  +- SubqueryAlias hd2
:              :  :  :  :  :     +- SubqueryAlias spark_catalog.tpcds.household_demographics
:              :  :  :  :  :        +- Relation spark_catalog.tpcds.household_demographics[hd_demo_sk#350,hd_income_band_sk#351,hd_buy_potential#352,hd_dep_count#353,hd_vehicle_count#354] parquet
:              :  :  :  :  +- SubqueryAlias ad1
:              :  :  :  :     +- SubqueryAlias spark_catalog.tpcds.customer_address
:              :  :  :  :        +- Relation spark_catalog.tpcds.customer_address[ca_address_sk#247,ca_address_id#248,ca_street_number#249,ca_street_name#250,ca_street_type#251,ca_suite_number#252,ca_city#253,ca_county#254,ca_state#255,ca_zip#256,ca_country#257,ca_gmt_offset#258,ca_location_type#259] parquet
:              :  :  :  +- SubqueryAlias ad2
:              :  :  :     +- SubqueryAlias spark_catalog.tpcds.customer_address
:              :  :  :        +- Relation spark_catalog.tpcds.customer_address[ca_address_sk#355,ca_address_id#356,ca_street_number#357,ca_street_name#358,ca_street_type#359,ca_suite_number#360,ca_city#361,ca_county#362,ca_state#363,ca_zip#364,ca_country#365,ca_gmt_offset#366,ca_location_type#367] parquet
:              :  :  +- SubqueryAlias ib1
:              :  :     +- SubqueryAlias spark_catalog.tpcds.income_band
:              :  :        +- Relation spark_catalog.tpcds.income_band[ib_income_band_sk#260,ib_lower_bound#261,ib_upper_bound#262] parquet
:              :  +- SubqueryAlias ib2
:              :     +- SubqueryAlias spark_catalog.tpcds.income_band
:              :        +- Relation spark_catalog.tpcds.income_band[ib_income_band_sk#368,ib_lower_bound#369,ib_upper_bound#370] parquet
:              +- SubqueryAlias spark_catalog.tpcds.item
:                 +- Relation spark_catalog.tpcds.item[i_item_sk#263,i_item_id#264,i_rec_start_date#265,i_rec_end_date#266,i_item_desc#267,i_current_price#268,i_wholesale_cost#269,i_brand_id#270,i_brand#271,i_class_id#272,i_class#273,i_category_id#274,i_category#275,i_manufact_id#276,i_manufact#277,i_size#278,i_formulation#279,i_color#280,i_units#281,i_container#282,i_manager_id#283,i_product_name#284] parquet
+- Sort [product_name#10 ASC NULLS FIRST, store_name#12 ASC NULLS FIRST, cnt_2#7L ASC NULLS FIRST], true
   +- Project [product_name#10, store_name#12, store_zip#13, b_street_number#14, b_street_name#15, b_city#16, b_zip#17, c_street_number#18, c_street_name#19, c_city#20, c_zip#21, syear#22, cnt#25L, s1#26 AS s11#0, s2#27 AS s21#1, s3#28 AS s31#2, s1#413 AS s12#3, s2#414 AS s22#4, s3#415 AS s32#5, syear#409 AS syear_2#6, cnt#412L AS cnt_2#7L]
      +- Filter ((((item_sk#11 = item_sk#398) AND (syear#22 = 1999)) AND (syear#409 = (1999 + 1))) AND (((cnt#412L <= cnt#25L) AND (store_name#12 = store_name#399)) AND (store_zip#13 = store_zip#400)))
         +- Join Inner
            :- SubqueryAlias cs1
            :  +- SubqueryAlias cross_sales
            :     +- CTERelationRef 1, true, [product_name#10, item_sk#11, store_name#12, store_zip#13, b_street_number#14, b_street_name#15, b_city#16, b_zip#17, c_street_number#18, c_street_name#19, c_city#20, c_zip#21, syear#22, fsyear#23, s2year#24, cnt#25L, s1#26, s2#27, s3#28], false
            +- SubqueryAlias cs2
               +- SubqueryAlias cross_sales
                  +- CTERelationRef 1, true, [product_name#397, item_sk#398, store_name#399, store_zip#400, b_street_number#401, b_street_name#402, b_city#403, b_zip#404, c_street_number#405, c_street_name#406, c_city#407, c_zip#408, syear#409, fsyear#410, s2year#411, cnt#412L, s1#413, s2#414, s3#415], false

== Optimized Logical Plan ==
Sort [product_name#10 ASC NULLS FIRST, store_name#12 ASC NULLS FIRST, cnt_2#7L ASC NULLS FIRST], true
+- Project [product_name#10, store_name#12, store_zip#13, b_street_number#14, b_street_name#15, b_city#16, b_zip#17, c_street_number#18, c_street_name#19, c_city#20, c_zip#21, syear#22, cnt#25L, s1#26 AS s11#0, s2#27 AS s21#1, s3#28 AS s31#2, s1#413 AS s12#3, s2#414 AS s22#4, s3#415 AS s32#5, syear#409 AS syear_2#6, cnt#412L AS cnt_2#7L]
   +- Join Inner, ((((item_sk#11 = item_sk#398) AND (cnt#412L <= cnt#25L)) AND (store_name#12 = store_name#399)) AND (store_zip#13 = store_zip#400))
      :- Aggregate [i_product_name#284, i_item_sk#263, s_store_name#172, s_zip#192, ca_street_number#249, ca_street_name#250, ca_city#253, ca_zip#256, ca_street_number#357, ca_street_name#358, ca_city#361, ca_zip#364, d_year#145, d_year#291, d_year#319], [i_product_name#284 AS product_name#10, i_item_sk#263 AS item_sk#11, s_store_name#172 AS store_name#12, s_zip#192 AS store_zip#13, ca_street_number#249 AS b_street_number#14, ca_street_name#250 AS b_street_name#15, ca_city#253 AS b_city#16, ca_zip#256 AS b_zip#17, ca_street_number#357 AS c_street_number#18, ca_street_name#358 AS c_street_name#19, ca_city#361 AS c_city#20, ca_zip#364 AS c_zip#21, d_year#145 AS syear#22, count(1) AS cnt#25L, sum(ss_wholesale_cost#107) AS s1#26, sum(ss_list_price#108) AS s2#27, sum(ss_coupon_amt#115) AS s3#28]
      :  +- Project [ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115, d_year#145, d_year#291, d_year#319, s_store_name#172, s_zip#192, ca_street_number#249, ca_street_name#250, ca_city#253, ca_zip#256, ca_street_number#357, ca_street_name#358, ca_city#361, ca_zip#364, i_item_sk#263, i_product_name#284]
      :     +- Join Inner, (ss_item_sk#98 = i_item_sk#263)
      :        :- Project [ss_item_sk#98, ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115, d_year#145, s_store_name#172, s_zip#192, d_year#291, d_year#319, ca_street_number#249, ca_street_name#250, ca_city#253, ca_zip#256, ca_street_number#357, ca_street_name#358, ca_city#361, ca_zip#364]
      :        :  +- Join Inner, (hd_income_band_sk#351 = ib_income_band_sk#368)
      :        :     :- Project [ss_item_sk#98, ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115, d_year#145, s_store_name#172, s_zip#192, d_year#291, d_year#319, hd_income_band_sk#351, ca_street_number#249, ca_street_name#250, ca_city#253, ca_zip#256, ca_street_number#357, ca_street_name#358, ca_city#361, ca_zip#364]
      :        :     :  +- Join Inner, (hd_income_band_sk#243 = ib_income_band_sk#260)
      :        :     :     :- Project [ss_item_sk#98, ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115, d_year#145, s_store_name#172, s_zip#192, d_year#291, d_year#319, hd_income_band_sk#243, hd_income_band_sk#351, ca_street_number#249, ca_street_name#250, ca_city#253, ca_zip#256, ca_street_number#357, ca_street_name#358, ca_city#361, ca_zip#364]
      :        :     :     :  +- Join Inner, (c_current_addr_sk#200 = ca_address_sk#355)
      :        :     :     :     :- Project [ss_item_sk#98, ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115, d_year#145, s_store_name#172, s_zip#192, c_current_addr_sk#200, d_year#291, d_year#319, hd_income_band_sk#243, hd_income_band_sk#351, ca_street_number#249, ca_street_name#250, ca_city#253, ca_zip#256]
      :        :     :     :     :  +- Join Inner, (ss_addr_sk#102 = ca_address_sk#247)
      :        :     :     :     :     :- Project [ss_item_sk#98, ss_addr_sk#102, ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115, d_year#145, s_store_name#172, s_zip#192, c_current_addr_sk#200, d_year#291, d_year#319, hd_income_band_sk#243, hd_income_band_sk#351]
      :        :     :     :     :     :  +- Join Inner, (c_current_hdemo_sk#199 = hd_demo_sk#350)
      :        :     :     :     :     :     :- Project [ss_item_sk#98, ss_addr_sk#102, ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115, d_year#145, s_store_name#172, s_zip#192, c_current_hdemo_sk#199, c_current_addr_sk#200, d_year#291, d_year#319, hd_income_band_sk#243]
      :        :     :     :     :     :     :  +- Join Inner, (ss_hdemo_sk#101 = hd_demo_sk#242)
      :        :     :     :     :     :     :     :- Project [ss_item_sk#98, ss_hdemo_sk#101, ss_addr_sk#102, ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115, d_year#145, s_store_name#172, s_zip#192, c_current_hdemo_sk#199, c_current_addr_sk#200, d_year#291, d_year#319]
      :        :     :     :     :     :     :     :  +- Join Inner, (ss_promo_sk#104 = p_promo_sk#223)
      :        :     :     :     :     :     :     :     :- Project [ss_item_sk#98, ss_hdemo_sk#101, ss_addr_sk#102, ss_promo_sk#104, ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115, d_year#145, s_store_name#172, s_zip#192, c_current_hdemo_sk#199, c_current_addr_sk#200, d_year#291, d_year#319]
      :        :     :     :     :     :     :     :     :  +- Join Inner, ((c_current_cdemo_sk#198 = cd_demo_sk#341) AND NOT (cd_marital_status#216 = cd_marital_status#343))
      :        :     :     :     :     :     :     :     :     :- Project [ss_item_sk#98, ss_hdemo_sk#101, ss_addr_sk#102, ss_promo_sk#104, ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115, d_year#145, s_store_name#172, s_zip#192, c_current_cdemo_sk#198, c_current_hdemo_sk#199, c_current_addr_sk#200, d_year#291, d_year#319, cd_marital_status#216]
      :        :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_cdemo_sk#100 = cd_demo_sk#214)
      :        :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#98, ss_cdemo_sk#100, ss_hdemo_sk#101, ss_addr_sk#102, ss_promo_sk#104, ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115, d_year#145, s_store_name#172, s_zip#192, c_current_cdemo_sk#198, c_current_hdemo_sk#199, c_current_addr_sk#200, d_year#291, d_year#319]
      :        :     :     :     :     :     :     :     :     :     :  +- Join Inner, (c_first_shipto_date_sk#201 = d_date_sk#313)
      :        :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#98, ss_cdemo_sk#100, ss_hdemo_sk#101, ss_addr_sk#102, ss_promo_sk#104, ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115, d_year#145, s_store_name#172, s_zip#192, c_current_cdemo_sk#198, c_current_hdemo_sk#199, c_current_addr_sk#200, c_first_shipto_date_sk#201, d_year#291]
      :        :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (c_first_sales_date_sk#202 = d_date_sk#285)
      :        :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#98, ss_cdemo_sk#100, ss_hdemo_sk#101, ss_addr_sk#102, ss_promo_sk#104, ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115, d_year#145, s_store_name#172, s_zip#192, c_current_cdemo_sk#198, c_current_hdemo_sk#199, c_current_addr_sk#200, c_first_shipto_date_sk#201, c_first_sales_date_sk#202]
      :        :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_customer_sk#99 = c_customer_sk#196)
      :        :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#98, ss_customer_sk#99, ss_cdemo_sk#100, ss_hdemo_sk#101, ss_addr_sk#102, ss_promo_sk#104, ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115, d_year#145, s_store_name#172, s_zip#192]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_store_sk#103 = s_store_sk#167)
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#98, ss_customer_sk#99, ss_cdemo_sk#100, ss_hdemo_sk#101, ss_addr_sk#102, ss_store_sk#103, ss_promo_sk#104, ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115, d_year#145]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_sold_date_sk#96 = d_date_sk#139)
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#96, ss_item_sk#98, ss_customer_sk#99, ss_cdemo_sk#100, ss_hdemo_sk#101, ss_addr_sk#102, ss_store_sk#103, ss_promo_sk#104, ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_item_sk#98 = cs_item_sk#50)
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#96, ss_item_sk#98, ss_customer_sk#99, ss_cdemo_sk#100, ss_hdemo_sk#101, ss_addr_sk#102, ss_store_sk#103, ss_promo_sk#104, ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, ((ss_item_sk#98 = sr_item_sk#121) AND (ss_ticket_number#105 = sr_ticket_number#128))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#96, ss_item_sk#98, ss_customer_sk#99, ss_cdemo_sk#100, ss_hdemo_sk#101, ss_addr_sk#102, ss_store_sk#103, ss_promo_sk#104, ss_ticket_number#105, ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Filter (((((isnotnull(ss_item_sk#98) AND isnotnull(ss_ticket_number#105)) AND isnotnull(ss_sold_date_sk#96)) AND (isnotnull(ss_store_sk#103) AND isnotnull(ss_customer_sk#99))) AND isnotnull(ss_cdemo_sk#100)) AND ((isnotnull(ss_promo_sk#104) AND isnotnull(ss_hdemo_sk#101)) AND isnotnull(ss_addr_sk#102)))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Relation spark_catalog.tpcds.store_sales[ss_sold_date_sk#96,ss_sold_time_sk#97,ss_item_sk#98,ss_customer_sk#99,ss_cdemo_sk#100,ss_hdemo_sk#101,ss_addr_sk#102,ss_store_sk#103,ss_promo_sk#104,ss_ticket_number#105,ss_quantity#106,ss_wholesale_cost#107,ss_list_price#108,ss_sales_price#109,ss_ext_discount_amt#110,ss_ext_sales_price#111,ss_ext_wholesale_cost#112,ss_ext_list_price#113,ss_ext_tax#114,ss_coupon_amt#115,ss_net_paid#116,ss_net_paid_inc_tax#117,ss_net_profit#118] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [sr_item_sk#121, sr_ticket_number#128]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sr_item_sk#121) AND isnotnull(sr_ticket_number#128))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation spark_catalog.tpcds.store_returns[sr_returned_date_sk#119,sr_return_time_sk#120,sr_item_sk#121,sr_customer_sk#122,sr_cdemo_sk#123,sr_hdemo_sk#124,sr_addr_sk#125,sr_store_sk#126,sr_reason_sk#127,sr_ticket_number#128,sr_return_quantity#129,sr_return_amt#130,sr_return_tax#131,sr_return_amt_inc_tax#132,sr_fee#133,sr_return_ship_cost#134,sr_refunded_cash#135,sr_reversed_charge#136,sr_store_credit#137,sr_net_loss#138] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [cs_item_sk#50]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(sale#8) AND isnotnull(refund#9)) AND (sale#8 > (2.0 * refund#9)))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Aggregate [cs_item_sk#50], [cs_item_sk#50, sum(cs_ext_list_price#60) AS sale#8, sum(((cr_refunded_cash#92 + cr_reversed_charge#93) + cr_store_credit#94)) AS refund#9]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- Project [cs_item_sk#50, cs_ext_list_price#60, cr_refunded_cash#92, cr_reversed_charge#93, cr_store_credit#94]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Join Inner, ((cs_item_sk#50 = cr_item_sk#71) AND (cs_order_number#52 = cr_order_number#85))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :- Project [cs_item_sk#50, cs_order_number#52, cs_ext_list_price#60]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :  +- Filter (isnotnull(cs_item_sk#50) AND isnotnull(cs_order_number#52))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :     +- Relation spark_catalog.tpcds.catalog_sales[cs_sold_date_sk#35,cs_sold_time_sk#36,cs_ship_date_sk#37,cs_bill_customer_sk#38,cs_bill_cdemo_sk#39,cs_bill_hdemo_sk#40,cs_bill_addr_sk#41,cs_ship_customer_sk#42,cs_ship_cdemo_sk#43,cs_ship_hdemo_sk#44,cs_ship_addr_sk#45,cs_call_center_sk#46,cs_catalog_page_sk#47,cs_ship_mode_sk#48,cs_warehouse_sk#49,cs_item_sk#50,cs_promo_sk#51,cs_order_number#52,cs_quantity#53,cs_wholesale_cost#54,cs_list_price#55,cs_sales_price#56,cs_ext_discount_amt#57,cs_ext_sales_price#58,... 10 more fields] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- Project [cr_item_sk#71, cr_order_number#85, cr_refunded_cash#92, cr_reversed_charge#93, cr_store_credit#94]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- Filter (isnotnull(cr_item_sk#71) AND isnotnull(cr_order_number#85))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- Relation spark_catalog.tpcds.catalog_returns[cr_returned_date_sk#69,cr_returned_time_sk#70,cr_item_sk#71,cr_refunded_customer_sk#72,cr_refunded_cdemo_sk#73,cr_refunded_hdemo_sk#74,cr_refunded_addr_sk#75,cr_returning_customer_sk#76,cr_returning_cdemo_sk#77,cr_returning_hdemo_sk#78,cr_returning_addr_sk#79,cr_call_center_sk#80,cr_catalog_page_sk#81,cr_ship_mode_sk#82,cr_warehouse_sk#83,cr_reason_sk#84,cr_order_number#85,cr_return_quantity#86,cr_return_amount#87,cr_return_tax#88,cr_return_amt_inc_tax#89,cr_fee#90,cr_return_ship_cost#91,cr_refunded_cash#92,... 3 more fields] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#139, d_year#145]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(d_year#145) AND (d_year#145 = 1999)) AND isnotnull(d_date_sk#139))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation spark_catalog.tpcds.date_dim[d_date_sk#139,d_date_id#140,d_date#141,d_month_seq#142,d_week_seq#143,d_quarter_seq#144,d_year#145,d_dow#146,d_moy#147,d_dom#148,d_qoy#149,d_fy_year#150,d_fy_quarter_seq#151,d_fy_week_seq#152,d_day_name#153,d_quarter_name#154,d_holiday#155,d_weekend#156,d_following_holiday#157,d_first_dom#158,d_last_dom#159,d_same_day_ly#160,d_same_day_lq#161,d_current_day#162,... 4 more fields] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [s_store_sk#167, s_store_name#172, s_zip#192]
      :        :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(s_store_sk#167) AND (isnotnull(s_store_name#172) AND isnotnull(s_zip#192)))
      :        :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation spark_catalog.tpcds.store[s_store_sk#167,s_store_id#168,s_rec_start_date#169,s_rec_end_date#170,s_closed_date_sk#171,s_store_name#172,s_number_employees#173,s_floor_space#174,s_hours#175,s_manager#176,s_market_id#177,s_geography_class#178,s_market_desc#179,s_market_manager#180,s_division_id#181,s_division_name#182,s_company_id#183,s_company_name#184,s_street_number#185,s_street_name#186,s_street_type#187,s_suite_number#188,s_city#189,s_county#190,... 5 more fields] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     :     +- Project [c_customer_sk#196, c_current_cdemo_sk#198, c_current_hdemo_sk#199, c_current_addr_sk#200, c_first_shipto_date_sk#201, c_first_sales_date_sk#202]
      :        :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(c_customer_sk#196) AND ((isnotnull(c_first_sales_date_sk#202) AND isnotnull(c_first_shipto_date_sk#201)) AND isnotnull(c_current_cdemo_sk#198))) AND (isnotnull(c_current_hdemo_sk#199) AND isnotnull(c_current_addr_sk#200)))
      :        :     :     :     :     :     :     :     :     :     :     :     :           +- Relation spark_catalog.tpcds.customer[c_customer_sk#196,c_customer_id#197,c_current_cdemo_sk#198,c_current_hdemo_sk#199,c_current_addr_sk#200,c_first_shipto_date_sk#201,c_first_sales_date_sk#202,c_salutation#203,c_first_name#204,c_last_name#205,c_preferred_cust_flag#206,c_birth_day#207,c_birth_month#208,c_birth_year#209,c_birth_country#210,c_login#211,c_email_address#212,c_last_review_date#213] parquet
      :        :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#285, d_year#291]
      :        :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#285)
      :        :     :     :     :     :     :     :     :     :     :     :           +- Relation spark_catalog.tpcds.date_dim[d_date_sk#285,d_date_id#286,d_date#287,d_month_seq#288,d_week_seq#289,d_quarter_seq#290,d_year#291,d_dow#292,d_moy#293,d_dom#294,d_qoy#295,d_fy_year#296,d_fy_quarter_seq#297,d_fy_week_seq#298,d_day_name#299,d_quarter_name#300,d_holiday#301,d_weekend#302,d_following_holiday#303,d_first_dom#304,d_last_dom#305,d_same_day_ly#306,d_same_day_lq#307,d_current_day#308,... 4 more fields] parquet
      :        :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#313, d_year#319]
      :        :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#313)
      :        :     :     :     :     :     :     :     :     :     :           +- Relation spark_catalog.tpcds.date_dim[d_date_sk#313,d_date_id#314,d_date#315,d_month_seq#316,d_week_seq#317,d_quarter_seq#318,d_year#319,d_dow#320,d_moy#321,d_dom#322,d_qoy#323,d_fy_year#324,d_fy_quarter_seq#325,d_fy_week_seq#326,d_day_name#327,d_quarter_name#328,d_holiday#329,d_weekend#330,d_following_holiday#331,d_first_dom#332,d_last_dom#333,d_same_day_ly#334,d_same_day_lq#335,d_current_day#336,... 4 more fields] parquet
      :        :     :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#214, cd_marital_status#216]
      :        :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#214) AND isnotnull(cd_marital_status#216))
      :        :     :     :     :     :     :     :     :     :           +- Relation spark_catalog.tpcds.customer_demographics[cd_demo_sk#214,cd_gender#215,cd_marital_status#216,cd_education_status#217,cd_purchase_estimate#218,cd_credit_rating#219,cd_dep_count#220,cd_dep_employed_count#221,cd_dep_college_count#222] parquet
      :        :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#341, cd_marital_status#343]
      :        :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#341) AND isnotnull(cd_marital_status#343))
      :        :     :     :     :     :     :     :     :           +- Relation spark_catalog.tpcds.customer_demographics[cd_demo_sk#341,cd_gender#342,cd_marital_status#343,cd_education_status#344,cd_purchase_estimate#345,cd_credit_rating#346,cd_dep_count#347,cd_dep_employed_count#348,cd_dep_college_count#349] parquet
      :        :     :     :     :     :     :     :     +- Project [p_promo_sk#223]
      :        :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#223)
      :        :     :     :     :     :     :     :           +- Relation spark_catalog.tpcds.promotion[p_promo_sk#223,p_promo_id#224,p_start_date_sk#225,p_end_date_sk#226,p_item_sk#227,p_cost#228,p_response_target#229,p_promo_name#230,p_channel_dmail#231,p_channel_email#232,p_channel_catalog#233,p_channel_tv#234,p_channel_radio#235,p_channel_press#236,p_channel_event#237,p_channel_demo#238,p_channel_details#239,p_purpose#240,p_discount_active#241] parquet
      :        :     :     :     :     :     :     +- Project [hd_demo_sk#242, hd_income_band_sk#243]
      :        :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#242) AND isnotnull(hd_income_band_sk#243))
      :        :     :     :     :     :     :           +- Relation spark_catalog.tpcds.household_demographics[hd_demo_sk#242,hd_income_band_sk#243,hd_buy_potential#244,hd_dep_count#245,hd_vehicle_count#246] parquet
      :        :     :     :     :     :     +- Project [hd_demo_sk#350, hd_income_band_sk#351]
      :        :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#350) AND isnotnull(hd_income_band_sk#351))
      :        :     :     :     :     :           +- Relation spark_catalog.tpcds.household_demographics[hd_demo_sk#350,hd_income_band_sk#351,hd_buy_potential#352,hd_dep_count#353,hd_vehicle_count#354] parquet
      :        :     :     :     :     +- Project [ca_address_sk#247, ca_street_number#249, ca_street_name#250, ca_city#253, ca_zip#256]
      :        :     :     :     :        +- Filter isnotnull(ca_address_sk#247)
      :        :     :     :     :           +- Relation spark_catalog.tpcds.customer_address[ca_address_sk#247,ca_address_id#248,ca_street_number#249,ca_street_name#250,ca_street_type#251,ca_suite_number#252,ca_city#253,ca_county#254,ca_state#255,ca_zip#256,ca_country#257,ca_gmt_offset#258,ca_location_type#259] parquet
      :        :     :     :     +- Project [ca_address_sk#355, ca_street_number#357, ca_street_name#358, ca_city#361, ca_zip#364]
      :        :     :     :        +- Filter isnotnull(ca_address_sk#355)
      :        :     :     :           +- Relation spark_catalog.tpcds.customer_address[ca_address_sk#355,ca_address_id#356,ca_street_number#357,ca_street_name#358,ca_street_type#359,ca_suite_number#360,ca_city#361,ca_county#362,ca_state#363,ca_zip#364,ca_country#365,ca_gmt_offset#366,ca_location_type#367] parquet
      :        :     :     +- Project [ib_income_band_sk#260]
      :        :     :        +- Filter isnotnull(ib_income_band_sk#260)
      :        :     :           +- Relation spark_catalog.tpcds.income_band[ib_income_band_sk#260,ib_lower_bound#261,ib_upper_bound#262] parquet
      :        :     +- Project [ib_income_band_sk#368]
      :        :        +- Filter isnotnull(ib_income_band_sk#368)
      :        :           +- Relation spark_catalog.tpcds.income_band[ib_income_band_sk#368,ib_lower_bound#369,ib_upper_bound#370] parquet
      :        +- Project [i_item_sk#263, i_product_name#284]
      :           +- Filter ((isnotnull(i_current_price#268) AND ((((i_color#280 IN (purple,burlywood,indian,spring,floral,medium) AND (i_current_price#268 >= 64.0)) AND (i_current_price#268 <= 74.0)) AND (i_current_price#268 >= 65.0)) AND (i_current_price#268 <= 79.0))) AND isnotnull(i_item_sk#263))
      :              +- Relation spark_catalog.tpcds.item[i_item_sk#263,i_item_id#264,i_rec_start_date#265,i_rec_end_date#266,i_item_desc#267,i_current_price#268,i_wholesale_cost#269,i_brand_id#270,i_brand#271,i_class_id#272,i_class#273,i_category_id#274,i_category#275,i_manufact_id#276,i_manufact#277,i_size#278,i_formulation#279,i_color#280,i_units#281,i_container#282,i_manager_id#283,i_product_name#284] parquet
      +- Aggregate [i_product_name#1106, i_item_sk#1085, s_store_name#964, s_zip#984, ca_street_number#1055, ca_street_name#1056, ca_city#1059, ca_zip#1062, ca_street_number#1068, ca_street_name#1069, ca_city#1072, ca_zip#1075, d_year#881, d_year#909, d_year#937], [i_item_sk#1085 AS item_sk#398, s_store_name#964 AS store_name#399, s_zip#984 AS store_zip#400, d_year#881 AS syear#409, count(1) AS cnt#412L, sum(ss_wholesale_cost#782) AS s1#413, sum(ss_list_price#783) AS s2#414, sum(ss_coupon_amt#790) AS s3#415]
         +- Project [ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790, d_year#881, d_year#909, d_year#937, s_store_name#964, s_zip#984, ca_street_number#1055, ca_street_name#1056, ca_city#1059, ca_zip#1062, ca_street_number#1068, ca_street_name#1069, ca_city#1072, ca_zip#1075, i_item_sk#1085, i_product_name#1106]
            +- Join Inner, (ss_item_sk#773 = i_item_sk#1085)
               :- Project [ss_item_sk#773, ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790, d_year#881, s_store_name#964, s_zip#984, d_year#909, d_year#937, ca_street_number#1055, ca_street_name#1056, ca_city#1059, ca_zip#1062, ca_street_number#1068, ca_street_name#1069, ca_city#1072, ca_zip#1075]
               :  +- Join Inner, (hd_income_band_sk#1049 = ib_income_band_sk#1082)
               :     :- Project [ss_item_sk#773, ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790, d_year#881, s_store_name#964, s_zip#984, d_year#909, d_year#937, hd_income_band_sk#1049, ca_street_number#1055, ca_street_name#1056, ca_city#1059, ca_zip#1062, ca_street_number#1068, ca_street_name#1069, ca_city#1072, ca_zip#1075]
               :     :  +- Join Inner, (hd_income_band_sk#1044 = ib_income_band_sk#1079)
               :     :     :- Project [ss_item_sk#773, ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790, d_year#881, s_store_name#964, s_zip#984, d_year#909, d_year#937, hd_income_band_sk#1044, hd_income_band_sk#1049, ca_street_number#1055, ca_street_name#1056, ca_city#1059, ca_zip#1062, ca_street_number#1068, ca_street_name#1069, ca_city#1072, ca_zip#1075]
               :     :     :  +- Join Inner, (c_current_addr_sk#992 = ca_address_sk#1066)
               :     :     :     :- Project [ss_item_sk#773, ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790, d_year#881, s_store_name#964, s_zip#984, c_current_addr_sk#992, d_year#909, d_year#937, hd_income_band_sk#1044, hd_income_band_sk#1049, ca_street_number#1055, ca_street_name#1056, ca_city#1059, ca_zip#1062]
               :     :     :     :  +- Join Inner, (ss_addr_sk#777 = ca_address_sk#1053)
               :     :     :     :     :- Project [ss_item_sk#773, ss_addr_sk#777, ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790, d_year#881, s_store_name#964, s_zip#984, c_current_addr_sk#992, d_year#909, d_year#937, hd_income_band_sk#1044, hd_income_band_sk#1049]
               :     :     :     :     :  +- Join Inner, (c_current_hdemo_sk#991 = hd_demo_sk#1048)
               :     :     :     :     :     :- Project [ss_item_sk#773, ss_addr_sk#777, ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790, d_year#881, s_store_name#964, s_zip#984, c_current_hdemo_sk#991, c_current_addr_sk#992, d_year#909, d_year#937, hd_income_band_sk#1044]
               :     :     :     :     :     :  +- Join Inner, (ss_hdemo_sk#776 = hd_demo_sk#1043)
               :     :     :     :     :     :     :- Project [ss_item_sk#773, ss_hdemo_sk#776, ss_addr_sk#777, ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790, d_year#881, s_store_name#964, s_zip#984, c_current_hdemo_sk#991, c_current_addr_sk#992, d_year#909, d_year#937]
               :     :     :     :     :     :     :  +- Join Inner, (ss_promo_sk#779 = p_promo_sk#1024)
               :     :     :     :     :     :     :     :- Project [ss_item_sk#773, ss_hdemo_sk#776, ss_addr_sk#777, ss_promo_sk#779, ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790, d_year#881, s_store_name#964, s_zip#984, c_current_hdemo_sk#991, c_current_addr_sk#992, d_year#909, d_year#937]
               :     :     :     :     :     :     :     :  +- Join Inner, ((c_current_cdemo_sk#990 = cd_demo_sk#1015) AND NOT (cd_marital_status#1008 = cd_marital_status#1017))
               :     :     :     :     :     :     :     :     :- Project [ss_item_sk#773, ss_hdemo_sk#776, ss_addr_sk#777, ss_promo_sk#779, ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790, d_year#881, s_store_name#964, s_zip#984, c_current_cdemo_sk#990, c_current_hdemo_sk#991, c_current_addr_sk#992, d_year#909, d_year#937, cd_marital_status#1008]
               :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_cdemo_sk#775 = cd_demo_sk#1006)
               :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#773, ss_cdemo_sk#775, ss_hdemo_sk#776, ss_addr_sk#777, ss_promo_sk#779, ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790, d_year#881, s_store_name#964, s_zip#984, c_current_cdemo_sk#990, c_current_hdemo_sk#991, c_current_addr_sk#992, d_year#909, d_year#937]
               :     :     :     :     :     :     :     :     :     :  +- Join Inner, (c_first_shipto_date_sk#993 = d_date_sk#931)
               :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#773, ss_cdemo_sk#775, ss_hdemo_sk#776, ss_addr_sk#777, ss_promo_sk#779, ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790, d_year#881, s_store_name#964, s_zip#984, c_current_cdemo_sk#990, c_current_hdemo_sk#991, c_current_addr_sk#992, c_first_shipto_date_sk#993, d_year#909]
               :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (c_first_sales_date_sk#994 = d_date_sk#903)
               :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#773, ss_cdemo_sk#775, ss_hdemo_sk#776, ss_addr_sk#777, ss_promo_sk#779, ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790, d_year#881, s_store_name#964, s_zip#984, c_current_cdemo_sk#990, c_current_hdemo_sk#991, c_current_addr_sk#992, c_first_shipto_date_sk#993, c_first_sales_date_sk#994]
               :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_customer_sk#774 = c_customer_sk#988)
               :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#773, ss_customer_sk#774, ss_cdemo_sk#775, ss_hdemo_sk#776, ss_addr_sk#777, ss_promo_sk#779, ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790, d_year#881, s_store_name#964, s_zip#984]
               :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_store_sk#778 = s_store_sk#959)
               :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#773, ss_customer_sk#774, ss_cdemo_sk#775, ss_hdemo_sk#776, ss_addr_sk#777, ss_store_sk#778, ss_promo_sk#779, ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790, d_year#881]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_sold_date_sk#771 = d_date_sk#875)
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#771, ss_item_sk#773, ss_customer_sk#774, ss_cdemo_sk#775, ss_hdemo_sk#776, ss_addr_sk#777, ss_store_sk#778, ss_promo_sk#779, ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_item_sk#773 = cs_item_sk#829)
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#771, ss_item_sk#773, ss_customer_sk#774, ss_cdemo_sk#775, ss_hdemo_sk#776, ss_addr_sk#777, ss_store_sk#778, ss_promo_sk#779, ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, ((ss_item_sk#773 = sr_item_sk#796) AND (ss_ticket_number#780 = sr_ticket_number#803))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#771, ss_item_sk#773, ss_customer_sk#774, ss_cdemo_sk#775, ss_hdemo_sk#776, ss_addr_sk#777, ss_store_sk#778, ss_promo_sk#779, ss_ticket_number#780, ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Filter (((((isnotnull(ss_item_sk#773) AND isnotnull(ss_ticket_number#780)) AND isnotnull(ss_sold_date_sk#771)) AND (isnotnull(ss_store_sk#778) AND isnotnull(ss_customer_sk#774))) AND isnotnull(ss_cdemo_sk#775)) AND ((isnotnull(ss_promo_sk#779) AND isnotnull(ss_hdemo_sk#776)) AND isnotnull(ss_addr_sk#777)))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Relation spark_catalog.tpcds.store_sales[ss_sold_date_sk#771,ss_sold_time_sk#772,ss_item_sk#773,ss_customer_sk#774,ss_cdemo_sk#775,ss_hdemo_sk#776,ss_addr_sk#777,ss_store_sk#778,ss_promo_sk#779,ss_ticket_number#780,ss_quantity#781,ss_wholesale_cost#782,ss_list_price#783,ss_sales_price#784,ss_ext_discount_amt#785,ss_ext_sales_price#786,ss_ext_wholesale_cost#787,ss_ext_list_price#788,ss_ext_tax#789,ss_coupon_amt#790,ss_net_paid#791,ss_net_paid_inc_tax#792,ss_net_profit#793] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [sr_item_sk#796, sr_ticket_number#803]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sr_item_sk#796) AND isnotnull(sr_ticket_number#803))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation spark_catalog.tpcds.store_returns[sr_returned_date_sk#794,sr_return_time_sk#795,sr_item_sk#796,sr_customer_sk#797,sr_cdemo_sk#798,sr_hdemo_sk#799,sr_addr_sk#800,sr_store_sk#801,sr_reason_sk#802,sr_ticket_number#803,sr_return_quantity#804,sr_return_amt#805,sr_return_tax#806,sr_return_amt_inc_tax#807,sr_fee#808,sr_return_ship_cost#809,sr_refunded_cash#810,sr_reversed_charge#811,sr_store_credit#812,sr_net_loss#813] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [cs_item_sk#829]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(sale#8) AND isnotnull(refund#9)) AND (sale#8 > (2.0 * refund#9)))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Aggregate [cs_item_sk#829], [cs_item_sk#829, sum(cs_ext_list_price#839) AS sale#8, sum(((cr_refunded_cash#871 + cr_reversed_charge#872) + cr_store_credit#873)) AS refund#9]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- Project [cs_item_sk#829, cs_ext_list_price#839, cr_refunded_cash#871, cr_reversed_charge#872, cr_store_credit#873]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Join Inner, ((cs_item_sk#829 = cr_item_sk#850) AND (cs_order_number#831 = cr_order_number#864))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :- Project [cs_item_sk#829, cs_order_number#831, cs_ext_list_price#839]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :  +- Filter (isnotnull(cs_item_sk#829) AND isnotnull(cs_order_number#831))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :     +- Relation spark_catalog.tpcds.catalog_sales[cs_sold_date_sk#814,cs_sold_time_sk#815,cs_ship_date_sk#816,cs_bill_customer_sk#817,cs_bill_cdemo_sk#818,cs_bill_hdemo_sk#819,cs_bill_addr_sk#820,cs_ship_customer_sk#821,cs_ship_cdemo_sk#822,cs_ship_hdemo_sk#823,cs_ship_addr_sk#824,cs_call_center_sk#825,cs_catalog_page_sk#826,cs_ship_mode_sk#827,cs_warehouse_sk#828,cs_item_sk#829,cs_promo_sk#830,cs_order_number#831,cs_quantity#832,cs_wholesale_cost#833,cs_list_price#834,cs_sales_price#835,cs_ext_discount_amt#836,cs_ext_sales_price#837,... 10 more fields] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- Project [cr_item_sk#850, cr_order_number#864, cr_refunded_cash#871, cr_reversed_charge#872, cr_store_credit#873]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- Filter (isnotnull(cr_item_sk#850) AND isnotnull(cr_order_number#864))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- Relation spark_catalog.tpcds.catalog_returns[cr_returned_date_sk#848,cr_returned_time_sk#849,cr_item_sk#850,cr_refunded_customer_sk#851,cr_refunded_cdemo_sk#852,cr_refunded_hdemo_sk#853,cr_refunded_addr_sk#854,cr_returning_customer_sk#855,cr_returning_cdemo_sk#856,cr_returning_hdemo_sk#857,cr_returning_addr_sk#858,cr_call_center_sk#859,cr_catalog_page_sk#860,cr_ship_mode_sk#861,cr_warehouse_sk#862,cr_reason_sk#863,cr_order_number#864,cr_return_quantity#865,cr_return_amount#866,cr_return_tax#867,cr_return_amt_inc_tax#868,cr_fee#869,cr_return_ship_cost#870,cr_refunded_cash#871,... 3 more fields] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#875, d_year#881]
               :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(d_year#881) AND (d_year#881 = 2000)) AND isnotnull(d_date_sk#875))
               :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation spark_catalog.tpcds.date_dim[d_date_sk#875,d_date_id#876,d_date#877,d_month_seq#878,d_week_seq#879,d_quarter_seq#880,d_year#881,d_dow#882,d_moy#883,d_dom#884,d_qoy#885,d_fy_year#886,d_fy_quarter_seq#887,d_fy_week_seq#888,d_day_name#889,d_quarter_name#890,d_holiday#891,d_weekend#892,d_following_holiday#893,d_first_dom#894,d_last_dom#895,d_same_day_ly#896,d_same_day_lq#897,d_current_day#898,... 4 more fields] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [s_store_sk#959, s_store_name#964, s_zip#984]
               :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(s_store_sk#959) AND (isnotnull(s_store_name#964) AND isnotnull(s_zip#984)))
               :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation spark_catalog.tpcds.store[s_store_sk#959,s_store_id#960,s_rec_start_date#961,s_rec_end_date#962,s_closed_date_sk#963,s_store_name#964,s_number_employees#965,s_floor_space#966,s_hours#967,s_manager#968,s_market_id#969,s_geography_class#970,s_market_desc#971,s_market_manager#972,s_division_id#973,s_division_name#974,s_company_id#975,s_company_name#976,s_street_number#977,s_street_name#978,s_street_type#979,s_suite_number#980,s_city#981,s_county#982,... 5 more fields] parquet
               :     :     :     :     :     :     :     :     :     :     :     :     +- Project [c_customer_sk#988, c_current_cdemo_sk#990, c_current_hdemo_sk#991, c_current_addr_sk#992, c_first_shipto_date_sk#993, c_first_sales_date_sk#994]
               :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(c_customer_sk#988) AND ((isnotnull(c_first_sales_date_sk#994) AND isnotnull(c_first_shipto_date_sk#993)) AND isnotnull(c_current_cdemo_sk#990))) AND (isnotnull(c_current_hdemo_sk#991) AND isnotnull(c_current_addr_sk#992)))
               :     :     :     :     :     :     :     :     :     :     :     :           +- Relation spark_catalog.tpcds.customer[c_customer_sk#988,c_customer_id#989,c_current_cdemo_sk#990,c_current_hdemo_sk#991,c_current_addr_sk#992,c_first_shipto_date_sk#993,c_first_sales_date_sk#994,c_salutation#995,c_first_name#996,c_last_name#997,c_preferred_cust_flag#998,c_birth_day#999,c_birth_month#1000,c_birth_year#1001,c_birth_country#1002,c_login#1003,c_email_address#1004,c_last_review_date#1005] parquet
               :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#903, d_year#909]
               :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#903)
               :     :     :     :     :     :     :     :     :     :     :           +- Relation spark_catalog.tpcds.date_dim[d_date_sk#903,d_date_id#904,d_date#905,d_month_seq#906,d_week_seq#907,d_quarter_seq#908,d_year#909,d_dow#910,d_moy#911,d_dom#912,d_qoy#913,d_fy_year#914,d_fy_quarter_seq#915,d_fy_week_seq#916,d_day_name#917,d_quarter_name#918,d_holiday#919,d_weekend#920,d_following_holiday#921,d_first_dom#922,d_last_dom#923,d_same_day_ly#924,d_same_day_lq#925,d_current_day#926,... 4 more fields] parquet
               :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#931, d_year#937]
               :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#931)
               :     :     :     :     :     :     :     :     :     :           +- Relation spark_catalog.tpcds.date_dim[d_date_sk#931,d_date_id#932,d_date#933,d_month_seq#934,d_week_seq#935,d_quarter_seq#936,d_year#937,d_dow#938,d_moy#939,d_dom#940,d_qoy#941,d_fy_year#942,d_fy_quarter_seq#943,d_fy_week_seq#944,d_day_name#945,d_quarter_name#946,d_holiday#947,d_weekend#948,d_following_holiday#949,d_first_dom#950,d_last_dom#951,d_same_day_ly#952,d_same_day_lq#953,d_current_day#954,... 4 more fields] parquet
               :     :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#1006, cd_marital_status#1008]
               :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#1006) AND isnotnull(cd_marital_status#1008))
               :     :     :     :     :     :     :     :     :           +- Relation spark_catalog.tpcds.customer_demographics[cd_demo_sk#1006,cd_gender#1007,cd_marital_status#1008,cd_education_status#1009,cd_purchase_estimate#1010,cd_credit_rating#1011,cd_dep_count#1012,cd_dep_employed_count#1013,cd_dep_college_count#1014] parquet
               :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#1015, cd_marital_status#1017]
               :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#1015) AND isnotnull(cd_marital_status#1017))
               :     :     :     :     :     :     :     :           +- Relation spark_catalog.tpcds.customer_demographics[cd_demo_sk#1015,cd_gender#1016,cd_marital_status#1017,cd_education_status#1018,cd_purchase_estimate#1019,cd_credit_rating#1020,cd_dep_count#1021,cd_dep_employed_count#1022,cd_dep_college_count#1023] parquet
               :     :     :     :     :     :     :     +- Project [p_promo_sk#1024]
               :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#1024)
               :     :     :     :     :     :     :           +- Relation spark_catalog.tpcds.promotion[p_promo_sk#1024,p_promo_id#1025,p_start_date_sk#1026,p_end_date_sk#1027,p_item_sk#1028,p_cost#1029,p_response_target#1030,p_promo_name#1031,p_channel_dmail#1032,p_channel_email#1033,p_channel_catalog#1034,p_channel_tv#1035,p_channel_radio#1036,p_channel_press#1037,p_channel_event#1038,p_channel_demo#1039,p_channel_details#1040,p_purpose#1041,p_discount_active#1042] parquet
               :     :     :     :     :     :     +- Project [hd_demo_sk#1043, hd_income_band_sk#1044]
               :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#1043) AND isnotnull(hd_income_band_sk#1044))
               :     :     :     :     :     :           +- Relation spark_catalog.tpcds.household_demographics[hd_demo_sk#1043,hd_income_band_sk#1044,hd_buy_potential#1045,hd_dep_count#1046,hd_vehicle_count#1047] parquet
               :     :     :     :     :     +- Project [hd_demo_sk#1048, hd_income_band_sk#1049]
               :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#1048) AND isnotnull(hd_income_band_sk#1049))
               :     :     :     :     :           +- Relation spark_catalog.tpcds.household_demographics[hd_demo_sk#1048,hd_income_band_sk#1049,hd_buy_potential#1050,hd_dep_count#1051,hd_vehicle_count#1052] parquet
               :     :     :     :     +- Project [ca_address_sk#1053, ca_street_number#1055, ca_street_name#1056, ca_city#1059, ca_zip#1062]
               :     :     :     :        +- Filter isnotnull(ca_address_sk#1053)
               :     :     :     :           +- Relation spark_catalog.tpcds.customer_address[ca_address_sk#1053,ca_address_id#1054,ca_street_number#1055,ca_street_name#1056,ca_street_type#1057,ca_suite_number#1058,ca_city#1059,ca_county#1060,ca_state#1061,ca_zip#1062,ca_country#1063,ca_gmt_offset#1064,ca_location_type#1065] parquet
               :     :     :     +- Project [ca_address_sk#1066, ca_street_number#1068, ca_street_name#1069, ca_city#1072, ca_zip#1075]
               :     :     :        +- Filter isnotnull(ca_address_sk#1066)
               :     :     :           +- Relation spark_catalog.tpcds.customer_address[ca_address_sk#1066,ca_address_id#1067,ca_street_number#1068,ca_street_name#1069,ca_street_type#1070,ca_suite_number#1071,ca_city#1072,ca_county#1073,ca_state#1074,ca_zip#1075,ca_country#1076,ca_gmt_offset#1077,ca_location_type#1078] parquet
               :     :     +- Project [ib_income_band_sk#1079]
               :     :        +- Filter isnotnull(ib_income_band_sk#1079)
               :     :           +- Relation spark_catalog.tpcds.income_band[ib_income_band_sk#1079,ib_lower_bound#1080,ib_upper_bound#1081] parquet
               :     +- Project [ib_income_band_sk#1082]
               :        +- Filter isnotnull(ib_income_band_sk#1082)
               :           +- Relation spark_catalog.tpcds.income_band[ib_income_band_sk#1082,ib_lower_bound#1083,ib_upper_bound#1084] parquet
               +- Project [i_item_sk#1085, i_product_name#1106]
                  +- Filter ((isnotnull(i_current_price#1090) AND ((((i_color#1102 IN (purple,burlywood,indian,spring,floral,medium) AND (i_current_price#1090 >= 64.0)) AND (i_current_price#1090 <= 74.0)) AND (i_current_price#1090 >= 65.0)) AND (i_current_price#1090 <= 79.0))) AND isnotnull(i_item_sk#1085))
                     +- Relation spark_catalog.tpcds.item[i_item_sk#1085,i_item_id#1086,i_rec_start_date#1087,i_rec_end_date#1088,i_item_desc#1089,i_current_price#1090,i_wholesale_cost#1091,i_brand_id#1092,i_brand#1093,i_class_id#1094,i_class#1095,i_category_id#1096,i_category#1097,i_manufact_id#1098,i_manufact#1099,i_size#1100,i_formulation#1101,i_color#1102,i_units#1103,i_container#1104,i_manager_id#1105,i_product_name#1106] parquet

== Physical Plan ==
AdaptiveSparkPlan isFinalPlan=false
+- Sort [product_name#10 ASC NULLS FIRST, store_name#12 ASC NULLS FIRST, cnt_2#7L ASC NULLS FIRST], true, 0
   +- Exchange rangepartitioning(product_name#10 ASC NULLS FIRST, store_name#12 ASC NULLS FIRST, cnt_2#7L ASC NULLS FIRST, 200), ENSURE_REQUIREMENTS, [plan_id=912]
      +- Project [product_name#10, store_name#12, store_zip#13, b_street_number#14, b_street_name#15, b_city#16, b_zip#17, c_street_number#18, c_street_name#19, c_city#20, c_zip#21, syear#22, cnt#25L, s1#26 AS s11#0, s2#27 AS s21#1, s3#28 AS s31#2, s1#413 AS s12#3, s2#414 AS s22#4, s3#415 AS s32#5, syear#409 AS syear_2#6, cnt#412L AS cnt_2#7L]
         +- SortMergeJoin [item_sk#11, store_name#12, store_zip#13], [item_sk#398, store_name#399, store_zip#400], Inner, (cnt#412L <= cnt#25L)
            :- Sort [item_sk#11 ASC NULLS FIRST, store_name#12 ASC NULLS FIRST, store_zip#13 ASC NULLS FIRST], false, 0
            :  +- Exchange hashpartitioning(item_sk#11, store_name#12, store_zip#13, 200), ENSURE_REQUIREMENTS, [plan_id=905]
            :     +- HashAggregate(keys=[i_product_name#284, i_item_sk#263, s_store_name#172, s_zip#192, ca_street_number#249, ca_street_name#250, ca_city#253, ca_zip#256, ca_street_number#357, ca_street_name#358, ca_city#361, ca_zip#364, d_year#145, d_year#291, d_year#319], functions=[count(1), sum(ss_wholesale_cost#107), sum(ss_list_price#108), sum(ss_coupon_amt#115)], output=[product_name#10, item_sk#11, store_name#12, store_zip#13, b_street_number#14, b_street_name#15, b_city#16, b_zip#17, c_street_number#18, c_street_name#19, c_city#20, c_zip#21, syear#22, cnt#25L, s1#26, s2#27, s3#28])
            :        +- HashAggregate(keys=[i_product_name#284, i_item_sk#263, s_store_name#172, s_zip#192, ca_street_number#249, ca_street_name#250, ca_city#253, ca_zip#256, ca_street_number#357, ca_street_name#358, ca_city#361, ca_zip#364, d_year#145, d_year#291, d_year#319], functions=[partial_count(1), partial_sum(ss_wholesale_cost#107), partial_sum(ss_list_price#108), partial_sum(ss_coupon_amt#115)], output=[i_product_name#284, i_item_sk#263, s_store_name#172, s_zip#192, ca_street_number#249, ca_street_name#250, ca_city#253, ca_zip#256, ca_street_number#357, ca_street_name#358, ca_city#361, ca_zip#364, d_year#145, d_year#291, d_year#319, count#1130L, sum#1131, sum#1132, sum#1133])
            :           +- Project [ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115, d_year#145, d_year#291, d_year#319, s_store_name#172, s_zip#192, ca_street_number#249, ca_street_name#250, ca_city#253, ca_zip#256, ca_street_number#357, ca_street_name#358, ca_city#361, ca_zip#364, i_item_sk#263, i_product_name#284]
            :              +- BroadcastHashJoin [ss_item_sk#98], [i_item_sk#263], Inner, BuildRight, false
            :                 :- Project [ss_item_sk#98, ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115, d_year#145, s_store_name#172, s_zip#192, d_year#291, d_year#319, ca_street_number#249, ca_street_name#250, ca_city#253, ca_zip#256, ca_street_number#357, ca_street_name#358, ca_city#361, ca_zip#364]
            :                 :  +- BroadcastHashJoin [hd_income_band_sk#351], [ib_income_band_sk#368], Inner, BuildRight, false
            :                 :     :- Project [ss_item_sk#98, ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115, d_year#145, s_store_name#172, s_zip#192, d_year#291, d_year#319, hd_income_band_sk#351, ca_street_number#249, ca_street_name#250, ca_city#253, ca_zip#256, ca_street_number#357, ca_street_name#358, ca_city#361, ca_zip#364]
            :                 :     :  +- BroadcastHashJoin [hd_income_band_sk#243], [ib_income_band_sk#260], Inner, BuildRight, false
            :                 :     :     :- Project [ss_item_sk#98, ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115, d_year#145, s_store_name#172, s_zip#192, d_year#291, d_year#319, hd_income_band_sk#243, hd_income_band_sk#351, ca_street_number#249, ca_street_name#250, ca_city#253, ca_zip#256, ca_street_number#357, ca_street_name#358, ca_city#361, ca_zip#364]
            :                 :     :     :  +- BroadcastHashJoin [c_current_addr_sk#200], [ca_address_sk#355], Inner, BuildRight, false
            :                 :     :     :     :- Project [ss_item_sk#98, ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115, d_year#145, s_store_name#172, s_zip#192, c_current_addr_sk#200, d_year#291, d_year#319, hd_income_band_sk#243, hd_income_band_sk#351, ca_street_number#249, ca_street_name#250, ca_city#253, ca_zip#256]
            :                 :     :     :     :  +- BroadcastHashJoin [ss_addr_sk#102], [ca_address_sk#247], Inner, BuildRight, false
            :                 :     :     :     :     :- Project [ss_item_sk#98, ss_addr_sk#102, ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115, d_year#145, s_store_name#172, s_zip#192, c_current_addr_sk#200, d_year#291, d_year#319, hd_income_band_sk#243, hd_income_band_sk#351]
            :                 :     :     :     :     :  +- BroadcastHashJoin [c_current_hdemo_sk#199], [hd_demo_sk#350], Inner, BuildRight, false
            :                 :     :     :     :     :     :- Project [ss_item_sk#98, ss_addr_sk#102, ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115, d_year#145, s_store_name#172, s_zip#192, c_current_hdemo_sk#199, c_current_addr_sk#200, d_year#291, d_year#319, hd_income_band_sk#243]
            :                 :     :     :     :     :     :  +- BroadcastHashJoin [ss_hdemo_sk#101], [hd_demo_sk#242], Inner, BuildRight, false
            :                 :     :     :     :     :     :     :- Project [ss_item_sk#98, ss_hdemo_sk#101, ss_addr_sk#102, ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115, d_year#145, s_store_name#172, s_zip#192, c_current_hdemo_sk#199, c_current_addr_sk#200, d_year#291, d_year#319]
            :                 :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_promo_sk#104], [p_promo_sk#223], Inner, BuildRight, false
            :                 :     :     :     :     :     :     :     :- Project [ss_item_sk#98, ss_hdemo_sk#101, ss_addr_sk#102, ss_promo_sk#104, ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115, d_year#145, s_store_name#172, s_zip#192, c_current_hdemo_sk#199, c_current_addr_sk#200, d_year#291, d_year#319]
            :                 :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_current_cdemo_sk#198], [cd_demo_sk#341], Inner, BuildRight, NOT (cd_marital_status#216 = cd_marital_status#343), false
            :                 :     :     :     :     :     :     :     :     :- Project [ss_item_sk#98, ss_hdemo_sk#101, ss_addr_sk#102, ss_promo_sk#104, ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115, d_year#145, s_store_name#172, s_zip#192, c_current_cdemo_sk#198, c_current_hdemo_sk#199, c_current_addr_sk#200, d_year#291, d_year#319, cd_marital_status#216]
            :                 :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_cdemo_sk#100], [cd_demo_sk#214], Inner, BuildRight, false
            :                 :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#98, ss_cdemo_sk#100, ss_hdemo_sk#101, ss_addr_sk#102, ss_promo_sk#104, ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115, d_year#145, s_store_name#172, s_zip#192, c_current_cdemo_sk#198, c_current_hdemo_sk#199, c_current_addr_sk#200, d_year#291, d_year#319]
            :                 :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_shipto_date_sk#201], [d_date_sk#313], Inner, BuildRight, false
            :                 :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#98, ss_cdemo_sk#100, ss_hdemo_sk#101, ss_addr_sk#102, ss_promo_sk#104, ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115, d_year#145, s_store_name#172, s_zip#192, c_current_cdemo_sk#198, c_current_hdemo_sk#199, c_current_addr_sk#200, c_first_shipto_date_sk#201, d_year#291]
            :                 :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_sales_date_sk#202], [d_date_sk#285], Inner, BuildRight, false
            :                 :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#98, ss_cdemo_sk#100, ss_hdemo_sk#101, ss_addr_sk#102, ss_promo_sk#104, ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115, d_year#145, s_store_name#172, s_zip#192, c_current_cdemo_sk#198, c_current_hdemo_sk#199, c_current_addr_sk#200, c_first_shipto_date_sk#201, c_first_sales_date_sk#202]
            :                 :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_customer_sk#99], [c_customer_sk#196], Inner, BuildRight, false
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#98, ss_customer_sk#99, ss_cdemo_sk#100, ss_hdemo_sk#101, ss_addr_sk#102, ss_promo_sk#104, ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115, d_year#145, s_store_name#172, s_zip#192]
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_store_sk#103], [s_store_sk#167], Inner, BuildRight, false
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#98, ss_customer_sk#99, ss_cdemo_sk#100, ss_hdemo_sk#101, ss_addr_sk#102, ss_store_sk#103, ss_promo_sk#104, ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115, d_year#145]
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_sold_date_sk#96], [d_date_sk#139], Inner, BuildRight, false
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#96, ss_item_sk#98, ss_customer_sk#99, ss_cdemo_sk#100, ss_hdemo_sk#101, ss_addr_sk#102, ss_store_sk#103, ss_promo_sk#104, ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115]
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin [ss_item_sk#98], [cs_item_sk#50], Inner
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Sort [ss_item_sk#98 ASC NULLS FIRST], false, 0
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Exchange hashpartitioning(ss_item_sk#98, 200), ENSURE_REQUIREMENTS, [plan_id=755]
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [ss_sold_date_sk#96, ss_item_sk#98, ss_customer_sk#99, ss_cdemo_sk#100, ss_hdemo_sk#101, ss_addr_sk#102, ss_store_sk#103, ss_promo_sk#104, ss_wholesale_cost#107, ss_list_price#108, ss_coupon_amt#115]
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- BroadcastHashJoin [ss_item_sk#98, ss_ticket_number#105], [sr_item_sk#121, sr_ticket_number#128], Inner, BuildRight, false
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           :- Filter ((((((((isnotnull(ss_item_sk#98) AND isnotnull(ss_ticket_number#105)) AND isnotnull(ss_sold_date_sk#96)) AND isnotnull(ss_store_sk#103)) AND isnotnull(ss_customer_sk#99)) AND isnotnull(ss_cdemo_sk#100)) AND isnotnull(ss_promo_sk#104)) AND isnotnull(ss_hdemo_sk#101)) AND isnotnull(ss_addr_sk#102))
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           :  +- FileScan parquet spark_catalog.tpcds.store_sales[ss_sold_date_sk#96,ss_item_sk#98,ss_customer_sk#99,ss_cdemo_sk#100,ss_hdemo_sk#101,ss_addr_sk#102,ss_store_sk#103,ss_promo_sk#104,ss_ticket_number#105,ss_wholesale_cost#107,ss_list_price#108,ss_coupon_amt#115] Batched: true, DataFilters: [isnotnull(ss_item_sk#98), isnotnull(ss_ticket_number#105), isnotnull(ss_sold_date_sk#96), isnotn..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_sold_date_sk), IsNotNull(ss_sto..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_a...
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- BroadcastExchange HashedRelationBroadcastMode(List((shiftleft(cast(input[0, int, false] as bigint), 32) | (cast(input[1, int, false] as bigint) & 4294967295))),false), [plan_id=741]
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- Filter (isnotnull(sr_item_sk#121) AND isnotnull(sr_ticket_number#128))
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- FileScan parquet spark_catalog.tpcds.store_returns[sr_item_sk#121,sr_ticket_number#128] Batched: true, DataFilters: [isnotnull(sr_item_sk#121), isnotnull(sr_ticket_number#128)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:int>
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Sort [cs_item_sk#50 ASC NULLS FIRST], false, 0
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Project [cs_item_sk#50]
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Filter ((isnotnull(sale#8) AND isnotnull(refund#9)) AND (sale#8 > (2.0 * refund#9)))
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- HashAggregate(keys=[cs_item_sk#50], functions=[sum(cs_ext_list_price#60), sum(((cr_refunded_cash#92 + cr_reversed_charge#93) + cr_store_credit#94))], output=[cs_item_sk#50, sale#8, refund#9])
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Exchange hashpartitioning(cs_item_sk#50, 200), ENSURE_REQUIREMENTS, [plan_id=749]
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- HashAggregate(keys=[cs_item_sk#50], functions=[partial_sum(cs_ext_list_price#60), partial_sum(((cr_refunded_cash#92 + cr_reversed_charge#93) + cr_store_credit#94))], output=[cs_item_sk#50, sum#1136, sum#1137])
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- Project [cs_item_sk#50, cs_ext_list_price#60, cr_refunded_cash#92, cr_reversed_charge#93, cr_store_credit#94]
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- BroadcastHashJoin [cs_item_sk#50, cs_order_number#52], [cr_item_sk#71, cr_order_number#85], Inner, BuildRight, false
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             :- Filter (isnotnull(cs_item_sk#50) AND isnotnull(cs_order_number#52))
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             :  +- FileScan parquet spark_catalog.tpcds.catalog_sales[cs_item_sk#50,cs_order_number#52,cs_ext_list_price#60] Batched: true, DataFilters: [isnotnull(cs_item_sk#50), isnotnull(cs_order_number#52)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:int,cs_ext_list_price:double>
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             +- BroadcastExchange HashedRelationBroadcastMode(List((shiftleft(cast(input[0, int, false] as bigint), 32) | (cast(input[1, int, false] as bigint) & 4294967295))),false), [plan_id=744]
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                +- Filter (isnotnull(cr_item_sk#71) AND isnotnull(cr_order_number#85))
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                   +- FileScan parquet spark_catalog.tpcds.catalog_returns[cr_item_sk#71,cr_order_number#85,cr_refunded_cash#92,cr_reversed_charge#93,cr_store_credit#94] Batched: true, DataFilters: [isnotnull(cr_item_sk#71), isnotnull(cr_order_number#85)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:int,cr_refunded_cash:double,cr_reversed_charge:double,cr_st...
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=761]
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(d_year#145) AND (d_year#145 = 1999)) AND isnotnull(d_date_sk#139))
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet spark_catalog.tpcds.date_dim[d_date_sk#139,d_year#145] Batched: true, DataFilters: [isnotnull(d_year#145), (d_year#145 = 1999), isnotnull(d_date_sk#139)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,1999), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=765]
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(s_store_sk#167) AND isnotnull(s_store_name#172)) AND isnotnull(s_zip#192))
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet spark_catalog.tpcds.store[s_store_sk#167,s_store_name#172,s_zip#192] Batched: true, DataFilters: [isnotnull(s_store_sk#167), isnotnull(s_store_name#172), isnotnull(s_zip#192)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
            :                 :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=769]
            :                 :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (((((isnotnull(c_customer_sk#196) AND isnotnull(c_first_sales_date_sk#202)) AND isnotnull(c_first_shipto_date_sk#201)) AND isnotnull(c_current_cdemo_sk#198)) AND isnotnull(c_current_hdemo_sk#199)) AND isnotnull(c_current_addr_sk#200))
            :                 :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet spark_catalog.tpcds.customer[c_customer_sk#196,c_current_cdemo_sk#198,c_current_hdemo_sk#199,c_current_addr_sk#200,c_first_shipto_date_sk#201,c_first_sales_date_sk#202] Batched: true, DataFilters: [isnotnull(c_customer_sk#196), isnotnull(c_first_sales_date_sk#202), isnotnull(c_first_shipto_dat..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
            :                 :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=773]
            :                 :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#285)
            :                 :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet spark_catalog.tpcds.date_dim[d_date_sk#285,d_year#291] Batched: true, DataFilters: [isnotnull(d_date_sk#285)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
            :                 :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=777]
            :                 :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#313)
            :                 :     :     :     :     :     :     :     :     :     :           +- FileScan parquet spark_catalog.tpcds.date_dim[d_date_sk#313,d_year#319] Batched: true, DataFilters: [isnotnull(d_date_sk#313)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
            :                 :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=781]
            :                 :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#214) AND isnotnull(cd_marital_status#216))
            :                 :     :     :     :     :     :     :     :     :           +- FileScan parquet spark_catalog.tpcds.customer_demographics[cd_demo_sk#214,cd_marital_status#216] Batched: true, DataFilters: [isnotnull(cd_demo_sk#214), isnotnull(cd_marital_status#216)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
            :                 :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=785]
            :                 :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#341) AND isnotnull(cd_marital_status#343))
            :                 :     :     :     :     :     :     :     :           +- FileScan parquet spark_catalog.tpcds.customer_demographics[cd_demo_sk#341,cd_marital_status#343] Batched: true, DataFilters: [isnotnull(cd_demo_sk#341), isnotnull(cd_marital_status#343)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
            :                 :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=789]
            :                 :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#223)
            :                 :     :     :     :     :     :     :           +- FileScan parquet spark_catalog.tpcds.promotion[p_promo_sk#223] Batched: true, DataFilters: [isnotnull(p_promo_sk#223)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
            :                 :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=793]
            :                 :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#242) AND isnotnull(hd_income_band_sk#243))
            :                 :     :     :     :     :     :           +- FileScan parquet spark_catalog.tpcds.household_demographics[hd_demo_sk#242,hd_income_band_sk#243] Batched: true, DataFilters: [isnotnull(hd_demo_sk#242), isnotnull(hd_income_band_sk#243)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
            :                 :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=797]
            :                 :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#350) AND isnotnull(hd_income_band_sk#351))
            :                 :     :     :     :     :           +- FileScan parquet spark_catalog.tpcds.household_demographics[hd_demo_sk#350,hd_income_band_sk#351] Batched: true, DataFilters: [isnotnull(hd_demo_sk#350), isnotnull(hd_income_band_sk#351)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
            :                 :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=801]
            :                 :     :     :     :        +- Filter isnotnull(ca_address_sk#247)
            :                 :     :     :     :           +- FileScan parquet spark_catalog.tpcds.customer_address[ca_address_sk#247,ca_street_number#249,ca_street_name#250,ca_city#253,ca_zip#256] Batched: true, DataFilters: [isnotnull(ca_address_sk#247)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
            :                 :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=805]
            :                 :     :     :        +- Filter isnotnull(ca_address_sk#355)
            :                 :     :     :           +- FileScan parquet spark_catalog.tpcds.customer_address[ca_address_sk#355,ca_street_number#357,ca_street_name#358,ca_city#361,ca_zip#364] Batched: true, DataFilters: [isnotnull(ca_address_sk#355)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
            :                 :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=809]
            :                 :     :        +- Filter isnotnull(ib_income_band_sk#260)
            :                 :     :           +- FileScan parquet spark_catalog.tpcds.income_band[ib_income_band_sk#260] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#260)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
            :                 :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=813]
            :                 :        +- Filter isnotnull(ib_income_band_sk#368)
            :                 :           +- FileScan parquet spark_catalog.tpcds.income_band[ib_income_band_sk#368] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#368)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
            :                 +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=817]
            :                    +- Project [i_item_sk#263, i_product_name#284]
            :                       +- Filter ((((((isnotnull(i_current_price#268) AND i_color#280 IN (purple,burlywood,indian,spring,floral,medium)) AND (i_current_price#268 >= 64.0)) AND (i_current_price#268 <= 74.0)) AND (i_current_price#268 >= 65.0)) AND (i_current_price#268 <= 79.0)) AND isnotnull(i_item_sk#263))
            :                          +- FileScan parquet spark_catalog.tpcds.item[i_item_sk#263,i_current_price#268,i_color#280,i_product_name#284] Batched: true, DataFilters: [isnotnull(i_current_price#268), i_color#280 IN (purple,burlywood,indian,spring,floral,medium), (..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [burlywood,floral,indian,medium,purple,spring]), Greater..., ReadSchema: struct<i_item_sk:int,i_current_price:double,i_color:string,i_product_name:string>
            +- Sort [item_sk#398 ASC NULLS FIRST, store_name#399 ASC NULLS FIRST, store_zip#400 ASC NULLS FIRST], false, 0
               +- Exchange hashpartitioning(item_sk#398, store_name#399, store_zip#400, 200), ENSURE_REQUIREMENTS, [plan_id=906]
                  +- HashAggregate(keys=[i_product_name#1106, i_item_sk#1085, s_store_name#964, s_zip#984, ca_street_number#1055, ca_street_name#1056, ca_city#1059, ca_zip#1062, ca_street_number#1068, ca_street_name#1069, ca_city#1072, ca_zip#1075, d_year#881, d_year#909, d_year#937], functions=[count(1), sum(ss_wholesale_cost#782), sum(ss_list_price#783), sum(ss_coupon_amt#790)], output=[item_sk#398, store_name#399, store_zip#400, syear#409, cnt#412L, s1#413, s2#414, s3#415])
                     +- HashAggregate(keys=[i_product_name#1106, i_item_sk#1085, s_store_name#964, s_zip#984, ca_street_number#1055, ca_street_name#1056, ca_city#1059, ca_zip#1062, ca_street_number#1068, ca_street_name#1069, ca_city#1072, ca_zip#1075, d_year#881, d_year#909, d_year#937], functions=[partial_count(1), partial_sum(ss_wholesale_cost#782), partial_sum(ss_list_price#783), partial_sum(ss_coupon_amt#790)], output=[i_product_name#1106, i_item_sk#1085, s_store_name#964, s_zip#984, ca_street_number#1055, ca_street_name#1056, ca_city#1059, ca_zip#1062, ca_street_number#1068, ca_street_name#1069, ca_city#1072, ca_zip#1075, d_year#881, d_year#909, d_year#937, count#1130L, sum#1141, sum#1142, sum#1143])
                        +- Project [ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790, d_year#881, d_year#909, d_year#937, s_store_name#964, s_zip#984, ca_street_number#1055, ca_street_name#1056, ca_city#1059, ca_zip#1062, ca_street_number#1068, ca_street_name#1069, ca_city#1072, ca_zip#1075, i_item_sk#1085, i_product_name#1106]
                           +- BroadcastHashJoin [ss_item_sk#773], [i_item_sk#1085], Inner, BuildRight, false
                              :- Project [ss_item_sk#773, ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790, d_year#881, s_store_name#964, s_zip#984, d_year#909, d_year#937, ca_street_number#1055, ca_street_name#1056, ca_city#1059, ca_zip#1062, ca_street_number#1068, ca_street_name#1069, ca_city#1072, ca_zip#1075]
                              :  +- BroadcastHashJoin [hd_income_band_sk#1049], [ib_income_band_sk#1082], Inner, BuildRight, false
                              :     :- Project [ss_item_sk#773, ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790, d_year#881, s_store_name#964, s_zip#984, d_year#909, d_year#937, hd_income_band_sk#1049, ca_street_number#1055, ca_street_name#1056, ca_city#1059, ca_zip#1062, ca_street_number#1068, ca_street_name#1069, ca_city#1072, ca_zip#1075]
                              :     :  +- BroadcastHashJoin [hd_income_band_sk#1044], [ib_income_band_sk#1079], Inner, BuildRight, false
                              :     :     :- Project [ss_item_sk#773, ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790, d_year#881, s_store_name#964, s_zip#984, d_year#909, d_year#937, hd_income_band_sk#1044, hd_income_band_sk#1049, ca_street_number#1055, ca_street_name#1056, ca_city#1059, ca_zip#1062, ca_street_number#1068, ca_street_name#1069, ca_city#1072, ca_zip#1075]
                              :     :     :  +- BroadcastHashJoin [c_current_addr_sk#992], [ca_address_sk#1066], Inner, BuildRight, false
                              :     :     :     :- Project [ss_item_sk#773, ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790, d_year#881, s_store_name#964, s_zip#984, c_current_addr_sk#992, d_year#909, d_year#937, hd_income_band_sk#1044, hd_income_band_sk#1049, ca_street_number#1055, ca_street_name#1056, ca_city#1059, ca_zip#1062]
                              :     :     :     :  +- BroadcastHashJoin [ss_addr_sk#777], [ca_address_sk#1053], Inner, BuildRight, false
                              :     :     :     :     :- Project [ss_item_sk#773, ss_addr_sk#777, ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790, d_year#881, s_store_name#964, s_zip#984, c_current_addr_sk#992, d_year#909, d_year#937, hd_income_band_sk#1044, hd_income_band_sk#1049]
                              :     :     :     :     :  +- BroadcastHashJoin [c_current_hdemo_sk#991], [hd_demo_sk#1048], Inner, BuildRight, false
                              :     :     :     :     :     :- Project [ss_item_sk#773, ss_addr_sk#777, ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790, d_year#881, s_store_name#964, s_zip#984, c_current_hdemo_sk#991, c_current_addr_sk#992, d_year#909, d_year#937, hd_income_band_sk#1044]
                              :     :     :     :     :     :  +- BroadcastHashJoin [ss_hdemo_sk#776], [hd_demo_sk#1043], Inner, BuildRight, false
                              :     :     :     :     :     :     :- Project [ss_item_sk#773, ss_hdemo_sk#776, ss_addr_sk#777, ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790, d_year#881, s_store_name#964, s_zip#984, c_current_hdemo_sk#991, c_current_addr_sk#992, d_year#909, d_year#937]
                              :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_promo_sk#779], [p_promo_sk#1024], Inner, BuildRight, false
                              :     :     :     :     :     :     :     :- Project [ss_item_sk#773, ss_hdemo_sk#776, ss_addr_sk#777, ss_promo_sk#779, ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790, d_year#881, s_store_name#964, s_zip#984, c_current_hdemo_sk#991, c_current_addr_sk#992, d_year#909, d_year#937]
                              :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_current_cdemo_sk#990], [cd_demo_sk#1015], Inner, BuildRight, NOT (cd_marital_status#1008 = cd_marital_status#1017), false
                              :     :     :     :     :     :     :     :     :- Project [ss_item_sk#773, ss_hdemo_sk#776, ss_addr_sk#777, ss_promo_sk#779, ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790, d_year#881, s_store_name#964, s_zip#984, c_current_cdemo_sk#990, c_current_hdemo_sk#991, c_current_addr_sk#992, d_year#909, d_year#937, cd_marital_status#1008]
                              :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_cdemo_sk#775], [cd_demo_sk#1006], Inner, BuildRight, false
                              :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#773, ss_cdemo_sk#775, ss_hdemo_sk#776, ss_addr_sk#777, ss_promo_sk#779, ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790, d_year#881, s_store_name#964, s_zip#984, c_current_cdemo_sk#990, c_current_hdemo_sk#991, c_current_addr_sk#992, d_year#909, d_year#937]
                              :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_shipto_date_sk#993], [d_date_sk#931], Inner, BuildRight, false
                              :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#773, ss_cdemo_sk#775, ss_hdemo_sk#776, ss_addr_sk#777, ss_promo_sk#779, ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790, d_year#881, s_store_name#964, s_zip#984, c_current_cdemo_sk#990, c_current_hdemo_sk#991, c_current_addr_sk#992, c_first_shipto_date_sk#993, d_year#909]
                              :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_sales_date_sk#994], [d_date_sk#903], Inner, BuildRight, false
                              :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#773, ss_cdemo_sk#775, ss_hdemo_sk#776, ss_addr_sk#777, ss_promo_sk#779, ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790, d_year#881, s_store_name#964, s_zip#984, c_current_cdemo_sk#990, c_current_hdemo_sk#991, c_current_addr_sk#992, c_first_shipto_date_sk#993, c_first_sales_date_sk#994]
                              :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_customer_sk#774], [c_customer_sk#988], Inner, BuildRight, false
                              :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#773, ss_customer_sk#774, ss_cdemo_sk#775, ss_hdemo_sk#776, ss_addr_sk#777, ss_promo_sk#779, ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790, d_year#881, s_store_name#964, s_zip#984]
                              :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_store_sk#778], [s_store_sk#959], Inner, BuildRight, false
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#773, ss_customer_sk#774, ss_cdemo_sk#775, ss_hdemo_sk#776, ss_addr_sk#777, ss_store_sk#778, ss_promo_sk#779, ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790, d_year#881]
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_sold_date_sk#771], [d_date_sk#875], Inner, BuildRight, false
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#771, ss_item_sk#773, ss_customer_sk#774, ss_cdemo_sk#775, ss_hdemo_sk#776, ss_addr_sk#777, ss_store_sk#778, ss_promo_sk#779, ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790]
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin [ss_item_sk#773], [cs_item_sk#829], Inner
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Sort [ss_item_sk#773 ASC NULLS FIRST], false, 0
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Exchange hashpartitioning(ss_item_sk#773, 200), ENSURE_REQUIREMENTS, [plan_id=836]
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [ss_sold_date_sk#771, ss_item_sk#773, ss_customer_sk#774, ss_cdemo_sk#775, ss_hdemo_sk#776, ss_addr_sk#777, ss_store_sk#778, ss_promo_sk#779, ss_wholesale_cost#782, ss_list_price#783, ss_coupon_amt#790]
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- BroadcastHashJoin [ss_item_sk#773, ss_ticket_number#780], [sr_item_sk#796, sr_ticket_number#803], Inner, BuildRight, false
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           :- Filter ((((((((isnotnull(ss_item_sk#773) AND isnotnull(ss_ticket_number#780)) AND isnotnull(ss_sold_date_sk#771)) AND isnotnull(ss_store_sk#778)) AND isnotnull(ss_customer_sk#774)) AND isnotnull(ss_cdemo_sk#775)) AND isnotnull(ss_promo_sk#779)) AND isnotnull(ss_hdemo_sk#776)) AND isnotnull(ss_addr_sk#777))
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           :  +- FileScan parquet spark_catalog.tpcds.store_sales[ss_sold_date_sk#771,ss_item_sk#773,ss_customer_sk#774,ss_cdemo_sk#775,ss_hdemo_sk#776,ss_addr_sk#777,ss_store_sk#778,ss_promo_sk#779,ss_ticket_number#780,ss_wholesale_cost#782,ss_list_price#783,ss_coupon_amt#790] Batched: true, DataFilters: [isnotnull(ss_item_sk#773), isnotnull(ss_ticket_number#780), isnotnull(ss_sold_date_sk#771), isno..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_sold_date_sk), IsNotNull(ss_sto..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_a...
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- BroadcastExchange HashedRelationBroadcastMode(List((shiftleft(cast(input[0, int, false] as bigint), 32) | (cast(input[1, int, false] as bigint) & 4294967295))),false), [plan_id=822]
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- Filter (isnotnull(sr_item_sk#796) AND isnotnull(sr_ticket_number#803))
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- FileScan parquet spark_catalog.tpcds.store_returns[sr_item_sk#796,sr_ticket_number#803] Batched: true, DataFilters: [isnotnull(sr_item_sk#796), isnotnull(sr_ticket_number#803)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:int>
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Sort [cs_item_sk#829 ASC NULLS FIRST], false, 0
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Project [cs_item_sk#829]
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Filter ((isnotnull(sale#8) AND isnotnull(refund#9)) AND (sale#8 > (2.0 * refund#9)))
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- HashAggregate(keys=[cs_item_sk#829], functions=[sum(cs_ext_list_price#839), sum(((cr_refunded_cash#871 + cr_reversed_charge#872) + cr_store_credit#873))], output=[cs_item_sk#829, sale#8, refund#9])
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Exchange hashpartitioning(cs_item_sk#829, 200), ENSURE_REQUIREMENTS, [plan_id=830]
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- HashAggregate(keys=[cs_item_sk#829], functions=[partial_sum(cs_ext_list_price#839), partial_sum(((cr_refunded_cash#871 + cr_reversed_charge#872) + cr_store_credit#873))], output=[cs_item_sk#829, sum#1146, sum#1147])
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- Project [cs_item_sk#829, cs_ext_list_price#839, cr_refunded_cash#871, cr_reversed_charge#872, cr_store_credit#873]
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- BroadcastHashJoin [cs_item_sk#829, cs_order_number#831], [cr_item_sk#850, cr_order_number#864], Inner, BuildRight, false
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             :- Filter (isnotnull(cs_item_sk#829) AND isnotnull(cs_order_number#831))
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             :  +- FileScan parquet spark_catalog.tpcds.catalog_sales[cs_item_sk#829,cs_order_number#831,cs_ext_list_price#839] Batched: true, DataFilters: [isnotnull(cs_item_sk#829), isnotnull(cs_order_number#831)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:int,cs_ext_list_price:double>
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             +- BroadcastExchange HashedRelationBroadcastMode(List((shiftleft(cast(input[0, int, false] as bigint), 32) | (cast(input[1, int, false] as bigint) & 4294967295))),false), [plan_id=825]
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                +- Filter (isnotnull(cr_item_sk#850) AND isnotnull(cr_order_number#864))
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                   +- FileScan parquet spark_catalog.tpcds.catalog_returns[cr_item_sk#850,cr_order_number#864,cr_refunded_cash#871,cr_reversed_charge#872,cr_store_credit#873] Batched: true, DataFilters: [isnotnull(cr_item_sk#850), isnotnull(cr_order_number#864)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:int,cr_refunded_cash:double,cr_reversed_charge:double,cr_st...
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=842]
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(d_year#881) AND (d_year#881 = 2000)) AND isnotnull(d_date_sk#875))
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet spark_catalog.tpcds.date_dim[d_date_sk#875,d_year#881] Batched: true, DataFilters: [isnotnull(d_year#881), (d_year#881 = 2000), isnotnull(d_date_sk#875)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2000), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                              :     :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=846]
                              :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(s_store_sk#959) AND isnotnull(s_store_name#964)) AND isnotnull(s_zip#984))
                              :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet spark_catalog.tpcds.store[s_store_sk#959,s_store_name#964,s_zip#984] Batched: true, DataFilters: [isnotnull(s_store_sk#959), isnotnull(s_store_name#964), isnotnull(s_zip#984)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
                              :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=850]
                              :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (((((isnotnull(c_customer_sk#988) AND isnotnull(c_first_sales_date_sk#994)) AND isnotnull(c_first_shipto_date_sk#993)) AND isnotnull(c_current_cdemo_sk#990)) AND isnotnull(c_current_hdemo_sk#991)) AND isnotnull(c_current_addr_sk#992))
                              :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet spark_catalog.tpcds.customer[c_customer_sk#988,c_current_cdemo_sk#990,c_current_hdemo_sk#991,c_current_addr_sk#992,c_first_shipto_date_sk#993,c_first_sales_date_sk#994] Batched: true, DataFilters: [isnotnull(c_customer_sk#988), isnotnull(c_first_sales_date_sk#994), isnotnull(c_first_shipto_dat..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
                              :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=854]
                              :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#903)
                              :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet spark_catalog.tpcds.date_dim[d_date_sk#903,d_year#909] Batched: true, DataFilters: [isnotnull(d_date_sk#903)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                              :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=858]
                              :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#931)
                              :     :     :     :     :     :     :     :     :     :           +- FileScan parquet spark_catalog.tpcds.date_dim[d_date_sk#931,d_year#937] Batched: true, DataFilters: [isnotnull(d_date_sk#931)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                              :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=862]
                              :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#1006) AND isnotnull(cd_marital_status#1008))
                              :     :     :     :     :     :     :     :     :           +- FileScan parquet spark_catalog.tpcds.customer_demographics[cd_demo_sk#1006,cd_marital_status#1008] Batched: true, DataFilters: [isnotnull(cd_demo_sk#1006), isnotnull(cd_marital_status#1008)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
                              :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=866]
                              :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#1015) AND isnotnull(cd_marital_status#1017))
                              :     :     :     :     :     :     :     :           +- FileScan parquet spark_catalog.tpcds.customer_demographics[cd_demo_sk#1015,cd_marital_status#1017] Batched: true, DataFilters: [isnotnull(cd_demo_sk#1015), isnotnull(cd_marital_status#1017)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
                              :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=870]
                              :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#1024)
                              :     :     :     :     :     :     :           +- FileScan parquet spark_catalog.tpcds.promotion[p_promo_sk#1024] Batched: true, DataFilters: [isnotnull(p_promo_sk#1024)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
                              :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=874]
                              :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#1043) AND isnotnull(hd_income_band_sk#1044))
                              :     :     :     :     :     :           +- FileScan parquet spark_catalog.tpcds.household_demographics[hd_demo_sk#1043,hd_income_band_sk#1044] Batched: true, DataFilters: [isnotnull(hd_demo_sk#1043), isnotnull(hd_income_band_sk#1044)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
                              :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=878]
                              :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#1048) AND isnotnull(hd_income_band_sk#1049))
                              :     :     :     :     :           +- FileScan parquet spark_catalog.tpcds.household_demographics[hd_demo_sk#1048,hd_income_band_sk#1049] Batched: true, DataFilters: [isnotnull(hd_demo_sk#1048), isnotnull(hd_income_band_sk#1049)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
                              :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=882]
                              :     :     :     :        +- Filter isnotnull(ca_address_sk#1053)
                              :     :     :     :           +- FileScan parquet spark_catalog.tpcds.customer_address[ca_address_sk#1053,ca_street_number#1055,ca_street_name#1056,ca_city#1059,ca_zip#1062] Batched: true, DataFilters: [isnotnull(ca_address_sk#1053)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
                              :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=886]
                              :     :     :        +- Filter isnotnull(ca_address_sk#1066)
                              :     :     :           +- FileScan parquet spark_catalog.tpcds.customer_address[ca_address_sk#1066,ca_street_number#1068,ca_street_name#1069,ca_city#1072,ca_zip#1075] Batched: true, DataFilters: [isnotnull(ca_address_sk#1066)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
                              :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=890]
                              :     :        +- Filter isnotnull(ib_income_band_sk#1079)
                              :     :           +- FileScan parquet spark_catalog.tpcds.income_band[ib_income_band_sk#1079] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#1079)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
                              :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=894]
                              :        +- Filter isnotnull(ib_income_band_sk#1082)
                              :           +- FileScan parquet spark_catalog.tpcds.income_band[ib_income_band_sk#1082] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#1082)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
                              +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=898]
                                 +- Project [i_item_sk#1085, i_product_name#1106]
                                    +- Filter ((((((isnotnull(i_current_price#1090) AND i_color#1102 IN (purple,burlywood,indian,spring,floral,medium)) AND (i_current_price#1090 >= 64.0)) AND (i_current_price#1090 <= 74.0)) AND (i_current_price#1090 >= 65.0)) AND (i_current_price#1090 <= 79.0)) AND isnotnull(i_item_sk#1085))
                                       +- FileScan parquet spark_catalog.tpcds.item[i_item_sk#1085,i_current_price#1090,i_color#1102,i_product_name#1106] Batched: true, DataFilters: [isnotnull(i_current_price#1090), i_color#1102 IN (purple,burlywood,indian,spring,floral,medium),..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/Users/angela/Desktop/spark-3.5.5-bin-hadoop3/spark-warehouse/tpc..., PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [burlywood,floral,indian,medium,purple,spring]), Greater..., ReadSchema: struct<i_item_sk:int,i_current_price:double,i_color:string,i_product_name:string>

Time taken: 5.293 seconds, Fetched 1 row(s)
